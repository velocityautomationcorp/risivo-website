module.exports=[45452,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(33840);function f({params:a}){let{workflowId:f}=(0,c.use)(a),g=(0,d.useRouter)(),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)("builder"),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(!0),[D,E]=(0,c.useState)(1),F="b0000000-0000-0000-0000-000000000001";(0,c.useEffect)(()=>{G()},[f]),(0,c.useEffect)(()=>{"history"===j&&0===t.length&&H()},[j]);let G=async()=>{m(!0);try{let a=await fetch(`/api/v1/workflows?id=${f}&subAccountId=${F}`),b=await a.json();b.success&&b.data?(i(b.data),y(b.data.name),A(b.data.description||""),C(b.data.allowMultipleExecutions??!0),E(b.data.maxExecutionsPerContact??1)):q("Workflow not found")}catch(a){console.error("Error loading workflow:",a),q("Failed to load workflow")}finally{m(!1)}},H=async()=>{w(!0);try{let a=await fetch(`/api/v1/workflows/${f}/executions?limit=50`),b=await a.json();b.success&&u(b.data||[])}catch(a){console.error("Error loading executions:",a)}finally{w(!1)}},I=async(a,b)=>{o(!0),q(null);try{let c=await fetch("/api/v1/workflows",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:f,subAccountId:F,name:x,description:z,trigger:a,actions:b.map(a=>({id:a.id,type:a.type,name:a.name,config:a.config,delay:a.delay,continueOnError:a.continueOnError,order:a.order,conditions:a.conditions})),allowMultipleExecutions:B,maxExecutionsPerContact:D})}),d=await c.json();d.success?(s("Workflow saved successfully!"),setTimeout(()=>s(null),3e3),await G()):q(d.error||"Failed to save workflow")}catch(a){console.error("[WorkflowEditPage] Error saving workflow:",a),q("Failed to save workflow")}finally{o(!1)}},J=async()=>{o(!0),q(null);try{let a=await fetch("/api/v1/workflows",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:f,subAccountId:F,name:x,description:z,allowMultipleExecutions:B,maxExecutionsPerContact:D})}),b=await a.json();b.success?(s("Settings saved!"),setTimeout(()=>s(null),3e3),G()):q(b.error||"Failed to save settings")}catch(a){console.error("Error saving settings:",a),q("Failed to save settings")}finally{o(!1)}},K=async()=>{if(!h)return;let a="active"===h.status?"inactive":"active";try{let b=await fetch("/api/v1/workflows",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:f,subAccountId:F,status:a})});(await b.json()).success&&(s(`Workflow ${"active"===a?"activated":"deactivated"}!`),setTimeout(()=>s(null),3e3),G())}catch(a){console.error("Error toggling status:",a)}},L=async()=>{if(confirm("Are you sure you want to delete this workflow? This action cannot be undone."))try{let a=await fetch(`/api/v1/workflows?id=${f}&subAccountId=${F}&permanent=true`,{method:"DELETE"}),b=await a.json();b.success?g.push("/sub-account/accelerators"):q(b.error||"Failed to delete workflow")}catch(a){console.error("Error deleting workflow:",a),q("Failed to delete workflow")}},M=()=>{g.push("/sub-account/accelerators")};return l?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading workflow..."})]})}):p&&!h?(0,b.jsxs)("div",{className:"max-w-2xl mx-auto py-12 px-4 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)("i",{className:"fas fa-exclamation-triangle text-red-600 text-2xl"})}),(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Workflow Not Found"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:p}),(0,b.jsx)("button",{onClick:()=>g.push("/sub-account/accelerators"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Workflows"})]}):h?(0,b.jsxs)("div",{className:"min-h-[calc(100vh-200px)] flex flex-col",children:[(0,b.jsxs)("div",{className:"bg-white border-b px-6 py-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:M,className:"text-gray-600 hover:text-gray-800",children:(0,b.jsx)("i",{className:"fas fa-arrow-left"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:h.name}),(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${(a=>{switch(a){case"active":return"bg-green-100 text-green-800";case"inactive":default:return"bg-gray-100 text-gray-800";case"draft":return"bg-yellow-100 text-yellow-800"}})(h.status)}`,children:h.status})]}),h.description&&(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:h.description})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsxs)("button",{onClick:K,className:`px-4 py-2 rounded-lg flex items-center gap-2 ${"active"===h.status?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[(0,b.jsx)("i",{className:`fas fa-${"active"===h.status?"pause":"play"}`}),"active"===h.status?"Deactivate":"Activate"]})})]}),(0,b.jsx)("div",{className:"flex gap-6 mt-4 -mb-4",children:[{id:"builder",label:"Builder",icon:"project-diagram"},{id:"history",label:"Execution History",icon:"history"},{id:"analytics",label:"Analytics",icon:"chart-line"},{id:"settings",label:"Settings",icon:"cog"}].map(a=>(0,b.jsxs)("button",{onClick:()=>k(a.id),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${j===a.id?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[(0,b.jsx)("i",{className:`fas fa-${a.icon} mr-2`}),a.label]},a.id))})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden min-h-[500px]",children:["builder"===j&&(0,b.jsx)(e.default,{workflowId:f,initialTrigger:h.trigger,initialActions:h.actions,onSave:I,onCancel:M},`${f}-${h.version||0}`),"history"===j&&(0,b.jsx)("div",{className:"p-6 overflow-y-auto h-full",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Execution History"}),(0,b.jsxs)("button",{onClick:H,className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh"]})]}),v?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Loading executions..."})]}):0===t.length?(0,b.jsxs)("div",{className:"text-center py-12 bg-white rounded-xl border",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)("i",{className:"fas fa-history text-gray-400 text-2xl"})}),(0,b.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"No executions yet"}),(0,b.jsx)("p",{className:"text-gray-500",children:"When this workflow runs, execution history will appear here."})]}):(0,b.jsx)("div",{className:"bg-white rounded-xl border divide-y",children:t.map(a=>(0,b.jsxs)("div",{className:"p-4 hover:bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${(a=>{switch(a){case"completed":return"bg-green-100 text-green-800";case"running":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(a.status)}`,children:a.status}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.triggerType.replace(/_/g," ")}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:new Date(a.triggeredAt).toLocaleString()})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[a.actionResults?.length||0," actions"]}),a.completedAt&&(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Duration: ",Math.round((new Date(a.completedAt).getTime()-new Date(a.startedAt).getTime())/1e3),"s"]})]})]}),a.errorMessage&&(0,b.jsx)("div",{className:"mt-3 p-3 bg-red-50 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-red-600",children:[(0,b.jsx)("i",{className:"fas fa-exclamation-circle mr-2"}),a.errorMessage]})})]},a.id))})]})}),"analytics"===j&&(0,b.jsx)("div",{className:"p-6 overflow-y-auto h-full",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Workflow Analytics"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl border p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)("i",{className:"fas fa-rocket text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:h.totalExecutions}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Total Runs"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl border p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)("i",{className:"fas fa-check text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:h.successfulExecutions}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Successful"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl border p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)("i",{className:"fas fa-times text-red-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:h.failedExecutions}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Failed"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl border p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)("i",{className:"fas fa-percentage text-purple-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[h.totalExecutions>0?Math.round(h.successfulExecutions/h.totalExecutions*100):0,"%"]}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Success Rate"})]})]})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-6",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Workflow Performance"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center py-3 border-b",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Last Executed"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:h.lastExecutedAt?new Date(h.lastExecutedAt).toLocaleString():"Never"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-3 border-b",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Created"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:new Date(h.createdAt).toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-3 border-b",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Last Updated"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:new Date(h.updatedAt).toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center py-3",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Version"}),(0,b.jsxs)("span",{className:"font-medium text-gray-900",children:["v",h.version]})]})]})]})]})}),"settings"===j&&(0,b.jsx)("div",{className:"p-6 overflow-y-auto h-full",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Workflow Settings"}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-6",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Basic Information"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,b.jsx)("input",{type:"text",value:x,onChange:a=>y(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,b.jsx)("textarea",{value:z,onChange:a=>A(a.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border p-6",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Execution Settings"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:"Allow Multiple Executions"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Allow same contact to trigger multiple times"})]}),(0,b.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:B,onChange:a=>C(a.target.checked),className:"sr-only peer"}),(0,b.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),B&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Executions Per Contact"}),(0,b.jsx)("input",{type:"number",min:"1",value:D,onChange:a=>E(parseInt(a.target.value)||1),className:"w-32 px-4 py-2 border border-gray-300 rounded-lg"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"0 = unlimited"})]})]})]}),(0,b.jsx)("div",{className:"flex justify-end gap-3",children:(0,b.jsxs)("button",{onClick:J,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[n&&(0,b.jsx)("i",{className:"fas fa-spinner fa-spin"}),"Save Settings"]})}),(0,b.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"font-semibold text-red-800 mb-2",children:"Danger Zone"}),(0,b.jsx)("p",{className:"text-sm text-red-600 mb-4",children:"Deleting this workflow is permanent and cannot be undone."}),(0,b.jsxs)("button",{onClick:L,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-trash"}),"Delete Workflow"]})]})]})})]}),r&&(0,b.jsx)("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-4 py-3 rounded-lg shadow-lg z-50",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("i",{className:"fas fa-check-circle"}),(0,b.jsx)("span",{children:r})]})}),p&&(0,b.jsx)("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-4 py-3 rounded-lg shadow-lg z-50",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("i",{className:"fas fa-exclamation-circle"}),(0,b.jsx)("span",{children:p}),(0,b.jsx)("button",{onClick:()=>q(null),className:"ml-2",children:(0,b.jsx)("i",{className:"fas fa-times"})})]})}),n&&"builder"===j&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl p-8 text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Saving workflow..."})]})})]}):null}a.s(["default",()=>f])}];

//# sourceMappingURL=app_sub-account_accelerators_%5BworkflowId%5D_page_tsx_27aac980._.js.map