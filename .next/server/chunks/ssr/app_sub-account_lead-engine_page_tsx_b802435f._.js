module.exports=[88784,a=>{"use strict";let b;var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=a.i(87924),w=a.i(72131),x=a.i(38246),y=a.i(50944),z=a.i(35112);function A(a){let b=Object.prototype.toString.call(a);return"[object Window]"===b||"[object global]"===b}function B(a){return"nodeType"in a}function C(a){var b,c;return a?A(a)?a:B(a)&&null!=(b=null==(c=a.ownerDocument)?void 0:c.defaultView)?b:window:window}function D(a){let{Document:b}=C(a);return a instanceof b}function E(a){return!A(a)&&a instanceof C(a).HTMLElement}function F(a){return a instanceof C(a).SVGElement}function G(a){return a?A(a)?a.document:B(a)?D(a)?a:E(a)||F(a)?a.ownerDocument:document:document:document}let H=w.useEffect;function I(a){let b=(0,w.useRef)(a);return H(()=>{b.current=a}),(0,w.useCallback)(function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return null==b.current?void 0:b.current(...c)},[])}function J(a,b){void 0===b&&(b=[a]);let c=(0,w.useRef)(a);return H(()=>{c.current!==a&&(c.current=a)},b),c}function K(a,b){let c=(0,w.useRef)();return(0,w.useMemo)(()=>{let b=a(c.current);return c.current=b,b},[...b])}function L(a){let b=I(a),c=(0,w.useRef)(null),d=(0,w.useCallback)(a=>{a!==c.current&&(null==b||b(a,c.current)),c.current=a},[]);return[c,d]}function M(a){let b=(0,w.useRef)();return(0,w.useEffect)(()=>{b.current=a},[a]),b.current}let N={};function O(a,b){return(0,w.useMemo)(()=>{if(b)return b;let c=null==N[a]?0:N[a]+1;return N[a]=c,a+"-"+c},[a,b])}function P(a){return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return d.reduce((b,c)=>{for(let[d,e]of Object.entries(c)){let c=b[d];null!=c&&(b[d]=c+a*e)}return b},{...b})}}let Q=P(1),R=P(-1);function S(a){if(!a)return!1;let{KeyboardEvent:b}=C(a.target);return b&&a instanceof b}function T(a){if(function(a){if(!a)return!1;let{TouchEvent:b}=C(a.target);return b&&a instanceof b}(a)){if(a.touches&&a.touches.length){let{clientX:b,clientY:c}=a.touches[0];return{x:b,y:c}}else if(a.changedTouches&&a.changedTouches.length){let{clientX:b,clientY:c}=a.changedTouches[0];return{x:b,y:c}}}return"clientX"in a&&"clientY"in a?{x:a.clientX,y:a.clientY}:null}let U=Object.freeze({Translate:{toString(a){if(!a)return;let{x:b,y:c}=a;return"translate3d("+(b?Math.round(b):0)+"px, "+(c?Math.round(c):0)+"px, 0)"}},Scale:{toString(a){if(!a)return;let{scaleX:b,scaleY:c}=a;return"scaleX("+b+") scaleY("+c+")"}},Transform:{toString(a){if(a)return[U.Translate.toString(a),U.Scale.toString(a)].join(" ")}},Transition:{toString(a){let{property:b,duration:c,easing:d}=a;return b+" "+c+"ms "+d}}}),V="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",W={display:"none"};function X(a){let{id:b,value:c}=a;return w.default.createElement("div",{id:b,style:W},c)}function Y(a){let{id:b,announcement:c,ariaLiveType:d="assertive"}=a;return w.default.createElement("div",{id:b,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":d,"aria-atomic":!0},c)}let Z=(0,w.createContext)(null),$={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},_={onDragStart(a){let{active:b}=a;return"Picked up draggable item "+b.id+"."},onDragOver(a){let{active:b,over:c}=a;return c?"Draggable item "+b.id+" was moved over droppable area "+c.id+".":"Draggable item "+b.id+" is no longer over a droppable area."},onDragEnd(a){let{active:b,over:c}=a;return c?"Draggable item "+b.id+" was dropped over droppable area "+c.id:"Draggable item "+b.id+" was dropped."},onDragCancel(a){let{active:b}=a;return"Dragging was cancelled. Draggable item "+b.id+" was dropped."}};function aa(a){var b;let c,{announcements:d=_,container:e,hiddenTextDescribedById:f,screenReaderInstructions:g=$}=a,{announce:h,announcement:i}=function(){let[a,b]=(0,w.useState)("");return{announce:(0,w.useCallback)(a=>{null!=a&&b(a)},[]),announcement:a}}(),j=O("DndLiveRegion"),[k,l]=(0,w.useState)(!1);if((0,w.useEffect)(()=>{l(!0)},[]),b=(0,w.useMemo)(()=>({onDragStart(a){let{active:b}=a;h(d.onDragStart({active:b}))},onDragMove(a){let{active:b,over:c}=a;d.onDragMove&&h(d.onDragMove({active:b,over:c}))},onDragOver(a){let{active:b,over:c}=a;h(d.onDragOver({active:b,over:c}))},onDragEnd(a){let{active:b,over:c}=a;h(d.onDragEnd({active:b,over:c}))},onDragCancel(a){let{active:b,over:c}=a;h(d.onDragCancel({active:b,over:c}))}}),[h,d]),c=(0,w.useContext)(Z),(0,w.useEffect)(()=>{if(!c)throw Error("useDndMonitor must be used within a children of <DndContext>");return c(b)},[b,c]),!k)return null;let m=w.default.createElement(w.default.Fragment,null,w.default.createElement(X,{id:f,value:g.draggable}),w.default.createElement(Y,{id:j,announcement:i}));return e?(0,z.createPortal)(m,e):m}function ab(){}(c=l||(l={})).DragStart="dragStart",c.DragMove="dragMove",c.DragEnd="dragEnd",c.DragCancel="dragCancel",c.DragOver="dragOver",c.RegisterDroppable="registerDroppable",c.SetDroppableDisabled="setDroppableDisabled",c.UnregisterDroppable="unregisterDroppable";let ac=Object.freeze({x:0,y:0});function ad(a,b){let{data:{value:c}}=a,{data:{value:d}}=b;return c-d}function ae(a,b){let{data:{value:c}}=a,{data:{value:d}}=b;return d-c}function af(a){let{left:b,top:c,height:d,width:e}=a;return[{x:b,y:c},{x:b+e,y:c},{x:b,y:c+d},{x:b+e,y:c+d}]}let ag=a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=af(b),f=[];for(let a of d){let{id:b}=a,d=c.get(b);if(d){let c=af(d),g=Number((e.reduce((a,b,d)=>{var e;return a+(e=c[d],Math.sqrt(Math.pow(e.x-b.x,2)+Math.pow(e.y-b.y,2)))},0)/4).toFixed(4));f.push({id:b,data:{droppableContainer:a,value:g}})}}return f.sort(ad)},ah=a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=[];for(let a of d){let{id:d}=a,f=c.get(d);if(f){let c=function(a,b){let c=Math.max(b.top,a.top),d=Math.max(b.left,a.left),e=Math.min(b.left+b.width,a.left+a.width),f=Math.min(b.top+b.height,a.top+a.height);if(d<e&&c<f){let g=b.width*b.height,h=a.width*a.height,i=(e-d)*(f-c);return Number((i/(g+h-i)).toFixed(4))}return 0}(f,b);c>0&&e.push({id:d,data:{droppableContainer:a,value:c}})}}return e.sort(ae)};function ai(a,b){return a&&b?{x:a.left-b.left,y:a.top-b.top}:ac}let aj=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return c.reduce((a,b)=>({...a,top:a.top+ +b.y,bottom:a.bottom+ +b.y,left:a.left+ +b.x,right:a.right+ +b.x}),{...a})};function ak(a){if(a.startsWith("matrix3d(")){let b=a.slice(9,-1).split(/, /);return{x:+b[12],y:+b[13],scaleX:+b[0],scaleY:+b[5]}}if(a.startsWith("matrix(")){let b=a.slice(7,-1).split(/, /);return{x:+b[4],y:+b[5],scaleX:+b[0],scaleY:+b[3]}}return null}let al={ignoreTransform:!1};function am(a,b){void 0===b&&(b=al);let c=a.getBoundingClientRect();if(b.ignoreTransform){let{transform:b,transformOrigin:d}=C(a).getComputedStyle(a);b&&(c=function(a,b,c){let d=ak(b);if(!d)return a;let{scaleX:e,scaleY:f,x:g,y:h}=d,i=a.left-g-(1-e)*parseFloat(c),j=a.top-h-(1-f)*parseFloat(c.slice(c.indexOf(" ")+1)),k=e?a.width/e:a.width,l=f?a.height/f:a.height;return{width:k,height:l,top:j,right:i+k,bottom:j+l,left:i}}(c,b,d))}let{top:d,left:e,width:f,height:g,bottom:h,right:i}=c;return{top:d,left:e,width:f,height:g,bottom:h,right:i}}function an(a){return am(a,{ignoreTransform:!0})}function ao(a,b){let c=[];return a?function d(e){var f,g;let h;if(null!=b&&c.length>=b||!e)return c;if(D(e)&&null!=e.scrollingElement&&!c.includes(e.scrollingElement))return c.push(e.scrollingElement),c;if(!E(e)||F(e)||c.includes(e))return c;let i=C(a).getComputedStyle(e);return(e!==a&&(void 0===(f=i)&&(f=C(e).getComputedStyle(e)),h=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(a=>{let b=f[a];return"string"==typeof b&&h.test(b)}))&&c.push(e),void 0===(g=i)&&(g=C(e).getComputedStyle(e)),"fixed"===g.position)?c:d(e.parentNode)}(a):c}function ap(a){let[b]=ao(a,1);return null!=b?b:null}function aq(a){return A(a)?a.scrollX:a.scrollLeft}function ar(a){return A(a)?a.scrollY:a.scrollTop}function as(a){return{x:aq(a),y:ar(a)}}function at(a){let b={x:0,y:0},c={height:a.clientHeight,width:a.clientWidth},d={x:a.scrollWidth-c.width,y:a.scrollHeight-c.height},e=a.scrollTop<=b.y,f=a.scrollLeft<=b.x;return{isTop:e,isLeft:f,isBottom:a.scrollTop>=d.y,isRight:a.scrollLeft>=d.x,maxScroll:d,minScroll:b}}(d=m||(m={}))[d.Forward=1]="Forward",d[d.Backward=-1]="Backward";let au={x:.2,y:.2};function av(a){return a.reduce((a,b)=>Q(a,as(b)),ac)}function aw(a,b){if(void 0===b&&(b=am),!a)return;let{top:c,left:d,bottom:e,right:f}=b(a);ap(a)&&(e<=0||f<=0||c>=window.innerHeight||d>=window.innerWidth)&&a.scrollIntoView({block:"center",inline:"center"})}let ax=[["x",["left","right"],function(a){return a.reduce((a,b)=>a+aq(b),0)}],["y",["top","bottom"],function(a){return a.reduce((a,b)=>a+ar(b),0)}]];class ay{constructor(a,b){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const c=ao(b),d=av(c);for(const[b,e,f]of(this.rect={...a},this.width=a.width,this.height=a.height,ax))for(const a of e)Object.defineProperty(this,a,{get:()=>{let e=f(c),g=d[b]-e;return this.rect[a]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class az{constructor(a){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(a=>{var b;return null==(b=this.target)?void 0:b.removeEventListener(...a)})},this.target=a}add(a,b,c){var d;null==(d=this.target)||d.addEventListener(a,b,c),this.listeners.push([a,b,c])}}function aA(a,b){let c=Math.abs(a.x),d=Math.abs(a.y);return"number"==typeof b?Math.sqrt(c**2+d**2)>b:"x"in b&&"y"in b?c>b.x&&d>b.y:"x"in b?c>b.x:"y"in b&&d>b.y}function aB(a){a.preventDefault()}function aC(a){a.stopPropagation()}(e=n||(n={})).Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange",(f=o||(o={})).Space="Space",f.Down="ArrowDown",f.Right="ArrowRight",f.Left="ArrowLeft",f.Up="ArrowUp",f.Esc="Escape",f.Enter="Enter",f.Tab="Tab";let aD={start:[o.Space,o.Enter],cancel:[o.Esc],end:[o.Space,o.Enter,o.Tab]},aE=(a,b)=>{let{currentCoordinates:c}=b;switch(a.code){case o.Right:return{...c,x:c.x+25};case o.Left:return{...c,x:c.x-25};case o.Down:return{...c,y:c.y+25};case o.Up:return{...c,y:c.y-25}}};class aF{constructor(a){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=a;const{event:{target:b}}=a;this.props=a,this.listeners=new az(G(b)),this.windowListeners=new az(C(b)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(n.Resize,this.handleCancel),this.windowListeners.add(n.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(n.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:a,onStart:b}=this.props,c=a.node.current;c&&aw(c),b(ac)}handleKeyDown(a){if(S(a)){let{active:b,context:c,options:d}=this.props,{keyboardCodes:e=aD,coordinateGetter:f=aE,scrollBehavior:g="smooth"}=d,{code:h}=a;if(e.end.includes(h))return void this.handleEnd(a);if(e.cancel.includes(h))return void this.handleCancel(a);let{collisionRect:i}=c.current,j=i?{x:i.left,y:i.top}:ac;this.referenceCoordinates||(this.referenceCoordinates=j);let k=f(a,{active:b,context:c.current,currentCoordinates:j});if(k){let b=R(k,j),d={x:0,y:0},{scrollableAncestors:e}=c.current;for(let c of e){let e=a.code,{isTop:f,isRight:h,isLeft:i,isBottom:j,maxScroll:l,minScroll:m}=at(c),n=function(a){if(a===document.scrollingElement){let{innerWidth:a,innerHeight:b}=window;return{top:0,left:0,right:a,bottom:b,width:a,height:b}}let{top:b,left:c,right:d,bottom:e}=a.getBoundingClientRect();return{top:b,left:c,right:d,bottom:e,width:a.clientWidth,height:a.clientHeight}}(c),p={x:Math.min(e===o.Right?n.right-n.width/2:n.right,Math.max(e===o.Right?n.left:n.left+n.width/2,k.x)),y:Math.min(e===o.Down?n.bottom-n.height/2:n.bottom,Math.max(e===o.Down?n.top:n.top+n.height/2,k.y))},q=e===o.Right&&!h||e===o.Left&&!i,r=e===o.Down&&!j||e===o.Up&&!f;if(q&&p.x!==k.x){let a=c.scrollLeft+b.x,f=e===o.Right&&a<=l.x||e===o.Left&&a>=m.x;if(f&&!b.y)return void c.scrollTo({left:a,behavior:g});f?d.x=c.scrollLeft-a:d.x=e===o.Right?c.scrollLeft-l.x:c.scrollLeft-m.x,d.x&&c.scrollBy({left:-d.x,behavior:g});break}if(r&&p.y!==k.y){let a=c.scrollTop+b.y,f=e===o.Down&&a<=l.y||e===o.Up&&a>=m.y;if(f&&!b.x)return void c.scrollTo({top:a,behavior:g});f?d.y=c.scrollTop-a:d.y=e===o.Down?c.scrollTop-l.y:c.scrollTop-m.y,d.y&&c.scrollBy({top:-d.y,behavior:g});break}}this.handleMove(a,Q(R(k,this.referenceCoordinates),d))}}}handleMove(a,b){let{onMove:c}=this.props;a.preventDefault(),c(b)}handleEnd(a){let{onEnd:b}=this.props;a.preventDefault(),this.detach(),b()}handleCancel(a){let{onCancel:b}=this.props;a.preventDefault(),this.detach(),b()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function aG(a){return!!(a&&"distance"in a)}function aH(a){return!!(a&&"delay"in a)}aF.activators=[{eventName:"onKeyDown",handler:(a,b,c)=>{let{keyboardCodes:d=aD,onActivation:e}=b,{active:f}=c,{code:g}=a.nativeEvent;if(d.start.includes(g)){let b=f.activatorNode.current;return(!b||a.target===b)&&(a.preventDefault(),null==e||e({event:a.nativeEvent}),!0)}return!1}}];class aI{constructor(a,b,c){var d;void 0===c&&(c=function(a){let{EventTarget:b}=C(a);return a instanceof b?a:G(a)}(a.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=a,this.events=b;const{event:e}=a,{target:f}=e;this.props=a,this.events=b,this.document=G(f),this.documentListeners=new az(this.document),this.listeners=new az(c),this.windowListeners=new az(C(f)),this.initialCoordinates=null!=(d=T(e))?d:ac,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:a,props:{options:{activationConstraint:b,bypassActivationConstraint:c}}}=this;if(this.listeners.add(a.move.name,this.handleMove,{passive:!1}),this.listeners.add(a.end.name,this.handleEnd),a.cancel&&this.listeners.add(a.cancel.name,this.handleCancel),this.windowListeners.add(n.Resize,this.handleCancel),this.windowListeners.add(n.DragStart,aB),this.windowListeners.add(n.VisibilityChange,this.handleCancel),this.windowListeners.add(n.ContextMenu,aB),this.documentListeners.add(n.Keydown,this.handleKeydown),b){if(null!=c&&c({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(aH(b)){this.timeoutId=setTimeout(this.handleStart,b.delay),this.handlePending(b);return}if(aG(b))return void this.handlePending(b)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(a,b){let{active:c,onPending:d}=this.props;d(c,a,this.initialCoordinates,b)}handleStart(){let{initialCoordinates:a}=this,{onStart:b}=this.props;a&&(this.activated=!0,this.documentListeners.add(n.Click,aC,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(n.SelectionChange,this.removeTextSelection),b(a))}handleMove(a){var b;let{activated:c,initialCoordinates:d,props:e}=this,{onMove:f,options:{activationConstraint:g}}=e;if(!d)return;let h=null!=(b=T(a))?b:ac,i=R(d,h);if(!c&&g){if(aG(g)){if(null!=g.tolerance&&aA(i,g.tolerance))return this.handleCancel();if(aA(i,g.distance))return this.handleStart()}return aH(g)&&aA(i,g.tolerance)?this.handleCancel():void this.handlePending(g,i)}a.cancelable&&a.preventDefault(),f(h)}handleEnd(){let{onAbort:a,onEnd:b}=this.props;this.detach(),this.activated||a(this.props.active),b()}handleCancel(){let{onAbort:a,onCancel:b}=this.props;this.detach(),this.activated||a(this.props.active),b()}handleKeydown(a){a.code===o.Esc&&this.handleCancel()}removeTextSelection(){var a;null==(a=this.document.getSelection())||a.removeAllRanges()}}let aJ={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class aK extends aI{constructor(a){const{event:b}=a;super(a,aJ,G(b.target))}}aK.activators=[{eventName:"onPointerDown",handler:(a,b)=>{let{nativeEvent:c}=a,{onActivation:d}=b;return!!c.isPrimary&&0===c.button&&(null==d||d({event:c}),!0)}}];(g=p||(p={}))[g.RightClick=2]="RightClick";(h=q||(q={}))[h.Pointer=0]="Pointer",h[h.DraggableRect=1]="DraggableRect",(i=r||(r={}))[i.TreeOrder=0]="TreeOrder",i[i.ReversedTreeOrder=1]="ReversedTreeOrder";let aL={x:{[m.Backward]:!1,[m.Forward]:!1},y:{[m.Backward]:!1,[m.Forward]:!1}};(j=s||(s={}))[j.Always=0]="Always",j[j.BeforeDragging=1]="BeforeDragging",j[j.WhileDragging=2]="WhileDragging",(t||(t={})).Optimized="optimized";let aM=new Map;function aN(a,b){return K(c=>a?c||("function"==typeof b?b(a):a):null,[b,a])}function aO(a){let{callback:b,disabled:c}=a;I(b);let d=(0,w.useMemo)(()=>{},[c]);return(0,w.useEffect)(()=>()=>null==d?void 0:d.disconnect(),[d]),d}function aP(a){return new ay(am(a),a)}function aQ(a,b,c){void 0===b&&(b=aP);let[d,e]=(0,w.useState)(null);function f(){e(d=>{if(!a)return null;if(!1===a.isConnected){var e;return null!=(e=null!=d?d:c)?e:null}let f=b(a);return JSON.stringify(d)===JSON.stringify(f)?d:f})}let g=function(a){let{callback:b,disabled:c}=a,d=I(b),e=(0,w.useMemo)(()=>{},[d,c]);return(0,w.useEffect)(()=>()=>null==e?void 0:e.disconnect(),[e]),e}({callback(b){if(a)for(let c of b){let{type:b,target:d}=c;if("childList"===b&&d instanceof HTMLElement&&d.contains(a)){f();break}}}}),h=aO({callback:f});return H(()=>{f(),a?(null==h||h.observe(a),null==g||g.observe(document.body,{childList:!0,subtree:!0})):(null==h||h.disconnect(),null==g||g.disconnect())},[a]),d}let aR=[];function aS(a,b){void 0===b&&(b=[]);let c=(0,w.useRef)(null);return(0,w.useEffect)(()=>{c.current=null},b),(0,w.useEffect)(()=>{let b=a!==ac;b&&!c.current&&(c.current=a),!b&&c.current&&(c.current=null)},[a]),c.current?R(a,c.current):ac}function aT(a){return(0,w.useMemo)(()=>{let b,c;return a?(b=a.innerWidth,{top:0,left:0,right:b,bottom:c=a.innerHeight,width:b,height:c}):null},[a])}let aU=[];function aV(a){if(!a)return null;if(a.children.length>1)return a;let b=a.children[0];return E(b)?b:a}let aW=[{sensor:aK,options:{}},{sensor:aF,options:{}}],aX={current:{}},aY={draggable:{measure:an},droppable:{measure:an,strategy:s.WhileDragging,frequency:t.Optimized},dragOverlay:{measure:am}};class aZ extends Map{get(a){var b;return null!=a&&null!=(b=super.get(a))?b:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(a=>{let{disabled:b}=a;return!b})}getNodeFor(a){var b,c;return null!=(b=null==(c=this.get(a))?void 0:c.node.current)?b:void 0}}let a$={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new aZ,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ab},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:aY,measureDroppableContainers:ab,windowRect:null,measuringScheduled:!1},a_={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ab,draggableNodes:new Map,over:null,measureDroppableContainers:ab},a0=(0,w.createContext)(a_),a1=(0,w.createContext)(a$);function a2(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new aZ}}}function a3(a,b){switch(b.type){case l.DragStart:return{...a,draggable:{...a.draggable,initialCoordinates:b.initialCoordinates,active:b.active}};case l.DragMove:if(null==a.draggable.active)return a;return{...a,draggable:{...a.draggable,translate:{x:b.coordinates.x-a.draggable.initialCoordinates.x,y:b.coordinates.y-a.draggable.initialCoordinates.y}}};case l.DragEnd:case l.DragCancel:return{...a,draggable:{...a.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case l.RegisterDroppable:{let{element:c}=b,{id:d}=c,e=new aZ(a.droppable.containers);return e.set(d,c),{...a,droppable:{...a.droppable,containers:e}}}case l.SetDroppableDisabled:{let{id:c,key:d,disabled:e}=b,f=a.droppable.containers.get(c);if(!f||d!==f.key)return a;let g=new aZ(a.droppable.containers);return g.set(c,{...f,disabled:e}),{...a,droppable:{...a.droppable,containers:g}}}case l.UnregisterDroppable:{let{id:c,key:d}=b,e=a.droppable.containers.get(c);if(!e||d!==e.key)return a;let f=new aZ(a.droppable.containers);return f.delete(c),{...a,droppable:{...a.droppable,containers:f}}}default:return a}}function a4(a){let{disabled:b}=a,{active:c,activatorEvent:d,draggableNodes:e}=(0,w.useContext)(a0),f=M(d),g=M(null==c?void 0:c.id);return(0,w.useEffect)(()=>{if(!b&&!d&&f&&null!=g){if(!S(f)||document.activeElement===f.target)return;let a=e.get(g);if(!a)return;let{activatorNode:b,node:c}=a;(b.current||c.current)&&requestAnimationFrame(()=>{for(let a of[b.current,c.current]){if(!a)continue;let b=a.matches(V)?a:a.querySelector(V);if(b){b.focus();break}}})}},[d,b,e,g,f]),null}function a5(a,b){let{transform:c,...d}=b;return null!=a&&a.length?a.reduce((a,b)=>b({transform:a,...d}),c):c}let a6=(0,w.createContext)({...ac,scaleX:1,scaleY:1});(k=u||(u={}))[k.Uninitialized=0]="Uninitialized",k[k.Initializing=1]="Initializing",k[k.Initialized=2]="Initialized";let a7=(0,w.memo)(function(a){var b,c,d,e,f,g,h,i;let j,k,n,o,p,t,v,x,{id:y,accessibility:A,autoScroll:B=!0,children:D,sensors:F=aW,collisionDetection:G=ah,measuring:I,modifiers:N,...P}=a,[R,S]=(0,w.useReducer)(a3,void 0,a2),[U,V]=function(){let[a]=(0,w.useState)(()=>new Set),b=(0,w.useCallback)(b=>(a.add(b),()=>a.delete(b)),[a]);return[(0,w.useCallback)(b=>{let{type:c,event:d}=b;a.forEach(a=>{var b;return null==(b=a[c])?void 0:b.call(a,d)})},[a]),b]}(),[W,X]=(0,w.useState)(u.Uninitialized),Y=W===u.Initialized,{draggable:{active:$,nodes:_,translate:ab},droppable:{containers:ad}}=R,ae=null!=$?_.get($):null,af=(0,w.useRef)({initial:null,translated:null}),ag=(0,w.useMemo)(()=>{var a;return null!=$?{id:$,data:null!=(a=null==ae?void 0:ae.data)?a:aX,rect:af}:null},[$,ae]),ak=(0,w.useRef)(null),[al,an]=(0,w.useState)(null),[aq,ar]=(0,w.useState)(null),aw=J(P,Object.values(P)),ax=O("DndDescribedBy",y),az=(0,w.useMemo)(()=>ad.getEnabled(),[ad]),aA=(0,w.useMemo)(()=>({draggable:{...aY.draggable,...null==I?void 0:I.draggable},droppable:{...aY.droppable,...null==I?void 0:I.droppable},dragOverlay:{...aY.dragOverlay,...null==I?void 0:I.dragOverlay}}),[null==I?void 0:I.draggable,null==I?void 0:I.droppable,null==I?void 0:I.dragOverlay]),{droppableRects:aB,measureDroppableContainers:aC,measuringScheduled:aD}=function(a,b){let{dragging:c,dependencies:d,config:e}=b,[f,g]=(0,w.useState)(null),{frequency:h,measure:i,strategy:j}=e,k=(0,w.useRef)(a),l=function(){switch(j){case s.Always:return!1;case s.BeforeDragging:return c;default:return!c}}(),m=J(l),n=(0,w.useCallback)(function(a){void 0===a&&(a=[]),m.current||g(b=>null===b?a:b.concat(a.filter(a=>!b.includes(a))))},[m]),o=(0,w.useRef)(null),p=K(b=>{if(l&&!c)return aM;if(!b||b===aM||k.current!==a||null!=f){let b=new Map;for(let c of a){if(!c)continue;if(f&&f.length>0&&!f.includes(c.id)&&c.rect.current){b.set(c.id,c.rect.current);continue}let a=c.node.current,d=a?new ay(i(a),a):null;c.rect.current=d,d&&b.set(c.id,d)}return b}return b},[a,f,c,l,i]);return(0,w.useEffect)(()=>{k.current=a},[a]),(0,w.useEffect)(()=>{l||n()},[c,l]),(0,w.useEffect)(()=>{f&&f.length>0&&g(null)},[JSON.stringify(f)]),(0,w.useEffect)(()=>{l||"number"!=typeof h||null!==o.current||(o.current=setTimeout(()=>{n(),o.current=null},h))},[h,l,n,...d]),{droppableRects:p,measureDroppableContainers:n,measuringScheduled:null!=f}}(az,{dragging:Y,dependencies:[ab.x,ab.y],config:aA.droppable}),aE=K(a=>{var b;return null==$?null:null!=(b=null!=p?p:a)?b:null},[p=(o=null!=$?_.get($):void 0)?o.node.current:null,$]),aF=(0,w.useMemo)(()=>aq?T(aq):null,[aq]),aG=(j=(null==al?void 0:al.autoScrollEnabled)===!1,k="object"==typeof B?!1===B.enabled:!1===B,n=Y&&!j&&!k,"object"==typeof B?{...B,enabled:n}:{enabled:n}),aH=aN(aE,aA.draggable.measure);!function(a){let{activeNode:b,measure:c,initialRect:d,config:e=!0}=a,f=(0,w.useRef)(!1),{x:g,y:h}="boolean"==typeof e?{x:e,y:e}:e;H(()=>{if(!g&&!h||!b){f.current=!1;return}if(f.current||!d)return;let a=null==b?void 0:b.node.current;if(!a||!1===a.isConnected)return;let e=ai(c(a),d);if(g||(e.x=0),h||(e.y=0),f.current=!0,Math.abs(e.x)>0||Math.abs(e.y)>0){let b=ap(a);b&&b.scrollBy({top:e.y,left:e.x})}},[b,g,h,d,c])}({activeNode:null!=$?_.get($):null,config:aG.layoutShiftCompensation,initialRect:aH,measure:aA.draggable.measure});let aI=aQ(aE,aA.draggable.measure,aH),aJ=aQ(aE?aE.parentElement:null),aK=(0,w.useRef)({activatorEvent:null,active:null,activeNode:aE,collisionRect:null,collisions:null,droppableRects:aB,draggableNodes:_,draggingNode:null,draggingNodeRect:null,droppableContainers:ad,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),aP=ad.getNodeFor(null==(b=aK.current.over)?void 0:b.id),aZ=function(a){let{measure:b}=a,[c,d]=(0,w.useState)(null),e=aO({callback:(0,w.useCallback)(a=>{for(let{target:c}of a)if(E(c)){d(a=>{let d=b(c);return a?{...a,width:d.width,height:d.height}:d});break}},[b])}),[f,g]=L((0,w.useCallback)(a=>{let c=aV(a);null==e||e.disconnect(),c&&(null==e||e.observe(c)),d(c?b(c):null)},[b,e]));return(0,w.useMemo)(()=>({nodeRef:f,rect:c,setRef:g}),[c,f,g])}({measure:aA.dragOverlay.measure}),a$=null!=(c=aZ.nodeRef.current)?c:aE,a_=Y?null!=(d=aZ.rect)?d:aI:null,a7=!!(aZ.nodeRef.current&&aZ.rect),a8=(t=aN(f=a7?null:aI),ai(f,t)),a9=aT(a$?C(a$):null),ba=(g=Y?null!=aP?aP:aE:null,v=(0,w.useRef)(g),x=K(a=>g?a&&a!==aR&&g&&v.current&&g.parentNode===v.current.parentNode?a:ao(g):aR,[g]),(0,w.useEffect)(()=>{v.current=g},[g]),x),bb=function(a,b){void 0===b&&(b=am);let[c]=a,d=aT(c?C(c):null),[e,f]=(0,w.useState)(aU);function g(){f(()=>a.length?a.map(a=>new ay(b(a),a)):aU)}let h=aO({callback:g});return H(()=>{null==h||h.disconnect(),g(),a.forEach(a=>null==h?void 0:h.observe(a))},[a]),e}(ba),bc=a5(N,{transform:{x:ab.x-a8.x,y:ab.y-a8.y,scaleX:1,scaleY:1},activatorEvent:aq,active:ag,activeNodeRect:aI,containerNodeRect:aJ,draggingNodeRect:a_,over:aK.current.over,overlayNodeRect:aZ.rect,scrollableAncestors:ba,scrollableAncestorRects:bb,windowRect:a9}),bd=aF?Q(aF,ab):null,be=function(a){let[b,c]=(0,w.useState)(null),d=(0,w.useRef)(a),e=(0,w.useCallback)(a=>{var b;let d=(b=a.target,null);d&&c(a=>a?(a.set(d,as(d)),new Map(a)):null)},[]);return(0,w.useEffect)(()=>{let b=d.current;if(a!==b){f(b);let g=a.map(a=>{var b;let c=(b=0,null);return c?(c.addEventListener("scroll",e,{passive:!0}),[c,as(c)]):null}).filter(a=>null!=a);c(g.length?new Map(g):null),d.current=a}return()=>{f(a),f(b)};function f(a){a.forEach(a=>{let b=null;null==b||b.removeEventListener("scroll",e)})}},[e,a]),(0,w.useMemo)(()=>a.length?b?Array.from(b.values()).reduce((a,b)=>Q(a,b),ac):av(a):ac,[a,b])}(ba),bf=aS(be),bg=aS(be,[aI]),bh=Q(bc,bf),bi=a_?aj(a_,bc):null,bj=ag&&bi?G({active:ag,collisionRect:bi,droppableRects:aB,droppableContainers:az,pointerCoordinates:bd}):null,bk=function(a,b){if(!a||0===a.length)return null;let[c]=a;return c.id}(bj,0),[bl,bm]=(0,w.useState)(null),bn=(h=a7?bc:Q(bc,bg),i=null!=(e=null==bl?void 0:bl.rect)?e:null,{...h,scaleX:i&&aI?i.width/aI.width:1,scaleY:i&&aI?i.height/aI.height:1}),bo=(0,w.useRef)(null),bp=(0,w.useCallback)((a,b)=>{let{sensor:c,options:d}=b;if(null==ak.current)return;let e=_.get(ak.current);if(!e)return;let f=a.nativeEvent,g=new c({active:ak.current,activeNode:e,event:f,options:d,context:aK,onAbort(a){if(!_.get(a))return;let{onDragAbort:b}=aw.current,c={id:a};null==b||b(c),U({type:"onDragAbort",event:c})},onPending(a,b,c,d){if(!_.get(a))return;let{onDragPending:e}=aw.current,f={id:a,constraint:b,initialCoordinates:c,offset:d};null==e||e(f),U({type:"onDragPending",event:f})},onStart(a){let b=ak.current;if(null==b)return;let c=_.get(b);if(!c)return;let{onDragStart:d}=aw.current,e={activatorEvent:f,active:{id:b,data:c.data,rect:af}};(0,z.unstable_batchedUpdates)(()=>{null==d||d(e),X(u.Initializing),S({type:l.DragStart,initialCoordinates:a,active:b}),U({type:"onDragStart",event:e}),an(bo.current),ar(f)})},onMove(a){S({type:l.DragMove,coordinates:a})},onEnd:h(l.DragEnd),onCancel:h(l.DragCancel)});function h(a){return async function(){let{active:b,collisions:c,over:d,scrollAdjustedTranslate:e}=aK.current,g=null;if(b&&e){let{cancelDrop:h}=aw.current;g={activatorEvent:f,active:b,collisions:c,delta:e,over:d},a===l.DragEnd&&"function"==typeof h&&await Promise.resolve(h(g))&&(a=l.DragCancel)}ak.current=null,(0,z.unstable_batchedUpdates)(()=>{S({type:a}),X(u.Uninitialized),bm(null),an(null),ar(null),bo.current=null;let b=a===l.DragEnd?"onDragEnd":"onDragCancel";if(g){let a=aw.current[b];null==a||a(g),U({type:b,event:g})}})}}bo.current=g},[_]),bq=(0,w.useCallback)((a,b)=>(c,d)=>{let e=c.nativeEvent,f=_.get(d);null!==ak.current||!f||e.dndKit||e.defaultPrevented||!0===a(c,b.options,{active:f})&&(e.dndKit={capturedBy:b.sensor},ak.current=d,bp(c,b))},[_,bp]),br=(0,w.useMemo)(()=>F.reduce((a,b)=>{let{sensor:c}=b;return[...a,...c.activators.map(a=>({eventName:a.eventName,handler:bq(a.handler,b)}))]},[]),[F,bq]);(0,w.useEffect)(()=>{},F.map(a=>{let{sensor:b}=a;return b})),H(()=>{aI&&W===u.Initializing&&X(u.Initialized)},[aI,W]),(0,w.useEffect)(()=>{let{onDragMove:a}=aw.current,{active:b,activatorEvent:c,collisions:d,over:e}=aK.current;if(!b||!c)return;let f={active:b,activatorEvent:c,collisions:d,delta:{x:bh.x,y:bh.y},over:e};(0,z.unstable_batchedUpdates)(()=>{null==a||a(f),U({type:"onDragMove",event:f})})},[bh.x,bh.y]),(0,w.useEffect)(()=>{let{active:a,activatorEvent:b,collisions:c,droppableContainers:d,scrollAdjustedTranslate:e}=aK.current;if(!a||null==ak.current||!b||!e)return;let{onDragOver:f}=aw.current,g=d.get(bk),h=g&&g.rect.current?{id:g.id,rect:g.rect.current,data:g.data,disabled:g.disabled}:null,i={active:a,activatorEvent:b,collisions:c,delta:{x:e.x,y:e.y},over:h};(0,z.unstable_batchedUpdates)(()=>{bm(h),null==f||f(i),U({type:"onDragOver",event:i})})},[bk]),H(()=>{aK.current={activatorEvent:aq,active:ag,activeNode:aE,collisionRect:bi,collisions:bj,droppableRects:aB,draggableNodes:_,draggingNode:a$,draggingNodeRect:a_,droppableContainers:ad,over:bl,scrollableAncestors:ba,scrollAdjustedTranslate:bh},af.current={initial:a_,translated:bi}},[ag,aE,bj,bi,_,a$,a_,aB,ad,bl,ba,bh]),function(a){let b,{acceleration:c,activator:d=q.Pointer,canScroll:e,draggingRect:f,enabled:g,interval:h=5,order:i=r.TreeOrder,pointerCoordinates:j,scrollableAncestors:k,scrollableAncestorRects:l,delta:n,threshold:o}=a,p=function(a){let{delta:b,disabled:c}=a,d=M(b);return K(a=>{if(c||!d||!a)return aL;let e={x:Math.sign(b.x-d.x),y:Math.sign(b.y-d.y)};return{x:{[m.Backward]:a.x[m.Backward]||-1===e.x,[m.Forward]:a.x[m.Forward]||1===e.x},y:{[m.Backward]:a.y[m.Backward]||-1===e.y,[m.Forward]:a.y[m.Forward]||1===e.y}}},[c,b,d])}({delta:n,disabled:!g}),[s,t]=(b=(0,w.useRef)(null),[(0,w.useCallback)((a,c)=>{b.current=setInterval(a,c)},[]),(0,w.useCallback)(()=>{null!==b.current&&(clearInterval(b.current),b.current=null)},[])]),u=(0,w.useRef)({x:0,y:0}),v=(0,w.useRef)({x:0,y:0}),x=(0,w.useMemo)(()=>{switch(d){case q.Pointer:return j?{top:j.y,bottom:j.y,left:j.x,right:j.x}:null;case q.DraggableRect:return f}},[d,f,j]),y=(0,w.useRef)(null),z=(0,w.useCallback)(()=>{let a=y.current;if(!a)return;let b=u.current.x*v.current.x,c=u.current.y*v.current.y;a.scrollBy(b,c)},[]),A=(0,w.useMemo)(()=>i===r.TreeOrder?[...k].reverse():k,[i,k]);(0,w.useEffect)(()=>{if(!g||!k.length||!x)return void t();for(let a of A){if((null==e?void 0:e(a))===!1)continue;let b=l[k.indexOf(a)];if(!b)continue;let{direction:d,speed:f}=function(a,b,c,d,e){let{top:f,left:g,right:h,bottom:i}=c;void 0===d&&(d=10),void 0===e&&(e=au);let{isTop:j,isBottom:k,isLeft:l,isRight:n}=at(a),o={x:0,y:0},p={x:0,y:0},q={height:b.height*e.y,width:b.width*e.x};return!j&&f<=b.top+q.height?(o.y=m.Backward,p.y=d*Math.abs((b.top+q.height-f)/q.height)):!k&&i>=b.bottom-q.height&&(o.y=m.Forward,p.y=d*Math.abs((b.bottom-q.height-i)/q.height)),!n&&h>=b.right-q.width?(o.x=m.Forward,p.x=d*Math.abs((b.right-q.width-h)/q.width)):!l&&g<=b.left+q.width&&(o.x=m.Backward,p.x=d*Math.abs((b.left+q.width-g)/q.width)),{direction:o,speed:p}}(a,b,x,c,o);for(let a of["x","y"])p[a][d[a]]||(f[a]=0,d[a]=0);if(f.x>0||f.y>0){t(),y.current=a,s(z,h),u.current=f,v.current=d;return}}u.current={x:0,y:0},v.current={x:0,y:0},t()},[c,z,e,t,g,h,JSON.stringify(x),JSON.stringify(p),s,k,A,l,JSON.stringify(o)])}({...aG,delta:ab,draggingRect:bi,pointerCoordinates:bd,scrollableAncestors:ba,scrollableAncestorRects:bb});let bs=(0,w.useMemo)(()=>({active:ag,activeNode:aE,activeNodeRect:aI,activatorEvent:aq,collisions:bj,containerNodeRect:aJ,dragOverlay:aZ,draggableNodes:_,droppableContainers:ad,droppableRects:aB,over:bl,measureDroppableContainers:aC,scrollableAncestors:ba,scrollableAncestorRects:bb,measuringConfiguration:aA,measuringScheduled:aD,windowRect:a9}),[ag,aE,aI,aq,bj,aJ,aZ,_,ad,aB,bl,aC,ba,bb,aA,aD,a9]),bt=(0,w.useMemo)(()=>({activatorEvent:aq,activators:br,active:ag,activeNodeRect:aI,ariaDescribedById:{draggable:ax},dispatch:S,draggableNodes:_,over:bl,measureDroppableContainers:aC}),[aq,br,ag,aI,S,ax,_,bl,aC]);return w.default.createElement(Z.Provider,{value:V},w.default.createElement(a0.Provider,{value:bt},w.default.createElement(a1.Provider,{value:bs},w.default.createElement(a6.Provider,{value:bn},D)),w.default.createElement(a4,{disabled:(null==A?void 0:A.restoreFocus)===!1})),w.default.createElement(aa,{...A,hiddenTextDescribedById:ax}))}),a8=(0,w.createContext)(null),a9="button";function ba(){return(0,w.useContext)(a1)}let bb={timeout:25};function bc(a){let{data:b,disabled:c=!1,id:d,resizeObserverConfig:e}=a,f=O("Droppable"),{active:g,dispatch:h,over:i,measureDroppableContainers:j}=(0,w.useContext)(a0),k=(0,w.useRef)({disabled:c}),m=(0,w.useRef)(!1),n=(0,w.useRef)(null),o=(0,w.useRef)(null),{disabled:p,updateMeasurementsFor:q,timeout:r}={...bb,...e},s=J(null!=q?q:d),t=aO({callback:(0,w.useCallback)(()=>{if(!m.current){m.current=!0;return}null!=o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{j(Array.isArray(s.current)?s.current:[s.current]),o.current=null},r)},[r]),disabled:p||!g}),[u,v]=L((0,w.useCallback)((a,b)=>{t&&(b&&(t.unobserve(b),m.current=!1),a&&t.observe(a))},[t])),x=J(b);return(0,w.useEffect)(()=>{t&&u.current&&(t.disconnect(),m.current=!1,t.observe(u.current))},[u,t]),(0,w.useEffect)(()=>(h({type:l.RegisterDroppable,element:{id:d,key:f,disabled:c,node:u,rect:n,data:x}}),()=>h({type:l.UnregisterDroppable,key:f,id:d})),[d]),(0,w.useEffect)(()=>{c!==k.current.disabled&&(h({type:l.SetDroppableDisabled,id:d,key:f,disabled:c}),k.current.disabled=c)},[d,f,c,h]),{active:g,rect:n,isOver:(null==i?void 0:i.id)===d,node:u,over:i,setNodeRef:v}}function bd(a){let{animation:b,children:c}=a,[d,e]=(0,w.useState)(null),[f,g]=(0,w.useState)(null),h=M(c);return c||d||!h||e(h),H(()=>{if(!f)return;let a=null==d?void 0:d.key,c=null==d?void 0:d.props.id;null==a||null==c?e(null):Promise.resolve(b(c,f)).then(()=>{e(null)})},[b,d,f]),w.default.createElement(w.default.Fragment,null,c,d?(0,w.cloneElement)(d,{ref:g}):null)}let be={x:0,y:0,scaleX:1,scaleY:1};function bf(a){let{children:b}=a;return w.default.createElement(a0.Provider,{value:a_},w.default.createElement(a6.Provider,{value:be},b))}let bg={position:"fixed",touchAction:"none"},bh=a=>S(a)?"transform 250ms ease":void 0,bi=(0,w.forwardRef)((a,b)=>{let{as:c,activatorEvent:d,adjustScale:e,children:f,className:g,rect:h,style:i,transform:j,transition:k=bh}=a;if(!h)return null;let l=e?j:{...j,scaleX:1,scaleY:1},m={...bg,width:h.width,height:h.height,top:h.top,left:h.left,transform:U.Transform.toString(l),transformOrigin:e&&d?function(a,b){let c=T(a);if(!c)return"0 0";let d={x:(c.x-b.left)/b.width*100,y:(c.y-b.top)/b.height*100};return d.x+"% "+d.y+"%"}(d,h):void 0,transition:"function"==typeof k?k(d):k,...i};return w.default.createElement(c,{className:g,style:m,ref:b},f)}),bj={duration:250,easing:"ease",keyframes:a=>{let{transform:{initial:b,final:c}}=a;return[{transform:U.Transform.toString(b)},{transform:U.Transform.toString(c)}]},sideEffects:(b={styles:{active:{opacity:"0"}}},a=>{let{active:c,dragOverlay:d}=a,e={},{styles:f,className:g}=b;if(null!=f&&f.active)for(let[a,b]of Object.entries(f.active))void 0!==b&&(e[a]=c.node.style.getPropertyValue(a),c.node.style.setProperty(a,b));if(null!=f&&f.dragOverlay)for(let[a,b]of Object.entries(f.dragOverlay))void 0!==b&&d.node.style.setProperty(a,b);return null!=g&&g.active&&c.node.classList.add(g.active),null!=g&&g.dragOverlay&&d.node.classList.add(g.dragOverlay),function(){for(let[a,b]of Object.entries(e))c.node.style.setProperty(a,b);null!=g&&g.active&&c.node.classList.remove(g.active)}})},bk=0,bl=w.default.memo(a=>{var b;let{adjustScale:c=!1,children:d,dropAnimation:e,style:f,transition:g,modifiers:h,wrapperElement:i="div",className:j,zIndex:k=999}=a,{activatorEvent:l,active:m,activeNodeRect:n,containerNodeRect:o,draggableNodes:p,droppableContainers:q,dragOverlay:r,over:s,measuringConfiguration:t,scrollableAncestors:u,scrollableAncestorRects:v,windowRect:x}=ba(),y=(0,w.useContext)(a6),z=(b=null==m?void 0:m.id,(0,w.useMemo)(()=>{if(null!=b)return++bk},[b])),A=a5(h,{activatorEvent:l,active:m,activeNodeRect:n,containerNodeRect:o,draggingNodeRect:r.rect,over:s,overlayNodeRect:r.rect,scrollableAncestors:u,scrollableAncestorRects:v,transform:y,windowRect:x}),B=aN(n),D=function(a){let{config:b,draggableNodes:c,droppableContainers:d,measuringConfiguration:e}=a;return I((a,f)=>{if(null===b)return;let g=c.get(a);if(!g)return;let h=g.node.current;if(!h)return;let i=aV(f);if(!i)return;let{transform:j}=C(f).getComputedStyle(f),k=ak(j);if(!k)return;let l="function"==typeof b?b:function(a){let{duration:b,easing:c,sideEffects:d,keyframes:e}={...bj,...a};return a=>{let{active:f,dragOverlay:g,transform:h,...i}=a;if(!b)return;let j={x:g.rect.left-f.rect.left,y:g.rect.top-f.rect.top},k={scaleX:1!==h.scaleX?f.rect.width*h.scaleX/g.rect.width:1,scaleY:1!==h.scaleY?f.rect.height*h.scaleY/g.rect.height:1},l={x:h.x-j.x,y:h.y-j.y,...k},m=e({...i,active:f,dragOverlay:g,transform:{initial:h,final:l}}),[n]=m,o=m[m.length-1];if(JSON.stringify(n)===JSON.stringify(o))return;let p=null==d?void 0:d({active:f,dragOverlay:g,...i}),q=g.node.animate(m,{duration:b,easing:c,fill:"forwards"});return new Promise(a=>{q.onfinish=()=>{null==p||p(),a()}})}}(b);return aw(h,e.draggable.measure),l({active:{id:a,data:g.data,node:h,rect:e.draggable.measure(h)},draggableNodes:c,dragOverlay:{node:f,rect:e.dragOverlay.measure(i)},droppableContainers:d,measuringConfiguration:e,transform:k})})}({config:e,draggableNodes:p,droppableContainers:q,measuringConfiguration:t}),E=B?r.setRef:void 0;return w.default.createElement(bf,null,w.default.createElement(bd,{animation:D},m&&z?w.default.createElement(bi,{key:z,id:m.id,ref:E,as:i,activatorEvent:l,adjustScale:c,className:j,transition:g,rect:B,style:{zIndex:k,...f},transform:A},d):null))});function bm(a,b,c){let d=a.slice();return d.splice(c<0?d.length+c:c,0,d.splice(b,1)[0]),d}function bn(a){return null!==a&&a>=0}let bo=a=>{let{rects:b,activeIndex:c,overIndex:d,index:e}=a,f=bm(b,d,c),g=b[e],h=f[e];return h&&g?{x:h.left-g.left,y:h.top-g.top,scaleX:h.width/g.width,scaleY:h.height/g.height}:null},bp={scaleX:1,scaleY:1},bq=a=>{var b,c,d,e;let f,g,h,{activeIndex:i,activeNodeRect:j,index:k,rects:l,overIndex:m}=a,n=null!=(b=l[i])?b:j;if(!n)return null;if(k===i){let a=l[m];return a?{x:0,y:i<m?a.top+a.height-(n.top+n.height):a.top-n.top,...bp}:null}let o=(c=l,d=k,e=i,f=c[d],g=c[d-1],h=c[d+1],f?e<d?g?f.top-(g.top+g.height):h?h.top-(f.top+f.height):0:h?h.top-(f.top+f.height):g?f.top-(g.top+g.height):0:0);return k>i&&k<=m?{x:0,y:-n.height-o,...bp}:k<i&&k>=m?{x:0,y:n.height+o,...bp}:{x:0,y:0,...bp}},br="Sortable",bs=w.default.createContext({activeIndex:-1,containerId:br,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:bo,disabled:{draggable:!1,droppable:!1}});function bt(a){let{children:b,id:c,items:d,strategy:e=bo,disabled:f=!1}=a,{active:g,dragOverlay:h,droppableRects:i,over:j,measureDroppableContainers:k}=ba(),l=O(br,c),m=null!==h.rect,n=(0,w.useMemo)(()=>d.map(a=>"object"==typeof a&&"id"in a?a.id:a),[d]),o=null!=g,p=g?n.indexOf(g.id):-1,q=j?n.indexOf(j.id):-1,r=(0,w.useRef)(n),s=!function(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}(n,r.current),t=-1!==q&&-1===p||s,u="boolean"==typeof f?{draggable:f,droppable:f}:f;H(()=>{s&&o&&k(n)},[s,n,o,k]),(0,w.useEffect)(()=>{r.current=n},[n]);let v=(0,w.useMemo)(()=>({activeIndex:p,containerId:l,disabled:u,disableTransforms:t,items:n,overIndex:q,useDragOverlay:m,sortedRects:n.reduce((a,b,c)=>{let d=i.get(b);return d&&(a[c]=d),a},Array(n.length)),strategy:e}),[p,l,u.draggable,u.droppable,t,n,q,i,m,e]);return w.default.createElement(bs.Provider,{value:v},b)}let bu=a=>{let{id:b,items:c,activeIndex:d,overIndex:e}=a;return bm(c,d,e).indexOf(b)},bv=a=>{let{containerId:b,isSorting:c,wasDragging:d,index:e,items:f,newIndex:g,previousItems:h,previousContainerId:i,transition:j}=a;return!!j&&!!d&&(h===f||e!==g)&&(!!c||g!==e&&b===i)},bw={duration:200,easing:"ease"},bx="transform",by=U.Transition.toString({property:bx,duration:0,easing:"linear"}),bz={roleDescription:"sortable"};function bA({opportunity:a,isDragging:b,onEdit:c,onDelete:d}){var e;let{attributes:f,listeners:g,setNodeRef:h,transform:i,transition:j,isDragging:k}=function(a){var b,c,d,e;let{animateLayoutChanges:f=bv,attributes:g,disabled:h,data:i,getNewIndex:j=bu,id:k,strategy:l,resizeObserverConfig:m,transition:n=bw}=a,{items:o,containerId:p,activeIndex:q,disabled:r,disableTransforms:s,sortedRects:t,overIndex:u,useDragOverlay:v,strategy:x}=(0,w.useContext)(bs),y=(b=h,c=r,"boolean"==typeof b?{draggable:b,droppable:!1}:{draggable:null!=(d=null==b?void 0:b.draggable)?d:c.draggable,droppable:null!=(e=null==b?void 0:b.droppable)?e:c.droppable}),z=o.indexOf(k),A=(0,w.useMemo)(()=>({sortable:{containerId:p,index:z,items:o},...i}),[p,i,z,o]),B=(0,w.useMemo)(()=>o.slice(o.indexOf(k)),[o,k]),{rect:C,node:D,isOver:E,setNodeRef:F}=bc({id:k,data:A,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:B,...m}}),{active:G,activatorEvent:I,activeNodeRect:K,attributes:M,setNodeRef:N,listeners:P,isDragging:Q,over:R,setActivatorNodeRef:T,transform:V}=function(a){let{id:b,data:c,disabled:d=!1,attributes:e}=a,f=O("Draggable"),{activators:g,activatorEvent:h,active:i,activeNodeRect:j,ariaDescribedById:k,draggableNodes:l,over:m}=(0,w.useContext)(a0),{role:n=a9,roleDescription:o="draggable",tabIndex:p=0}=null!=e?e:{},q=(null==i?void 0:i.id)===b,r=(0,w.useContext)(q?a6:a8),[s,t]=L(),[u,v]=L(),x=(0,w.useMemo)(()=>g.reduce((a,c)=>{let{eventName:d,handler:e}=c;return a[d]=a=>{e(a,b)},a},{}),[g,b]),y=J(c);return H(()=>(l.set(b,{id:b,key:f,node:s,activatorNode:u,data:y}),()=>{let a=l.get(b);a&&a.key===f&&l.delete(b)}),[l,b]),{active:i,activatorEvent:h,activeNodeRect:j,attributes:(0,w.useMemo)(()=>({role:n,tabIndex:p,"aria-disabled":d,"aria-pressed":!!q&&n===a9||void 0,"aria-roledescription":o,"aria-describedby":k.draggable}),[d,n,p,q,o,k.draggable]),isDragging:q,listeners:d?void 0:x,node:s,over:m,setNodeRef:t,setActivatorNodeRef:v,transform:r}}({id:k,data:A,attributes:{...bz,...g},disabled:y.draggable}),W=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return(0,w.useMemo)(()=>a=>{b.forEach(b=>b(a))},b)}(F,N),X=!!G,Y=X&&!s&&bn(q)&&bn(u),Z=!v&&Q,$=Z&&Y?V:null,_=Y?null!=$?$:(null!=l?l:x)({rects:t,activeNodeRect:K,activeIndex:q,overIndex:u,index:z}):null,aa=bn(q)&&bn(u)?j({id:k,items:o,activeIndex:q,overIndex:u}):z,ab=null==G?void 0:G.id,ac=(0,w.useRef)({activeId:ab,items:o,newIndex:aa,containerId:p}),ad=o!==ac.current.items,ae=f({active:G,containerId:p,isDragging:Q,isSorting:X,id:k,index:z,items:o,newIndex:ac.current.newIndex,previousItems:ac.current.items,previousContainerId:ac.current.containerId,transition:n,wasDragging:null!=ac.current.activeId}),af=function(a){let{disabled:b,index:c,node:d,rect:e}=a,[f,g]=(0,w.useState)(null),h=(0,w.useRef)(c);return H(()=>{if(!b&&c!==h.current&&d.current){let a=e.current;if(a){let b=am(d.current,{ignoreTransform:!0}),c={x:a.left-b.left,y:a.top-b.top,scaleX:a.width/b.width,scaleY:a.height/b.height};(c.x||c.y)&&g(c)}}c!==h.current&&(h.current=c)},[b,c,d,e]),(0,w.useEffect)(()=>{f&&g(null)},[f]),f}({disabled:!ae,index:z,node:D,rect:C});return(0,w.useEffect)(()=>{X&&ac.current.newIndex!==aa&&(ac.current.newIndex=aa),p!==ac.current.containerId&&(ac.current.containerId=p),o!==ac.current.items&&(ac.current.items=o)},[X,aa,p,o]),(0,w.useEffect)(()=>{if(ab===ac.current.activeId)return;if(ab&&!ac.current.activeId){ac.current.activeId=ab;return}let a=setTimeout(()=>{ac.current.activeId=ab},50);return()=>clearTimeout(a)},[ab]),{active:G,activeIndex:q,attributes:M,data:A,rect:C,index:z,newIndex:aa,items:o,isOver:E,isSorting:X,isDragging:Q,listeners:P,node:D,overIndex:u,over:R,setNodeRef:W,setActivatorNodeRef:T,setDroppableNodeRef:F,setDraggableNodeRef:N,transform:null!=af?af:_,transition:af||ad&&ac.current.newIndex===z?by:(!Z||S(I))&&n&&(X||ae)?U.Transition.toString({...n,property:bx}):void 0}}({id:a.id}),l={transform:U.Transform.toString(i),transition:j,opacity:k?.5:1},m={low:"bg-gray-100 text-gray-600",medium:"bg-blue-100 text-blue-600",high:"bg-orange-100 text-orange-600",urgent:"bg-red-100 text-red-600"};return(0,v.jsxs)("div",{ref:h,style:l,...f,...g,className:`
        bg-white rounded-lg shadow-sm border border-gray-200 p-3 mb-2
        cursor-grab active:cursor-grabbing
        hover:shadow-md transition-shadow
        ${b?"shadow-lg ring-2 ring-green-500 ring-opacity-50":""}
      `,children:[(0,v.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,v.jsxs)("div",{className:"flex items-center gap-2 flex-1 pr-2",children:[a.contact&&(0,v.jsx)("div",{className:"w-7 h-7 rounded-full bg-green-100 flex items-center justify-center text-xs font-semibold text-green-700",children:(e=a.contact)?`${e.firstName?.[0]||""}${e.lastName?.[0]||""}`.toUpperCase():"?"}),(0,v.jsx)("h4",{className:"font-medium text-gray-900 text-sm line-clamp-2",children:a.name})]}),(0,v.jsx)("span",{className:`text-xs px-2 py-0.5 rounded-full flex-shrink-0 ${m[a.priority]||m.medium}`,children:a.priority})]}),a.contact?.email&&(0,v.jsx)("div",{className:"text-xs text-gray-500 mb-2 truncate",children:a.contact.email}),(0,v.jsx)("div",{className:"text-lg font-bold text-green-600 mb-2",children:((a,b="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:b,minimumFractionDigits:0,maximumFractionDigits:0}).format(a))(a.value,a.currency)}),a.tags&&a.tags.length>0&&(0,v.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[a.tags.slice(0,2).map((a,b)=>(0,v.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:a},b)),a.tags.length>2&&(0,v.jsxs)("span",{className:"text-xs text-gray-400",children:["+",a.tags.length-2]})]}),(0,v.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-2 border-t border-gray-100",children:[(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)("span",{children:"ðŸ“Š"}),(0,v.jsxs)("span",{children:[a.probability,"%"]})]}),a.expectedCloseDate&&(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)("span",{children:"ðŸ“…"}),(0,v.jsx)("span",{children:new Date(a.expectedCloseDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]}),(c||d)&&!b&&(0,v.jsxs)("div",{className:"flex items-center justify-end gap-1 mt-2 pt-2 border-t border-gray-100 opacity-0 group-hover:opacity-100 transition-opacity",children:[c&&(0,v.jsx)("button",{onClick:b=>{b.stopPropagation(),c(a)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Edit opportunity",children:"âœï¸"}),d&&(0,v.jsx)("button",{onClick:b=>{b.stopPropagation(),d(a.id)},className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete opportunity",children:"ðŸ—‘ï¸"})]})]})}function bB({stage:a,onAddOpportunity:b,onEditOpportunity:c,onDeleteOpportunity:d,onEditStage:e,onDeleteStage:f}){let[g,h]=(0,w.useState)(!1),{setNodeRef:i,isOver:j}=bc({id:a.id}),k=a.deals.reduce((a,b)=>a+(b.value||0),0);return(0,v.jsxs)("div",{className:`
        w-72 flex-shrink-0 bg-gray-50 rounded-lg flex flex-col
        ${j?"ring-2 ring-green-500 ring-opacity-50 bg-green-50":""}
      `,children:[(0,v.jsxs)("div",{className:"p-3 border-b border-gray-200",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color}}),(0,v.jsxs)("h3",{className:"font-semibold text-gray-900",children:[a.name," ",{open:"",won:"ðŸŽ‰",lost:"âŒ"}[a.stageType]]})]}),(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)("span",{className:"text-sm text-gray-500 bg-gray-200 px-2 py-0.5 rounded-full",children:a.deals.length}),(e||f)&&(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("button",{onClick:()=>h(!g),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded transition-colors",children:(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),g&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),(0,v.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[e&&(0,v.jsxs)("button",{onClick:()=>{h(!1),e(a)},className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Stage"]}),f&&(0,v.jsxs)("button",{onClick:()=>{(h(!1),a.deals.length>0)?alert("Cannot delete stage with opportunities. Move or delete opportunities first."):confirm(`Are you sure you want to delete "${a.name}"?`)&&f(a.id)},className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Stage"]})]})]})]})]})]}),(0,v.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,v.jsx)("span",{className:"text-gray-500",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k)}),(0,v.jsxs)("span",{className:"text-gray-400",children:[a.winProbability,"% prob."]})]})]}),(0,v.jsxs)("div",{ref:i,className:"flex-1 p-2 overflow-y-auto min-h-[200px]",children:[(0,v.jsx)(bt,{items:a.deals.map(a=>a.id),strategy:bq,children:a.deals.map(a=>(0,v.jsx)("div",{className:"group",children:(0,v.jsx)(bA,{opportunity:a,onEdit:c,onDelete:d})},a.id))}),0===a.deals.length&&(0,v.jsx)("div",{className:"text-center py-8 text-gray-400",children:(0,v.jsx)("p",{className:"text-sm",children:"No opportunities in this stage"})})]}),(0,v.jsx)("div",{className:"p-2 border-t border-gray-200",children:(0,v.jsxs)("button",{onClick:b,className:"w-full py-2 text-sm text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors flex items-center justify-center gap-1",children:[(0,v.jsx)("span",{children:"+"}),(0,v.jsx)("span",{children:"Add Opportunity"})]})})]})}function bC({isOpen:a,onClose:b,onSave:c,opportunity:d,pipeline:e,defaultStageId:f,subAccountId:g}){let[h,i]=(0,w.useState)({description:"",value:0,currency:"USD",stageId:"",priority:"medium",expectedCloseDate:"",source:"",tags:[],contactId:""}),[j,k]=(0,w.useState)(!1),[l,m]=(0,w.useState)(null),[n,o]=(0,w.useState)([]),[p,q]=(0,w.useState)(""),[r,s]=(0,w.useState)(!1),[t,u]=(0,w.useState)(null),[x,y]=(0,w.useState)(""),z=(0,w.useRef)(null),A=(0,w.useRef)(null);(0,w.useEffect)(()=>{d?(i({description:d.description||"",value:d.value||0,currency:d.currency||"USD",stageId:d.stageId||"",priority:d.priority||"medium",expectedCloseDate:d.expectedCloseDate?.split("T")[0]||"",source:d.source||"",tags:d.tags||[],contactId:d.contactId||d.contact?.id||""}),d.contact&&(u(d.contact),q(`${d.contact.firstName} ${d.contact.lastName}`))):(i({description:"",value:0,currency:"USD",stageId:f||e?.stages?.[0]?.id||"",priority:"medium",expectedCloseDate:"",source:"",tags:[],contactId:""}),u(null),q(""))},[d,f,e]),(0,w.useEffect)(()=>{a&&B()},[a]),(0,w.useEffect)(()=>{let a=a=>{A.current&&!A.current.contains(a.target)&&s(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let B=async()=>{try{let a=await fetch(`/api/v1/contacts?subAccountId=${g}&limit=100`),b=await a.json();b.success&&b.data&&o(b.data.contacts||[])}catch(a){console.error("Failed to fetch contacts:",a),o([])}},C=n.filter(a=>`${a.firstName} ${a.lastName} ${a.email} ${a.company||""}`.toLowerCase().includes(p.toLowerCase())),D=async a=>{if(a.preventDefault(),m(null),!t)return void m("Please select a contact for this opportunity");if(!h.stageId)return void m("Please select a stage");try{k(!0);let a=`${t.firstName} ${t.lastName}`,b={...h,name:a,subAccountId:g,pipelineId:e?.id,contactId:t.id},f=d?`/api/v1/deals/${d.id}`:"/api/v1/deals",i=d?"PUT":"POST",j=await fetch(f,{method:i,headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),l=await j.json();if(!l.success)throw Error(l.error);c()}catch(a){m(a.message||"Failed to save opportunity")}finally{k(!1)}},E=()=>{x.trim()&&!h.tags.includes(x.trim())&&(i({...h,tags:[...h.tags,x.trim()]}),y(""))};return a?(0,v.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,v.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:b}),(0,v.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,v.jsxs)("div",{className:"relative bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,v.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:d?"Edit Opportunity":"Create New Opportunity"}),(0,v.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"âœ•"})]}),(0,v.jsxs)("form",{onSubmit:D,className:"p-6 space-y-6",children:[l&&(0,v.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:l}),(0,v.jsxs)("div",{ref:A,className:"relative",children:[(0,v.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Contact ",(0,v.jsx)("span",{className:"text-red-500",children:"*"}),(0,v.jsx)("span",{className:"text-xs text-gray-500 font-normal ml-2",children:"(Contact name will be the Opportunity Title)"})]}),t?(0,v.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsxs)("div",{className:"w-10 h-10 rounded-full bg-green-600 text-white flex items-center justify-center font-semibold",children:[t.firstName[0],t.lastName[0]]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"font-medium text-gray-900",children:[t.firstName," ",t.lastName]}),(0,v.jsxs)("div",{className:"text-sm text-gray-500",children:[t.email,t.company&&` â€¢ ${t.company}`]})]})]}),(0,v.jsx)("button",{type:"button",onClick:()=>{u(null),i({...h,contactId:""}),q(""),z.current?.focus()},className:"text-gray-400 hover:text-gray-600 p-1",title:"Change contact",children:(0,v.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,v.jsx)("input",{ref:z,type:"text",value:p,onChange:a=>{q(a.target.value),s(!0)},onFocus:()=>s(!0),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Search contacts by name, email, or company..."})]}),r&&(0,v.jsx)("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:0===C.length?(0,v.jsx)("div",{className:"px-4 py-3 text-gray-500 text-center",children:p?"No contacts found":"Start typing to search contacts"}):C.map(a=>(0,v.jsxs)("button",{type:"button",onClick:()=>{u(a),i({...h,contactId:a.id}),q(`${a.firstName} ${a.lastName}`),s(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3 border-b border-gray-100 last:border-0",children:[(0,v.jsxs)("div",{className:"w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center text-sm font-medium",children:[a.firstName[0],a.lastName[0]]}),(0,v.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,v.jsxs)("div",{className:"font-medium text-gray-900 truncate",children:[a.firstName," ",a.lastName]}),(0,v.jsxs)("div",{className:"text-sm text-gray-500 truncate",children:[a.email,a.company&&` â€¢ ${a.company}`]})]})]},a.id))})]}),(0,v.jsxs)("p",{className:"mt-2 text-xs text-gray-500",children:[(0,v.jsx)("svg",{className:"inline w-4 h-4 mr-1 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"The opportunity title stays synchronized with the contact's name. If you update the contact's name later, this opportunity title will also update."]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opportunity Value"}),(0,v.jsxs)("div",{className:"flex",children:[(0,v.jsxs)("select",{value:h.currency,onChange:a=>i({...h,currency:a.target.value}),className:"px-3 py-2 border border-r-0 border-gray-200 rounded-l-lg bg-gray-50 text-gray-600",children:[(0,v.jsx)("option",{value:"USD",children:"$"}),(0,v.jsx)("option",{value:"EUR",children:"â‚¬"}),(0,v.jsx)("option",{value:"GBP",children:"Â£"}),(0,v.jsx)("option",{value:"CAD",children:"C$"})]}),(0,v.jsx)("input",{type:"number",value:h.value,onChange:a=>i({...h,value:parseFloat(a.target.value)||0}),className:"flex-1 px-4 py-2 border border-gray-200 rounded-r-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"0",step:"0.01"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Stage ",(0,v.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,v.jsxs)("select",{value:h.stageId,onChange:a=>i({...h,stageId:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[(0,v.jsx)("option",{value:"",children:"Select stage..."}),e?.stages.map(a=>(0,v.jsxs)("option",{value:a.id,children:[a.name," (",a.winProbability,"%)"]},a.id))]})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,v.jsxs)("select",{value:h.priority,onChange:a=>i({...h,priority:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,v.jsx)("option",{value:"low",children:"Low"}),(0,v.jsx)("option",{value:"medium",children:"Medium"}),(0,v.jsx)("option",{value:"high",children:"High"}),(0,v.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Close Date"}),(0,v.jsx)("input",{type:"date",value:h.expectedCloseDate,onChange:a=>i({...h,expectedCloseDate:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Source"}),(0,v.jsxs)("select",{value:h.source,onChange:a=>i({...h,source:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,v.jsx)("option",{value:"",children:"Select source..."}),(0,v.jsx)("option",{value:"website",children:"Website"}),(0,v.jsx)("option",{value:"referral",children:"Referral"}),(0,v.jsx)("option",{value:"cold_call",children:"Cold Call"}),(0,v.jsx)("option",{value:"advertisement",children:"Advertisement"}),(0,v.jsx)("option",{value:"social_media",children:"Social Media"}),(0,v.jsx)("option",{value:"email_campaign",children:"Email Campaign"}),(0,v.jsx)("option",{value:"trade_show",children:"Trade Show"}),(0,v.jsx)("option",{value:"other",children:"Other"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),(0,v.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:h.tags.map(a=>(0,v.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-sm",children:[a,(0,v.jsx)("button",{type:"button",onClick:()=>{i({...h,tags:h.tags.filter(b=>b!==a)})},className:"hover:text-green-900",children:"Ã—"})]},a))}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsx)("input",{type:"text",value:x,onChange:a=>y(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),E())},className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add a tag..."}),(0,v.jsx)("button",{type:"button",onClick:E,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Add"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,v.jsx)("textarea",{value:h.description,onChange:a=>i({...h,description:a.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add notes about this opportunity..."})]}),(0,v.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,v.jsx)("button",{type:"button",onClick:b,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),(0,v.jsx)("button",{type:"submit",disabled:j||!t,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?"Saving...":d?"Update Opportunity":"Create Opportunity"})]})]})]})})]}):null}function bD({pipelines:a,selectedPipeline:b,onSelect:c,onCreatePipeline:d,subAccountId:e}){let[f,g]=(0,w.useState)(!1),[h,i]=(0,w.useState)(!1),[j,k]=(0,w.useState)(""),[l,m]=(0,w.useState)(!1),n=async()=>{if(j.trim())try{m(!0);let a=await fetch("/api/v1/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subAccountId:e,name:j.trim(),createDefaultStages:!0})}),b=await a.json();if(!b.success)throw Error(b.error);k(""),i(!1),g(!1),d()}catch(a){alert("Failed to create pipeline: "+a.message)}finally{m(!1)}};return(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsxs)("button",{onClick:()=>g(!f),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors min-w-[200px]",children:[b?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{children:b.icon}),(0,v.jsx)("span",{className:"font-medium text-gray-900",children:b.name})]}):(0,v.jsx)("span",{className:"text-gray-500",children:"Select Pipeline"}),(0,v.jsx)("span",{className:"ml-auto text-gray-400",children:"â–¼"})]}),f&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>{g(!1),i(!1)}}),(0,v.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[(0,v.jsxs)("div",{className:"max-h-60 overflow-y-auto",children:[a.map(a=>(0,v.jsxs)("button",{onClick:()=>{c(a),g(!1)},className:`
                    w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors
                    ${b?.id===a.id?"bg-green-50":""}
                  `,children:[(0,v.jsx)("span",{className:"text-xl",children:a.icon}),(0,v.jsxs)("div",{className:"flex-1",children:[(0,v.jsx)("p",{className:"font-medium text-gray-900",children:a.name}),a.isDefault&&(0,v.jsx)("p",{className:"text-xs text-gray-400",children:"Default"})]}),b?.id===a.id&&(0,v.jsx)("span",{className:"text-green-600",children:"âœ“"})]},a.id)),0===a.length&&!h&&(0,v.jsxs)("div",{className:"px-4 py-8 text-center text-gray-500",children:[(0,v.jsx)("p",{children:"No pipelines yet"}),(0,v.jsx)("p",{className:"text-sm",children:"Create your first pipeline below"})]})]}),(0,v.jsx)("div",{className:"border-t border-gray-200 p-3",children:h?(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("input",{type:"text",value:j,onChange:a=>k(a.target.value),placeholder:"Pipeline name...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",autoFocus:!0,onKeyDown:a=>{"Enter"===a.key&&n(),"Escape"===a.key&&(i(!1),k(""))}}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsx)("button",{onClick:n,disabled:l||!j.trim(),className:"flex-1 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:l?"Creating...":"Create"}),(0,v.jsx)("button",{onClick:()=>{i(!1),k("")},className:"px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm",children:"Cancel"})]})]}):(0,v.jsxs)("button",{onClick:()=>i(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors text-sm",children:[(0,v.jsx)("span",{children:"+"}),(0,v.jsx)("span",{children:"Create New Pipeline"})]})})]})]})]})}o.Down,o.Right,o.Up,o.Left;let bE=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#F97316","#6366F1","#14B8A6","#84CC16","#A855F7"];function bF({isOpen:a,onClose:b,onSave:c,stage:d,pipelineId:e,subAccountId:f,existingStagesCount:g}){let[h,i]=(0,w.useState)({name:"",color:bE[0],stageType:"open",winProbability:50,displayOrder:g}),[j,k]=(0,w.useState)(!1),[l,m]=(0,w.useState)(null);(0,w.useEffect)(()=>{d?i({name:d.name||"",color:d.color||bE[0],stageType:d.stageType||"open",winProbability:d.winProbability??50,displayOrder:d.displayOrder??g}):i({name:"",color:bE[g%bE.length],stageType:"open",winProbability:50,displayOrder:g})},[d,g]);let n=async a=>{if(a.preventDefault(),m(null),!h.name.trim())return void m("Stage name is required");try{k(!0);let a={...h,pipelineId:e,subAccountId:f},b=d?`/api/v1/pipelines/${e}/stages/${d.id}`:`/api/v1/pipelines/${e}/stages`,g=d?"PUT":"POST",i=await fetch(b,{method:g,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),j=await i.json();if(!j.success)throw Error(j.error);c()}catch(a){m(a.message||"Failed to save stage")}finally{k(!1)}};return a?(0,v.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,v.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:b}),(0,v.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,v.jsxs)("div",{className:"relative bg-white rounded-xl shadow-xl max-w-lg w-full",children:[(0,v.jsxs)("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:d?"Edit Stage":"Add New Stage"}),(0,v.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,v.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,v.jsxs)("form",{onSubmit:n,className:"p-6 space-y-6",children:[l&&(0,v.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:l}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Stage Name ",(0,v.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,v.jsx)("input",{type:"text",value:h.name,onChange:a=>i({...h,name:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Qualified Lead, Proposal Sent",required:!0})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stage Type"}),(0,v.jsx)("div",{className:"grid grid-cols-3 gap-3",children:[{value:"open",label:"Open",icon:"ðŸ“‹",description:"In progress"},{value:"won",label:"Won",icon:"ðŸŽ‰",description:"Opportunity won"},{value:"lost",label:"Lost",icon:"âŒ",description:"Opportunity lost"}].map(a=>(0,v.jsxs)("button",{type:"button",onClick:()=>i({...h,stageType:a.value,winProbability:"won"===a.value?100:"lost"===a.value?0:h.winProbability}),className:`p-3 rounded-lg border-2 text-center transition-colors ${h.stageType===a.value?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,v.jsx)("div",{className:"text-2xl mb-1",children:a.icon}),(0,v.jsx)("div",{className:"font-medium text-gray-900",children:a.label}),(0,v.jsx)("div",{className:"text-xs text-gray-500",children:a.description})]},a.value))})]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Win Probability: ",h.winProbability,"%"]}),(0,v.jsx)("input",{type:"range",min:"0",max:"100",step:"5",value:h.winProbability,onChange:a=>i({...h,winProbability:parseInt(a.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-green-600",disabled:"won"===h.stageType||"lost"===h.stageType}),(0,v.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,v.jsx)("span",{children:"0%"}),(0,v.jsx)("span",{children:"50%"}),(0,v.jsx)("span",{children:"100%"})]}),("won"===h.stageType||"lost"===h.stageType)&&(0,v.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Probability is fixed at ","won"===h.stageType?"100%":"0%"," for ",h.stageType," stages"]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stage Color"}),(0,v.jsx)("div",{className:"flex flex-wrap gap-2",children:bE.map(a=>(0,v.jsx)("button",{type:"button",onClick:()=>i({...h,color:a}),className:`w-8 h-8 rounded-full transition-transform ${h.color===a?"ring-2 ring-offset-2 ring-gray-400 scale-110":""}`,style:{backgroundColor:a}},a))}),(0,v.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,v.jsx)("input",{type:"color",value:h.color,onChange:a=>i({...h,color:a.target.value}),className:"w-10 h-10 rounded cursor-pointer border border-gray-200"}),(0,v.jsx)("input",{type:"text",value:h.color,onChange:a=>i({...h,color:a.target.value}),className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm font-mono",placeholder:"#000000"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,v.jsx)("input",{type:"number",value:h.displayOrder,onChange:a=>i({...h,displayOrder:parseInt(a.target.value)||0}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"0"}),(0,v.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first (left to right)"})]}),(0,v.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,v.jsx)("button",{type:"button",onClick:b,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),(0,v.jsx)("button",{type:"submit",disabled:j,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?"Saving...":d?"Update Stage":"Create Stage"})]})]})]})})]}):null}var bG=a.i(86377);let bH=[{id:"pipeline",label:"Lead Engine",icon:"fa-rocket",href:"/sub-account/lead-engine"},{id:"manage",label:"Manage Engines",icon:"fa-cogs",href:"/sub-account/lead-engine?tab=manage"},{id:"bulk-actions",label:"Bulk Actions",icon:"fa-tasks",href:"/sub-account/lead-engine?tab=bulk-actions"}];function bI(){var a;let b=(0,y.useSearchParams)().get("tab")||"pipeline",[c,d]=(0,w.useState)([]),[e,f]=(0,w.useState)(null),[g,h]=(0,w.useState)(!0),[i,j]=(0,w.useState)(null),[k,l]=(0,w.useState)(!1),[m,n]=(0,w.useState)(null),[o,p]=(0,w.useState)(null),[q,r]=(0,w.useState)(!1),[s,t]=(0,w.useState)(null),[u,z]=(0,w.useState)(null),A="sub-001",B=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return(0,w.useMemo)(()=>[...b].filter(a=>null!=a),[...b])}((a={activationConstraint:{distance:8}},(0,w.useMemo)(()=>({sensor:aK,options:null!=a?a:{}}),[aK,a]))),C=async()=>{try{h(!0);let a=await fetch(`/api/v1/pipelines?subAccountId=${A}&includeStages=true&includeDeals=true`),b=await a.json();if(!b.success)throw Error(b.error);if(d(b.data),b.data.length>0){let a=b.data.find(a=>a.isDefault)||b.data[0];f(a)}}catch(a){j(a.message)}finally{h(!1)}};(0,w.useEffect)(()=>{C()},[]);let D=async a=>{let{active:b,over:c}=a;if(z(null),!c||!e)return;let d=b.id,g=c.id,h=E(d);if(!h||h.stageId===g)return;let i={...e};i.stages=i.stages.map(a=>a.id===h.stageId?{...a,opportunities:a.deals.filter(a=>a.id!==d)}:a.id===g?{...a,opportunities:[...a.deals,{...h,stageId:g}]}:a),f(i);try{let a=await fetch(`/api/v1/deals/${d}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({stageId:g})}),b=await a.json();if(!b.success)throw Error(b.error);C()}catch(a){console.error("Failed to move opportunity:",a),C()}},E=a=>{if(e)for(let b of e.stages){let c=b.deals.find(b=>b.id===a);if(c)return c}},F=async a=>{if(confirm("Are you sure you want to delete this opportunity?"))try{let b=await fetch(`/api/v1/deals/${a}`,{method:"DELETE"}),c=await b.json();if(!c.success)throw Error(c.error);C()}catch(a){alert("Failed to delete deal: "+a.message)}},G=async a=>{if(e)try{let b=await fetch(`/api/v1/pipelines/${e.id}/stages/${a}`,{method:"DELETE"}),c=await b.json();if(!c.success)throw Error(c.error);C()}catch(a){alert("Failed to delete stage: "+a.message)}},H=(()=>{if(!e)return{totalOpportunities:0,totalValue:0,wonValue:0,openOpportunities:0};let a=0,b=0,c=0,d=0;return e.stages.forEach(e=>{e.deals.forEach(f=>{a++,b+=f.value||0,"won"===e.stageType&&(c+=f.value||0),"open"===e.stageType&&d++})}),{totalOpportunities:a,totalValue:b,wonValue:c,openOpportunities:d}})();return(0,v.jsxs)("div",{className:"space-y-6 -m-4 sm:-m-6 lg:-m-8",children:[(0,v.jsxs)("div",{className:"flex-none bg-white border-b border-gray-200 px-4 sm:px-6 lg:px-8 pt-4 sm:pt-6 lg:pt-8 pb-0",children:[(0,v.jsx)(bG.PageHeader,{title:"Lead Engine",description:"Manage sales pipelines, track opportunities, and drive revenue growth",icon:"fa-rocket"}),(0,v.jsx)("nav",{className:"-mb-px flex space-x-8","aria-label":"Lead Engine tabs",children:bH.map(a=>{let c=a.id===b;return(0,v.jsxs)(x.default,{href:a.href,className:`group inline-flex items-center border-b-2 py-4 px-1 text-sm font-medium transition-colors ${c?"border-[var(--theme-secondary)] text-[var(--theme-secondary)]":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:[(0,v.jsx)("i",{className:`fas ${a.icon} mr-2 text-base`,style:{color:c?"var(--theme-secondary)":void 0}}),a.label]},a.id)})})]}),(0,v.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 pb-4 sm:pb-6 lg:pb-8",children:["pipeline"===b&&(0,v.jsx)(bJ,{pipelines:c,selectedPipeline:e,setSelectedPipeline:f,loading:g,error:i,stats:H,sensors:B,activeOpportunity:u,subAccountId:A,onDragStart:a=>{let{active:b}=a;E(b.id),z(opportunity||null)},onDragEnd:D,onCreateOpportunity:a=>{n(null),p(a||null),l(!0)},onEditOpportunity:a=>{n(a),p(null),l(!0)},onDeleteOpportunity:F,onCreateStage:()=>{t(null),r(!0)},onEditStage:a=>{t(a),r(!0)},onDeleteStage:G,fetchPipelines:C}),"manage"===b&&(0,v.jsx)(bK,{pipelines:c,loading:g,subAccountId:A,onPipelineUpdated:C}),"bulk-actions"===b&&(0,v.jsx)(bL,{pipelines:c,selectedPipeline:e,loading:g,onRefresh:C})]}),(0,v.jsx)(bC,{isOpen:k,onClose:()=>{l(!1),n(null),p(null)},onSave:()=>{l(!1),n(null),p(null),C()},deal:m,pipeline:e,defaultStageId:o,subAccountId:A}),e&&(0,v.jsx)(bF,{isOpen:q,onClose:()=>{r(!1),t(null)},onSave:()=>{r(!1),t(null),C()},stage:s,pipelineId:e.id,subAccountId:A,existingStagesCount:e.stages.length})]})}function bJ({pipelines:a,selectedPipeline:b,setSelectedPipeline:c,loading:d,error:e,stats:f,sensors:g,activeOpportunity:h,subAccountId:i,onDragStart:j,onDragEnd:k,onCreateOpportunity:l,onEditOpportunity:m,onDeleteOpportunity:n,onCreateStage:o,onEditStage:p,onDeleteStage:q,fetchPipelines:r}){return d?(0,v.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):e?(0,v.jsxs)("div",{className:"rounded-lg p-6 text-center bg-red-50 border border-red-200",children:[(0,v.jsx)("p",{className:"text-red-600",children:e}),(0,v.jsx)("button",{onClick:r,className:"mt-4 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity bg-red-600",children:"Retry"})]}):(0,v.jsxs)("div",{className:"h-full flex flex-col",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ðŸŽ¯ Pipeline View"}),(0,v.jsx)("p",{className:"mt-1 text-gray-500",children:"Drag and drop opportunities between stages"})]}),(0,v.jsxs)("div",{className:"flex items-center gap-4",children:[(0,v.jsx)(bD,{pipelines:a,selectedPipeline:b,onSelect:a=>c(a),onCreatePipeline:r,subAccountId:i}),(0,v.jsxs)("button",{onClick:()=>l(),className:"flex items-center gap-2 px-4 py-2 rounded-lg hover:opacity-90 transition-opacity bg-green-600 text-white",children:[(0,v.jsx)("span",{className:"text-xl",children:"+"}),(0,v.jsx)("span",{children:"Add Opportunity"})]})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,v.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Total Opportunities"}),(0,v.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:f.totalOpportunities})]}),(0,v.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Open Opportunities"}),(0,v.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:f.openOpportunities})]}),(0,v.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Pipeline Value"}),(0,v.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",f.totalValue.toLocaleString()]})]}),(0,v.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Won Value"}),(0,v.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["$",f.wonValue.toLocaleString()]})]})]}),b?(0,v.jsxs)(a7,{sensors:g,collisionDetection:ag,onDragStart:j,onDragEnd:k,children:[(0,v.jsx)("div",{className:"flex-1 overflow-x-auto",children:(0,v.jsxs)("div",{className:"flex gap-4 h-full min-w-max pb-4",children:[b.stages.sort((a,b)=>a.displayOrder-b.displayOrder).filter(a=>"lost"!==a.stageType).map(a=>(0,v.jsx)(bB,{stage:a,onAddOpportunity:()=>l(a.id),onEditOpportunity:m,onDeleteOpportunity:n,onEditStage:p,onDeleteStage:q},a.id)),(0,v.jsx)("div",{className:"w-72 flex-shrink-0",children:(0,v.jsxs)("button",{onClick:o,className:"w-full h-full min-h-[200px] border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center gap-2 text-gray-400 hover:text-gray-600 hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[(0,v.jsx)("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,v.jsx)("span",{className:"font-medium",children:"Add Stage"})]})}),b.stages.filter(a=>"lost"===a.stageType).map(a=>(0,v.jsxs)("div",{className:"w-16 flex-shrink-0 bg-gray-100 rounded-lg p-2 flex flex-col items-center cursor-pointer hover:bg-gray-200 transition-colors",onClick:()=>p(a),title:"Click to edit",children:[(0,v.jsx)("div",{className:"w-3 h-3 rounded-full mb-2",style:{backgroundColor:a.color}}),(0,v.jsxs)("span",{className:"text-xs text-gray-500 writing-mode-vertical transform rotate-180",style:{writingMode:"vertical-rl"},children:[a.name," (",a.deals.length,")"]})]},a.id))]})}),(0,v.jsx)(bl,{children:h?(0,v.jsx)(bA,{opportunity:h,isDragging:!0}):null})]}):(0,v.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50 rounded-lg",children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("p",{className:"text-gray-500 text-lg mb-4",children:"No pipeline selected"}),(0,v.jsx)("p",{className:"text-gray-400",children:"Create a pipeline to get started"})]})})]})}function bK({pipelines:a,loading:b,subAccountId:c,onPipelineUpdated:d}){let[e,f]=(0,w.useState)(!1),[g,h]=(0,w.useState)(null),[i,j]=(0,w.useState)({name:"",description:"",icon:"ðŸŽ¯",color:"#10B981",isDefault:!1}),k=()=>{h(null),j({name:"",description:"",icon:"ðŸŽ¯",color:"#10B981",isDefault:!1}),f(!0)},l=a=>{h(a),j({name:a.name,description:a.description||"",icon:a.icon||"ðŸŽ¯",color:a.color||"#10B981",isDefault:a.isDefault}),f(!0)},m=async()=>{if(i.name.trim())try{if(g){let a=await fetch(`/api/v1/pipelines/${g.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),b=await a.json();if(!b.success)throw Error(b.error)}else{let a=await fetch("/api/v1/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,subAccountId:c})}),b=await a.json();if(!b.success)throw Error(b.error)}f(!1),d()}catch(a){alert("Failed to save pipeline: "+a.message)}},n=async a=>{if(confirm("Are you sure you want to delete this pipeline? All opportunities will be moved to another pipeline or deleted."))try{let b=await fetch(`/api/v1/pipelines/${a}`,{method:"DELETE"}),c=await b.json();if(!c.success)throw Error(c.error);d()}catch(a){alert("Failed to delete pipeline: "+a.message)}},o=async a=>{try{let b=await fetch(`/api/v1/pipelines/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})}),c=await b.json();if(!c.success)throw Error(c.error);d()}catch(a){alert("Failed to set default: "+a.message)}},p=async a=>{try{let b=await fetch("/api/v1/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:`${a.name} (Copy)`,description:a.description,icon:a.icon,color:a.color,isDefault:!1,subAccountId:c,stages:a.stages.map(a=>({name:a.name,color:a.color,stageType:a.stageType,winProbability:a.winProbability,displayOrder:a.displayOrder}))})}),e=await b.json();if(!e.success)throw Error(e.error);d()}catch(a){alert("Failed to duplicate pipeline: "+a.message)}};return b?(0,v.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"âš™ï¸ Manage Engines"}),(0,v.jsx)("p",{className:"mt-1 text-gray-500",children:"Create and configure your sales pipelines"})]}),(0,v.jsxs)("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors",children:[(0,v.jsx)("i",{className:"fas fa-plus"}),(0,v.jsx)("span",{children:"Create Pipeline"})]})]}),0===a.length?(0,v.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[(0,v.jsx)("i",{className:"fas fa-rocket text-5xl text-gray-300 mb-4"}),(0,v.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No pipelines yet"}),(0,v.jsx)("p",{className:"text-gray-500 mb-4",children:"Create your first pipeline to start tracking opportunities"}),(0,v.jsx)("button",{onClick:k,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Create Pipeline"})]}):(0,v.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(a=>{let b,c,d,e,f=(b=0,c=0,d=0,e=0,a.stages.forEach(a=>{b+=a.deals.length,a.deals.forEach(b=>{c+=b.value||0,"open"===a.stageType&&d++,"won"===a.stageType&&e++})}),{totalOpportunities:b,totalValue:c,openOpportunities:d,wonOpportunities:e,stageCount:a.stages.length});return(0,v.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[(0,v.jsxs)("div",{className:"p-4 border-b border-gray-200",style:{backgroundColor:`${a.color}15`},children:[(0,v.jsxs)("div",{className:"flex items-start justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)("span",{className:"text-3xl",children:a.icon||"ðŸŽ¯"}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"font-semibold text-gray-900",children:a.name}),a.isDefault&&(0,v.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full",children:"Default"})]})]}),(0,v.jsxs)("div",{className:"relative group",children:[(0,v.jsx)("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-white/50",children:(0,v.jsx)("i",{className:"fas fa-ellipsis-v"})}),(0,v.jsxs)("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10 hidden group-hover:block",children:[(0,v.jsxs)("button",{onClick:()=>l(a),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-edit w-4"}),"Edit Pipeline"]}),!a.isDefault&&(0,v.jsxs)("button",{onClick:()=>o(a.id),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-star w-4"}),"Set as Default"]}),(0,v.jsxs)("button",{onClick:()=>p(a),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-copy w-4"}),"Duplicate"]}),(0,v.jsx)("hr",{className:"my-1"}),(0,v.jsxs)("button",{onClick:()=>n(a.id),className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-trash w-4"}),"Delete"]})]})]})]}),a.description&&(0,v.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:a.description})]}),(0,v.jsxs)("div",{className:"p-4 space-y-3",children:[(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"text-xs text-gray-500",children:"Total Opportunities"}),(0,v.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:f.totalOpportunities})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"text-xs text-gray-500",children:"Pipeline Value"}),(0,v.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["$",f.totalValue.toLocaleString()]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"text-xs text-gray-500",children:"Open Opportunities"}),(0,v.jsx)("p",{className:"text-lg font-semibold text-blue-600",children:f.openOpportunities})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"text-xs text-gray-500",children:"Won Opportunities"}),(0,v.jsx)("p",{className:"text-lg font-semibold text-green-600",children:f.wonOpportunities})]})]}),(0,v.jsxs)("div",{className:"pt-3 border-t border-gray-200",children:[(0,v.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["Stages (",f.stageCount,")"]}),(0,v.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.stages.sort((a,b)=>a.displayOrder-b.displayOrder).slice(0,5).map(a=>(0,v.jsx)("span",{className:"text-xs px-2 py-1 rounded-full",style:{backgroundColor:`${a.color}20`,color:a.color},children:a.name},a.id)),a.stages.length>5&&(0,v.jsxs)("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-500 rounded-full",children:["+",a.stages.length-5," more"]})]})]})]}),(0,v.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex justify-between",children:[(0,v.jsxs)(x.default,{href:"/sub-account/lead-engine",className:"text-sm text-green-600 hover:text-green-700 flex items-center gap-1",children:[(0,v.jsx)("i",{className:"fas fa-eye"}),"View Pipeline"]}),(0,v.jsxs)("button",{onClick:()=>l(a),className:"text-sm text-gray-600 hover:text-gray-700 flex items-center gap-1",children:[(0,v.jsx)("i",{className:"fas fa-cog"}),"Configure"]})]})]},a.id)})}),e&&(0,v.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,v.jsx)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,v.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:g?"Edit Pipeline":"Create Pipeline"}),(0,v.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:(0,v.jsx)("i",{className:"fas fa-times text-xl"})})]}),(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pipeline Name *"}),(0,v.jsx)("input",{type:"text",value:i.name,onChange:a=>j(b=>({...b,name:a.target.value})),placeholder:"e.g., Sales Pipeline",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,v.jsx)("textarea",{value:i.description,onChange:a=>j(b=>({...b,description:a.target.value})),placeholder:"Brief description...",rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),(0,v.jsx)("div",{className:"flex flex-wrap gap-2",children:["ðŸŽ¯","ðŸ’°","ðŸš€","â­","ðŸ”¥","ðŸ’Ž","ðŸ†","ðŸ“ˆ","ðŸŽª","ðŸŽ¨","âš¡","ðŸŒŸ"].map(a=>(0,v.jsx)("button",{type:"button",onClick:()=>j(b=>({...b,icon:a})),className:`w-10 h-10 text-xl flex items-center justify-center rounded-lg border-2 transition-colors ${i.icon===a?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:a},a))})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),(0,v.jsx)("div",{className:"flex flex-wrap gap-2",children:["#10B981","#3B82F6","#8B5CF6","#F59E0B","#EF4444","#EC4899","#06B6D4","#84CC16"].map(a=>(0,v.jsx)("button",{type:"button",onClick:()=>j(b=>({...b,color:a})),className:`w-10 h-10 rounded-lg border-2 transition-all ${i.color===a?"border-gray-900 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:a}},a))})]}),(0,v.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Set as Default"}),(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"This pipeline will be selected by default"})]}),(0,v.jsx)("button",{type:"button",onClick:()=>j(a=>({...a,isDefault:!a.isDefault})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${i.isDefault?"bg-green-600":"bg-gray-200"}`,children:(0,v.jsx)("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${i.isDefault?"translate-x-5":"translate-x-0"}`})})]})]}),(0,v.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,v.jsx)("button",{onClick:()=>f(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,v.jsx)("button",{onClick:m,disabled:!i.name.trim(),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:g?"Save Changes":"Create Pipeline"})]})]})})})]})}function bL({pipelines:a,selectedPipeline:b,loading:c,onRefresh:d}){let[e,f]=(0,w.useState)([]),[g,h]=(0,w.useState)(""),[i,j]=(0,w.useState)(""),[k,l]=(0,w.useState)(""),[m,n]=(0,w.useState)(!1),[o,p]=(0,w.useState)(""),[q,r]=(0,w.useState)(""),[s,t]=(0,w.useState)(!1),u=(0,w.useMemo)(()=>{let b=[];if((g?a.filter(a=>a.id===g):a).forEach(a=>{a.stages.forEach(c=>{i&&c.id!==i||c.deals.forEach(d=>{b.push({...d,pipelineName:a.name,stageName:c.name,stageColor:c.color})})})}),k){let a=k.toLowerCase();return b.filter(b=>b.name.toLowerCase().includes(a)||b.contact?.firstName?.toLowerCase().includes(a)||b.contact?.lastName?.toLowerCase().includes(a)||b.contact?.email?.toLowerCase().includes(a))}return b},[a,g,i,k]),x=(0,w.useMemo)(()=>{if(!g)return[];let b=a.find(a=>a.id===g);return b?.stages||[]},[g,a]),y=async()=>{if(0!==e.length&&o){t(!0);try{for(let a of e){let b={};switch(o){case"move-stage":b={stageId:q};break;case"update-status":b={status:q};break;case"update-priority":b={priority:q};break;case"delete":await fetch(`/api/v1/deals/${a}`,{method:"DELETE"});continue}Object.keys(b).length>0&&await fetch(`/api/v1/deals/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})}n(!1),f([]),p(""),r(""),d(),alert(`Successfully processed ${e.length} deals`)}catch(a){alert("Error processing opportunities: "+a.message)}finally{t(!1)}}},z=a=>{p(a),r(""),n(!0)};return c?(0,v.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"ðŸ“¦ Bulk Actions"}),(0,v.jsx)("p",{className:"mt-1 text-gray-500",children:"Perform actions on multiple opportunities at once"})]}),e.length>0&&(0,v.jsx)("div",{className:"flex items-center gap-2",children:(0,v.jsxs)("span",{className:"text-sm text-gray-600",children:[e.length," deal",e.length>1?"s":""," selected"]})})]}),(0,v.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,v.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,v.jsxs)("button",{onClick:()=>z("move-stage"),disabled:0===e.length,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-arrows-alt"}),"Move to Stage"]}),(0,v.jsxs)("button",{onClick:()=>z("update-status"),disabled:0===e.length,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-flag"}),"Update Status"]}),(0,v.jsxs)("button",{onClick:()=>z("update-priority"),disabled:0===e.length,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-exclamation-circle"}),"Update Priority"]}),(0,v.jsxs)("button",{onClick:()=>z("delete"),disabled:0===e.length,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,v.jsx)("i",{className:"fas fa-trash"}),"Delete Selected"]})]})}),(0,v.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,v.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,v.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,v.jsx)("input",{type:"text",placeholder:"Search opportunities...",value:k,onChange:a=>l(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),(0,v.jsxs)("select",{value:g,onChange:a=>{h(a.target.value),j("")},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,v.jsx)("option",{value:"",children:"All Pipelines"}),a.map(a=>(0,v.jsxs)("option",{value:a.id,children:[a.icon," ",a.name]},a.id))]}),(0,v.jsxs)("select",{value:i,onChange:a=>j(a.target.value),disabled:!g,className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:opacity-50",children:[(0,v.jsx)("option",{value:"",children:"All Stages"}),x.map(a=>(0,v.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,v.jsx)("button",{onClick:d,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",title:"Refresh",children:(0,v.jsx)("i",{className:"fas fa-sync-alt"})})]})}),(0,v.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:0===u.length?(0,v.jsxs)("div",{className:"text-center py-12",children:[(0,v.jsx)("i",{className:"fas fa-inbox text-4xl text-gray-300 mb-4"}),(0,v.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No opportunities found"}),(0,v.jsx)("p",{className:"text-gray-500",children:"Try adjusting your filters"})]}):(0,v.jsx)("div",{className:"overflow-x-auto",children:(0,v.jsxs)("table",{className:"w-full",children:[(0,v.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{className:"px-4 py-3 text-left",children:(0,v.jsx)("input",{type:"checkbox",checked:e.length===u.length&&u.length>0,onChange:()=>{e.length===u.length?f([]):f(u.map(a=>a.id))},className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})}),(0,v.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal"}),(0,v.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),(0,v.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pipeline / Stage"}),(0,v.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value"}),(0,v.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,v.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,v.jsx)("tbody",{className:"divide-y divide-gray-200",children:u.map(a=>(0,v.jsxs)("tr",{className:`hover:bg-gray-50 ${e.includes(a.id)?"bg-green-50":""}`,children:[(0,v.jsx)("td",{className:"px-4 py-3",children:(0,v.jsx)("input",{type:"checkbox",checked:e.includes(a.id),onChange:()=>{var b;return b=a.id,void(e.includes(b)?f(a=>a.filter(a=>a!==b)):f(a=>[...a,b]))},className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})}),(0,v.jsxs)("td",{className:"px-4 py-3",children:[(0,v.jsx)("div",{className:"font-medium text-gray-900",children:a.name}),a.expectedCloseDate&&(0,v.jsxs)("div",{className:"text-xs text-gray-500",children:["Close: ",new Date(a.expectedCloseDate).toLocaleDateString()]})]}),(0,v.jsx)("td",{className:"px-4 py-3",children:a.contact?(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"text-sm text-gray-900",children:[a.contact.firstName," ",a.contact.lastName]}),(0,v.jsx)("div",{className:"text-xs text-gray-500",children:a.contact.email})]}):(0,v.jsx)("span",{className:"text-gray-400",children:"No contact"})}),(0,v.jsxs)("td",{className:"px-4 py-3",children:[(0,v.jsx)("div",{className:"text-sm text-gray-900",children:a.pipelineName}),(0,v.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:`${a.stageColor}20`,color:a.stageColor},children:a.stageName})]}),(0,v.jsxs)("td",{className:"px-4 py-3",children:[(0,v.jsxs)("div",{className:"font-medium text-gray-900",children:["$",(a.value||0).toLocaleString()]}),(0,v.jsx)("div",{className:"text-xs text-gray-500",children:a.currency||"USD"})]}),(0,v.jsx)("td",{className:"px-4 py-3",children:(0,v.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"high"===a.priority?"bg-red-100 text-red-700":"medium"===a.priority?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:a.priority||"normal"})}),(0,v.jsx)("td",{className:"px-4 py-3",children:(0,v.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"active"===a.status?"bg-green-100 text-green-700":"won"===a.status?"bg-blue-100 text-blue-700":"lost"===a.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:a.status||"active"})})]},a.id))})]})})}),(0,v.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center justify-between text-sm",children:[(0,v.jsxs)("span",{className:"text-gray-600",children:["Showing ",u.length," deal",1!==u.length?"s":""]}),(0,v.jsxs)("span",{className:"text-gray-900 font-medium",children:["Total Value: $",u.reduce((a,b)=>a+(b.value||0),0).toLocaleString()]})]}),m&&(0,v.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,v.jsx)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:(0,v.jsxs)("div",{className:"p-6",children:[(0,v.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,v.jsxs)("h3",{className:"text-lg font-bold text-gray-900",children:["move-stage"===o&&"Move to Stage","update-status"===o&&"Update Status","update-priority"===o&&"Update Priority","delete"===o&&"Delete Opportunities"]}),(0,v.jsx)("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:(0,v.jsx)("i",{className:"fas fa-times"})})]}),(0,v.jsxs)("p",{className:"text-gray-600 mb-4",children:["This action will affect ",e.length," deal",e.length>1?"s":"","."]}),"move-stage"===o&&(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Target Stage"}),(0,v.jsxs)("select",{value:q,onChange:a=>r(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,v.jsx)("option",{value:"",children:"Select stage..."}),a.map(a=>(0,v.jsx)("optgroup",{label:`${a.icon} ${a.name}`,children:a.stages.map(a=>(0,v.jsx)("option",{value:a.id,children:a.name},a.id))},a.id))]})]}),"update-status"===o&&(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Status"}),(0,v.jsxs)("select",{value:q,onChange:a=>r(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,v.jsx)("option",{value:"",children:"Select status..."}),(0,v.jsx)("option",{value:"active",children:"Active"}),(0,v.jsx)("option",{value:"won",children:"Won"}),(0,v.jsx)("option",{value:"lost",children:"Lost"}),(0,v.jsx)("option",{value:"on-hold",children:"On Hold"})]})]}),"update-priority"===o&&(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Priority"}),(0,v.jsxs)("select",{value:q,onChange:a=>r(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,v.jsx)("option",{value:"",children:"Select priority..."}),(0,v.jsx)("option",{value:"high",children:"High"}),(0,v.jsx)("option",{value:"medium",children:"Medium"}),(0,v.jsx)("option",{value:"low",children:"Low"})]})]}),"delete"===o&&(0,v.jsxs)("div",{className:"p-4 bg-red-50 rounded-lg border border-red-200",children:[(0,v.jsx)("p",{className:"text-red-700 font-medium",children:"âš ï¸ Warning"}),(0,v.jsx)("p",{className:"text-red-600 text-sm mt-1",children:"This action cannot be undone. All selected opportunities will be permanently deleted."})]}),(0,v.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,v.jsx)("button",{onClick:()=>n(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,v.jsx)("button",{onClick:y,disabled:s||"delete"!==o&&!q,className:`flex-1 px-4 py-2 text-white rounded-lg disabled:opacity-50 ${"delete"===o?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:s?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Processing..."]}):"delete"===o?"Delete Opportunities":"Apply Changes"})]})]})})})]})}function bM(){return(0,v.jsx)(w.Suspense,{fallback:(0,v.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-[#0a0a0a] flex items-center justify-center",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:(0,v.jsx)(bI,{})})}a.s(["default",()=>bM,"dynamic",0,"force-dynamic"],88784)}];

//# sourceMappingURL=app_sub-account_lead-engine_page_tsx_b802435f._.js.map