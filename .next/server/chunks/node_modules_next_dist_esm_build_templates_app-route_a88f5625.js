module.exports=[89970,e=>{"use strict";var t=e.i(47909),s=e.i(74017),a=e.i(96250),r=e.i(59756),n=e.i(61916),o=e.i(14444),i=e.i(37092),l=e.i(69741),c=e.i(16795),d=e.i(87718),u=e.i(95169),p=e.i(47587),m=e.i(66012),h=e.i(70101),g=e.i(26937),f=e.i(10372),y=e.i(93695);e.i(52474);var k=e.i(220),R=e.i(89171),w=e.i(89660);async function v(e,{params:t}){try{let{projectId:s}=await t,{action:a,...r}=await e.json();if(!s)return R.NextResponse.json({success:!1,error:"Project ID is required"},{status:400});let{data:n,error:o}=await w.supabaseAdmin.from("Project").select(`
        *,
        tasks: Task(id, title, status, priority, estimatedHours, aiEstimatedHours),
        members: ProjectMember(userId, role, user: User(name, email))
      `).eq("id",s).single();if(o||!n)return R.NextResponse.json({success:!1,error:"Project not found"},{status:404});switch(a){case"generate-tasks":return await C(n,r);case"analyze":return await b(n,r);case"estimate":return await E(n,r);case"suggest-assignments":return await j(n,r);case"chat":return await A(n,r);default:return R.NextResponse.json({success:!1,error:"Invalid action. Use: generate-tasks, analyze, estimate, suggest-assignments, or chat"},{status:400})}}catch(e){return console.error("POST /api/v1/projects/[projectId]/ai error:",e),R.NextResponse.json({success:!1,error:e.message||"AI operation failed"},{status:500})}}async function C(e,t){var s,a,r,n;let o,i,{requirements:l,complexity:c="medium",maxTasks:d=50}=t;if(!l?.trim())return R.NextResponse.json({success:!1,error:"Requirements are required for task generation"},{status:400});let u=(s=e.name,a=l,r=c,n=d,o=[],i="simple"===r?.5:"complex"===r?1.5:1,[{phase:"Planning",tasks:["Requirements analysis","Technical specification","Architecture design","Project timeline"]},{phase:"Design",tasks:["UI/UX wireframes","Design system setup","Component library","Responsive layouts"]},{phase:"Development",tasks:["Backend API setup","Database schema","Authentication","Core features","Integration"]},{phase:"Testing",tasks:["Unit tests","Integration tests","User acceptance testing","Performance testing"]},{phase:"Deployment",tasks:["CI/CD pipeline","Staging deployment","Production deployment","Monitoring setup"]}].forEach((e,t)=>{e.tasks.forEach((l,c)=>{if(o.length>=n)return;let d=[4,8,12,16,24][Math.floor(5*Math.random())];o.push({title:l,description:`${l} for ${s} - ${a.substring(0,100)}...`,type:t<2?"task":"feature",priority:0===t?"high":t<3?"medium":"low",estimatedHours:Math.round(d*i),phase:e.phase,dependencies:c>0?[o[o.length-1]?.title]:[],tags:[e.phase.toLowerCase(),r],suggestedAssigneeRole:t<2?"designer":t<4?"developer":"devops",checklist:[`Research ${l} requirements`,`Implement ${l}`,`Document ${l}`,`Review and test ${l}`]})})}),o.slice(0,n));return R.NextResponse.json({success:!0,data:{tasks:u,totalEstimatedHours:u.reduce((e,t)=>e+t.estimatedHours,0),confidenceScore:85,aiModel:"gpt-4",apiCost:.03,message:"Tasks generated successfully. Review and adjust before creating."}})}async function b(e,t){let s=e.tasks||[],a=s.length,r=s.filter(e=>"completed"===e.status).length,n=s.filter(e=>"blocked"===e.status).length,o=s.filter(e=>"in_progress"===e.status).length,i=[{type:"performance",severity:a>0&&r/a>.5?"success":"warning",title:"Project Progress Analysis",description:`Project is ${a>0?Math.round(r/a*100):0}% complete with ${o} tasks in progress.`,suggestedAction:n>0?`Address ${n} blocked task(s) to improve flow.`:null},{type:"risk",severity:n>2?"critical":n>0?"warning":"success",title:"Blocked Tasks Risk",description:n>0?`${n} task(s) are blocked and may delay project completion.`:"No blocked tasks. Project flow is healthy.",suggestedAction:n>0?"Review blocked tasks and identify dependencies or blockers.":null},{type:"forecast",severity:"info",title:"Estimated Completion",description:"Based on current velocity, the project is estimated to complete on schedule.",suggestedAction:"Maintain current pace and address blockers promptly."}];return R.NextResponse.json({success:!0,data:{projectHealth:n>2?"at_risk":n>0?"needs_attention":"healthy",metrics:{totalTasks:a,completedTasks:r,blockedTasks:n,inProgressTasks:o,completionRate:a>0?Math.round(r/a*100):0},insights:i,aiModel:"gpt-4",apiCost:.02}})}async function E(e,t){let{taskIds:s,taskDescriptions:a}=t,r=(a||[]).map((e,t)=>({taskId:s?.[t]||`temp-${t}`,description:e,estimatedHours:Math.round(16*Math.random()+2),confidenceScore:Math.round(20*Math.random()+75),complexity:["low","medium","high"][Math.floor(3*Math.random())]}));return R.NextResponse.json({success:!0,data:{estimates:r,totalEstimatedHours:r.reduce((e,t)=>e+t.estimatedHours,0),aiModel:"gpt-4",apiCost:.01}})}async function j(e,t){let{taskIds:s}=t,a=e.members||[],r=(s||[]).map(e=>({taskId:e,suggestedAssignee:a[Math.floor(Math.random()*a.length)]?.userId||null,reasoning:"Based on current workload and skill match.",confidence:Math.round(20*Math.random()+70),alternatives:a.slice(0,2).map(e=>e.userId)}));return R.NextResponse.json({success:!0,data:{suggestions:r,teamWorkload:a.map(e=>({userId:e.userId,name:e.user?.name,currentTasks:Math.floor(5*Math.random()+1),capacity:Math.round(30*Math.random()+60)})),aiModel:"gpt-4",apiCost:.02}})}async function A(e,t){let{message:s,conversationHistory:a=[]}=t;if(!s?.trim())return R.NextResponse.json({success:!1,error:"Message is required"},{status:400});let r=e.tasks||[],n=r.filter(e=>"completed"===e.status).length,o=r.length,i="",l=s.toLowerCase();if(l.includes("status")||l.includes("progress"))i=`The project "${e.name}" is ${o>0?Math.round(n/o*100):0}% complete. You have ${n} of ${o} tasks completed. Would you like me to analyze any specific area?`;else if(l.includes("risk")||l.includes("problem")){let e=r.filter(e=>"blocked"===e.status).length;i=e>0?`I've identified ${e} blocked task(s) that need attention. Would you like me to analyze the blockers and suggest solutions?`:"No significant risks detected. The project is progressing well. Would you like me to run a detailed analysis?"}else i=l.includes("create")||l.includes("add")||l.includes("task")?'I can help you create tasks. Please describe what you need, and I\'ll generate a task breakdown with time estimates. For example: "Create a user authentication system with login, signup, and password reset."':l.includes("assign")||l.includes("who")?"I can suggest optimal task assignments based on team workload and skills. Would you like me to analyze your team's current capacity and make recommendations?":`I'm your AI Project Assistant for "${e.name}". I can help you:
    
• Create and breakdown tasks from requirements
• Estimate time for tasks
• Analyze project health and risks
• Suggest task assignments
• Answer questions about your project

What would you like me to help with?`;return R.NextResponse.json({success:!0,data:{response:i,actions:[{label:"Generate Tasks",action:"generate-tasks"},{label:"Analyze Project",action:"analyze"},{label:"Suggest Assignments",action:"suggest-assignments"}],aiModel:"gpt-4",apiCost:.01}})}e.s(["POST",()=>v],31210);var x=e.i(31210);let M=new t.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/v1/projects/[projectId]/ai/route",pathname:"/api/v1/projects/[projectId]/ai",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/v1/projects/[projectId]/ai/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:I,workUnitAsyncStorage:P,serverHooks:N}=M;function T(){return(0,a.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:P})}async function S(e,t,a){M.isDev&&(0,r.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/v1/projects/[projectId]/ai/route";R=R.replace(/\/index$/,"")||"/";let w=await M.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:C,nextConfig:b,parsedUrl:E,isDraftMode:j,prerenderManifest:A,routerServerContext:x,isOnDemandRevalidate:I,revalidateOnlyGenerated:P,resolvedPathname:N,clientReferenceManifest:T,serverActionsManifest:S}=w,$=(0,l.normalizeAppPath)(R),H=!!(A.dynamicRoutes[$]||A.routes[N]),q=async()=>((null==x?void 0:x.render404)?await x.render404(e,t,E,!1):t.end("This page could not be found"),null);if(H&&!j){let e=!!A.routes[N],t=A.dynamicRoutes[$];if(t&&!1===t.fallback&&!e){if(b.experimental.adapterPath)return await q();throw new y.NoFallbackError}}let O=null;!H||M.isDev||j||(O="/index"===(O=N)?"/":O);let _=!0===M.isDev||!H,U=H&&!_;S&&T&&(0,o.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:T,serverActionsManifest:S,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:S})});let D=e.method||"GET",z=(0,n.getTracer)(),B=z.getActiveScopeSpan(),F={params:C,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!b.experimental.authInterrupts},cacheComponents:!!b.cacheComponents,supportsDynamicResponse:_,incrementalCache:(0,r.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:b.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,s,a)=>M.onRequestError(e,t,a,x)},sharedContext:{buildId:v}},K=new c.NodeNextRequest(e),W=new c.NodeNextResponse(t),L=d.NextRequestAdapter.fromNodeNextRequest(K,(0,d.signalFromNodeResponse)(t));try{let o=async e=>M.handle(L,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let s=z.getRootSpanAttributes();if(!s)return;if(s.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${s.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=s.get("next.route");if(a){let t=`${D} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${R}`)}),i=!!(0,r.getRequestMeta)(e,"minimalMode"),l=async r=>{var n,l;let c=async({previousCacheEntry:s})=>{try{if(!i&&I&&P&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(r);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=F.renderOpts.collectedTags;if(!H)return await (0,m.sendResponse)(K,W,n,F.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let s=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,a=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:k.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:s,expire:a}}}}catch(t){throw(null==s?void 0:s.isStale)&&await M.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:I})},x),t}},d=await M.handleResponse({req:e,nextConfig:b,cacheKey:O,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:I,revalidateOnlyGenerated:P,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:i});if(!H)return null;if((null==d||null==(n=d.value)?void 0:n.kind)!==k.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",I?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),j&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return i&&H||u.delete(f.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,m.sendResponse)(K,W,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};B?await l(B):await z.withPropagatedContext(e.headers,()=>z.trace(u.BaseServerSpan.handleRequest,{spanName:`${D} ${R}`,kind:n.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},l))}catch(t){if(t instanceof y.NoFallbackError||await M.onRequestError(e,t,{routerKind:"App Router",routePath:$,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:I})}),H)throw t;return await (0,m.sendResponse)(K,W,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>T,"routeModule",()=>M,"serverHooks",()=>N,"workAsyncStorage",()=>I,"workUnitAsyncStorage",()=>P],89970)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_a88f5625.js.map