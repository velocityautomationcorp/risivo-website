module.exports=[22360,e=>{"use strict";var t=e.i(47909),s=e.i(74017),r=e.i(96250),a=e.i(59756),n=e.i(61916),i=e.i(14444),o=e.i(37092),c=e.i(69741),l=e.i(16795),u=e.i(87718),d=e.i(95169),p=e.i(47587),f=e.i(66012),h=e.i(70101),g=e.i(26937),m=e.i(10372),A=e.i(93695);e.i(52474);var E=e.i(220),y=e.i(89171),I=e.i(22734),v=e.i(14747),R=e.i(54799);let w=process.env.CREDENTIALS_ENCRYPTION_KEY||"risivo-crm-default-key-32-chars!",S="aes-256-gcm";function _(e){try{let[t,s,r]=e.split(":"),a=Buffer.from(t,"hex"),n=Buffer.from(s,"hex"),i=R.default.createDecipheriv(S,Buffer.from(w.padEnd(32).slice(0,32)),a);i.setAuthTag(n);let o=i.update(r,"hex","utf8");return o+=i.final("utf8")}catch(e){return console.error("Decryption error:",e),""}}let O=v.default.join(process.cwd(),".credentials.json");async function C(){try{let e=await I.promises.readFile(O,"utf8");return JSON.parse(e)}catch{return{}}}async function P(e){await I.promises.writeFile(O,JSON.stringify(e,null,2))}async function N(e){let t=function(e){let t=["# ===========================================","# RISIVO CRM - API Credentials",`# Auto-generated on ${new Date().toISOString()}`,"# DO NOT EDIT MANUALLY - Use Platform Admin","# ===========================================",""],s={openai:"# AI Core",anthropic:"# AI Core (Alternative)","google-gemini":"# AI Core (Alternative)",twilio:"# Voice & SMS",elevenlabs:"# Voice Synthesis",vapi:"# Voice AI Platform",synthflow:"# Voice AI Platform",deepgram:"# Speech-to-Text",heygen:"# Video Generation",synthesia:"# Video Generation (Alternative)","d-id":"# Video Generation (Alternative)",stability:"# Image Generation",removebg:"# Image Processing",dataforseo:"# SEO Analytics","google-search-console":"# SEO Analytics",semrush:"# SEO Analytics",cloudinary:"# Media Storage","aws-s3":"# Media Storage",sendgrid:"# Email Service",stripe:"# Payments"},r="";for(let[a,n]of Object.entries(e)){let e=s[a];for(let[s,a]of(e&&e!==r&&(t.push(""),t.push(e),r=e),Object.entries(n)))if(a)try{let e=_(a);e&&t.push(`${s}=${e}`)}catch{console.error(`Failed to decrypt ${s}`)}}return t.join("\n")}(e),s=v.default.join(process.cwd(),".env.local");await I.promises.writeFile(s,t)}async function T(e){let t=(await C())[e]||{},s={};for(let[e,r]of Object.entries(t))r&&(s[e]=_(r));return s}async function b(e){try{let{searchParams:t}=new URL(e.url),s=t.get("providerId"),r=await C();if(s){let e=await T(s);return y.NextResponse.json({success:!0,credentials:e,message:"Credentials retrieved for testing"})}let a={},n=[];for(let[e,t]of Object.entries(r)){a[e]={};let s=!1;for(let[r,n]of Object.entries(t))if(n){let t=_(n);t&&(a[e][r]="••••••••"+t.slice(-4),s=!0)}s&&n.push(e)}return y.NextResponse.json({success:!0,credentials:a,configuredProviders:n,message:"Credentials retrieved successfully"})}catch(e){return console.error("Error retrieving credentials:",e),y.NextResponse.json({success:!1,error:"Failed to retrieve credentials"},{status:500})}}async function k(e){try{let{providerId:t,credentials:s}=await e.json();if(!t||!s)return y.NextResponse.json({success:!1,error:"Missing providerId or credentials"},{status:400});let r=await C();for(let[e,a]of(r[t]={},Object.entries(s)))a&&a.trim()&&(r[t][e]=function(e){let t=R.default.randomBytes(16),s=R.default.createCipheriv(S,Buffer.from(w.padEnd(32).slice(0,32)),t),r=s.update(e,"utf8","hex");r+=s.final("hex");let a=s.getAuthTag();return`${t.toString("hex")}:${a.toString("hex")}:${r}`}(a.trim()));return await P(r),await N(r),y.NextResponse.json({success:!0,message:`Credentials for ${t} saved successfully`,envUpdated:!0})}catch(e){return console.error("Error saving credentials:",e),y.NextResponse.json({success:!1,error:"Failed to save credentials"},{status:500})}}async function x(e){try{let{searchParams:t}=new URL(e.url),s=t.get("providerId");if(!s)return y.NextResponse.json({success:!1,error:"Missing providerId"},{status:400});let r=await C();return delete r[s],await P(r),await N(r),y.NextResponse.json({success:!0,message:`Credentials for ${s} removed successfully`,envUpdated:!0})}catch(e){return y.NextResponse.json({success:!1,error:"Failed to remove credentials"},{status:500})}}async function D(e){try{let{providerId:t,credentials:s}=await e.json();if(!t)return y.NextResponse.json({success:!1,error:"Missing providerId"},{status:400});let r=s;s&&0!==Object.keys(s).length||(r=await T(t));let a={success:!1,message:"Unknown provider"};switch(t){case"openai":a=await $(r);break;case"twilio":a=await j(r);break;case"elevenlabs":a=await U(r);break;case"heygen":a=await L(r);break;case"stripe":a=await F(r);break;case"sendgrid":a=await G(r);break;case"anthropic":a=await M(r);break;case"google-gemini":a=await K(r);break;case"cloudinary":a=await Y(r);break;case"dataforseo":a=await H(r);break;default:a={success:!0,message:"Connection test not available for this provider. Credentials saved.",details:"Manual verification recommended"}}return y.NextResponse.json(a)}catch(e){return console.error("Connection test error:",e),y.NextResponse.json({success:!1,error:"Connection test failed"},{status:500})}}async function $(e){try{if(!e.OPENAI_API_KEY)return{success:!1,message:"OpenAI API key is required"};let t=await fetch("https://api.openai.com/v1/models",{headers:{Authorization:`Bearer ${e.OPENAI_API_KEY}`}});if(t.ok){let e=await t.json(),s=e.data?.length||0;return{success:!0,message:"OpenAI API connection successful",details:`Access to ${s} models`}}let s=await t.json();return{success:!1,message:"Invalid OpenAI API key",details:s.error?.message||"Authentication failed"}}catch(e){return{success:!1,message:"Failed to connect to OpenAI",details:String(e)}}}async function j(e){try{if(!e.TWILIO_ACCOUNT_SID||!e.TWILIO_AUTH_TOKEN)return{success:!1,message:"Twilio Account SID and Auth Token are required"};let t=Buffer.from(`${e.TWILIO_ACCOUNT_SID}:${e.TWILIO_AUTH_TOKEN}`).toString("base64"),s=await fetch(`https://api.twilio.com/2010-04-01/Accounts/${e.TWILIO_ACCOUNT_SID}.json`,{headers:{Authorization:`Basic ${t}`}});if(s.ok){let e=await s.json();return{success:!0,message:"Twilio connection successful",details:`Account: ${e.friendly_name}, Status: ${e.status}`}}return{success:!1,message:"Invalid Twilio credentials"}}catch(e){return{success:!1,message:"Failed to connect to Twilio",details:String(e)}}}async function U(e){try{if(!e.ELEVENLABS_API_KEY)return{success:!1,message:"ElevenLabs API key is required"};let t=await fetch("https://api.elevenlabs.io/v1/user",{headers:{"xi-api-key":e.ELEVENLABS_API_KEY}});if(t.ok){let e=await t.json();return{success:!0,message:"ElevenLabs connection successful",details:`Subscription: ${e.subscription?.tier||"Free"}`}}return{success:!1,message:"Invalid ElevenLabs API key"}}catch(e){return{success:!1,message:"Failed to connect to ElevenLabs",details:String(e)}}}async function L(e){try{if(!e.HEYGEN_API_KEY)return{success:!1,message:"HeyGen API key is required"};let t=await fetch("https://api.heygen.com/v1/user/remaining_quota",{headers:{"X-Api-Key":e.HEYGEN_API_KEY}});if(t.ok){let e=await t.json();return{success:!0,message:"HeyGen connection successful",details:`Remaining credits: ${e.remaining_quota||"N/A"}`}}return{success:!1,message:"Invalid HeyGen API key"}}catch(e){return{success:!1,message:"Failed to connect to HeyGen",details:String(e)}}}async function F(e){try{if(!e.STRIPE_SECRET_KEY)return{success:!1,message:"Stripe secret key is required"};let t=await fetch("https://api.stripe.com/v1/balance",{headers:{Authorization:`Bearer ${e.STRIPE_SECRET_KEY}`}});if(t.ok){let s=await t.json(),r=e.STRIPE_SECRET_KEY.startsWith("sk_test_")?"Test":"Live";return{success:!0,message:"Stripe connection successful",details:`Mode: ${r}, Available balance: ${s.available?.[0]?.amount?(s.available[0].amount/100).toFixed(2):"0.00"} ${s.available?.[0]?.currency?.toUpperCase()||"USD"}`}}return{success:!1,message:"Invalid Stripe secret key"}}catch(e){return{success:!1,message:"Failed to connect to Stripe",details:String(e)}}}async function G(e){try{if(!e.SENDGRID_API_KEY)return{success:!1,message:"SendGrid API key is required"};let t=await fetch("https://api.sendgrid.com/v3/user/profile",{headers:{Authorization:`Bearer ${e.SENDGRID_API_KEY}`}});if(t.ok){let e=await t.json();return{success:!0,message:"SendGrid connection successful",details:`Account: ${e.username||e.email||"Connected"}`}}return{success:!1,message:"Invalid SendGrid API key"}}catch(e){return{success:!1,message:"Failed to connect to SendGrid",details:String(e)}}}async function M(e){try{if(!e.ANTHROPIC_API_KEY)return{success:!1,message:"Anthropic API key is required"};let t=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"x-api-key":e.ANTHROPIC_API_KEY,"anthropic-version":"2023-06-01","Content-Type":"application/json"},body:JSON.stringify({model:"claude-3-haiku-20240307",max_tokens:10,messages:[{role:"user",content:"Hi"}]})});if(t.ok)return{success:!0,message:"Anthropic connection successful",details:"API key validated with Claude API"};let s=await t.json();return{success:!1,message:"Invalid Anthropic API key",details:s.error?.message||"Authentication failed"}}catch(e){return{success:!1,message:"Failed to connect to Anthropic",details:String(e)}}}async function K(e){try{if(!e.GOOGLE_GEMINI_API_KEY)return{success:!1,message:"Google Gemini API key is required"};let t=await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${e.GOOGLE_GEMINI_API_KEY}`);if(t.ok){let e=await t.json(),s=e.models?.length||0;return{success:!0,message:"Google Gemini connection successful",details:`Access to ${s} models`}}return{success:!1,message:"Invalid Google Gemini API key"}}catch(e){return{success:!1,message:"Failed to connect to Google Gemini",details:String(e)}}}async function Y(e){try{if(!e.CLOUDINARY_CLOUD_NAME||!e.CLOUDINARY_API_KEY||!e.CLOUDINARY_API_SECRET)return{success:!1,message:"Cloudinary cloud name, API key, and API secret are required"};let t=Buffer.from(`${e.CLOUDINARY_API_KEY}:${e.CLOUDINARY_API_SECRET}`).toString("base64");if((await fetch(`https://api.cloudinary.com/v1_1/${e.CLOUDINARY_CLOUD_NAME}/resources/image`,{headers:{Authorization:`Basic ${t}`}})).ok)return{success:!0,message:"Cloudinary connection successful",details:`Cloud: ${e.CLOUDINARY_CLOUD_NAME}`};return{success:!1,message:"Invalid Cloudinary credentials"}}catch(e){return{success:!1,message:"Failed to connect to Cloudinary",details:String(e)}}}async function H(e){try{if(!e.DATAFORSEO_LOGIN||!e.DATAFORSEO_PASSWORD)return{success:!1,message:"DataForSEO login and password are required"};let t=Buffer.from(`${e.DATAFORSEO_LOGIN}:${e.DATAFORSEO_PASSWORD}`).toString("base64"),s=await fetch("https://api.dataforseo.com/v3/appendix/user_data",{headers:{Authorization:`Basic ${t}`}});if(s.ok){let e=await s.json(),t=e.tasks?.[0]?.result?.[0]?.money?.balance||0;return{success:!0,message:"DataForSEO connection successful",details:`Balance: $${t.toFixed(2)}`}}return{success:!1,message:"Invalid DataForSEO credentials"}}catch(e){return{success:!1,message:"Failed to connect to DataForSEO",details:String(e)}}}e.s(["DELETE",()=>x,"GET",()=>b,"POST",()=>k,"PUT",()=>D],1212);var q=e.i(1212);let B=new t.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/platform-admin/credentials/route",pathname:"/api/platform-admin/credentials",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/platform-admin/credentials/route.ts",nextConfigOutput:"",userland:q}),{workAsyncStorage:V,workUnitAsyncStorage:W,serverHooks:z}=B;function X(){return(0,r.patchFetch)({workAsyncStorage:V,workUnitAsyncStorage:W})}async function J(e,t,r){B.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/platform-admin/credentials/route";y=y.replace(/\/index$/,"")||"/";let I=await B.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!I)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:R,nextConfig:w,parsedUrl:S,isDraftMode:_,prerenderManifest:O,routerServerContext:C,isOnDemandRevalidate:P,revalidateOnlyGenerated:N,resolvedPathname:T,clientReferenceManifest:b,serverActionsManifest:k}=I,x=(0,c.normalizeAppPath)(y),D=!!(O.dynamicRoutes[x]||O.routes[T]),$=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,S,!1):t.end("This page could not be found"),null);if(D&&!_){let e=!!O.routes[T],t=O.dynamicRoutes[x];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await $();throw new A.NoFallbackError}}let j=null;!D||B.isDev||_||(j="/index"===(j=T)?"/":j);let U=!0===B.isDev||!D,L=D&&!U;k&&b&&(0,i.setReferenceManifestsSingleton)({page:y,clientReferenceManifest:b,serverActionsManifest:k,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:k})});let F=e.method||"GET",G=(0,n.getTracer)(),M=G.getActiveScopeSpan(),K={params:R,prerenderManifest:O,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,s,r)=>B.onRequestError(e,t,r,C)},sharedContext:{buildId:v}},Y=new l.NodeNextRequest(e),H=new l.NodeNextResponse(t),q=u.NextRequestAdapter.fromNodeNextRequest(Y,(0,u.signalFromNodeResponse)(t));try{let i=async e=>B.handle(q,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let s=G.getRootSpanAttributes();if(!s)return;if(s.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${s.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=s.get("next.route");if(r){let t=`${F} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${F} ${y}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),c=async a=>{var n,c;let l=async({previousCacheEntry:s})=>{try{if(!o&&P&&N&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(a);e.fetchMetrics=K.renderOpts.fetchMetrics;let c=K.renderOpts.pendingWaitUntil;c&&r.waitUntil&&(r.waitUntil(c),c=void 0);let l=K.renderOpts.collectedTags;if(!D)return await (0,f.sendResponse)(Y,H,n,K.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);l&&(t[m.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let s=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,r=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:s,expire:r}}}}catch(t){throw(null==s?void 0:s.isStale)&&await B.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:P})},C),t}},u=await B.handleResponse({req:e,nextConfig:w,cacheKey:j,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:O,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:N,responseGenerator:l,waitUntil:r.waitUntil,isMinimalMode:o});if(!D)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",P?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&D||d.delete(m.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(u.cacheControl)),await (0,f.sendResponse)(Y,H,new Response(u.value.body,{headers:d,status:u.value.status||200})),null};M?await c(M):await G.withPropagatedContext(e.headers,()=>G.trace(d.BaseServerSpan.handleRequest,{spanName:`${F} ${y}`,kind:n.SpanKind.SERVER,attributes:{"http.method":F,"http.target":e.url}},c))}catch(t){if(t instanceof A.NoFallbackError||await B.onRequestError(e,t,{routerKind:"App Router",routePath:x,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:P})}),D)throw t;return await (0,f.sendResponse)(Y,H,new Response(null,{status:500})),null}}e.s(["handler",()=>J,"patchFetch",()=>X,"routeModule",()=>B,"serverHooks",()=>z,"workAsyncStorage",()=>V,"workUnitAsyncStorage",()=>W],22360)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_85863e96.js.map