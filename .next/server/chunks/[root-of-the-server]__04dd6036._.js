module.exports=[93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},85695,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),s=e.i(59756),n=e.i(61916),o=e.i(14444),i=e.i(37092),c=e.i(69741),l=e.i(16795),u=e.i(87718),d=e.i(95169),p=e.i(47587),h=e.i(66012),f=e.i(70101),y=e.i(26937),x=e.i(10372),P=e.i(93695);e.i(52474);var m=e.i(220),v=e.i(89171);let R="live"===process.env.PAYPAL_MODE?"https://api-m.paypal.com":"https://api-m.sandbox.paypal.com";async function _(){let e=process.env.PAYPAL_CLIENT_ID,t=process.env.PAYPAL_CLIENT_SECRET;if(!e||!t)throw Error("PayPal credentials are not configured");let r=Buffer.from(`${e}:${t}`).toString("base64"),a=await fetch(`${R}/v1/oauth2/token`,{method:"POST",headers:{Authorization:`Basic ${r}`,"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=client_credentials"}),s=await a.json();if(!a.ok)throw Error(s.error_description||"Failed to get PayPal access token");return s.access_token}async function g(e){try{let{action:t,...r}=await e.json(),a=await _();switch(t){case"create-order":{let{amount:e,currency:t,description:s,invoiceId:n,customId:o}=r;if(!e||!t)return v.NextResponse.json({success:!1,error:"Amount and currency are required"},{status:400});let i={intent:"CAPTURE",purchase_units:[{amount:{currency_code:t.toUpperCase(),value:e.toFixed(2)},description:s||void 0,invoice_id:n||void 0,custom_id:o||void 0}],application_context:{brand_name:"RISIVO",landing_page:"BILLING",user_action:"PAY_NOW",return_url:`${process.env.NEXT_PUBLIC_APP_URL}/payment/success`,cancel_url:`${process.env.NEXT_PUBLIC_APP_URL}/payment/cancel`}},c=await fetch(`${R}/v2/checkout/orders`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(i)}),l=await c.json();if(!c.ok)throw Error(l.message||"Failed to create PayPal order");let u=l.links?.find(e=>"approve"===e.rel)?.href;return v.NextResponse.json({success:!0,data:{orderId:l.id,approvalUrl:u,status:l.status}})}case"capture-order":{let{orderId:e}=r;if(!e)return v.NextResponse.json({success:!1,error:"Order ID is required"},{status:400});let t=await fetch(`${R}/v2/checkout/orders/${e}/capture`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),s=await t.json();if(!t.ok)throw Error(s.message||"Failed to capture PayPal order");let n=s.purchase_units?.[0]?.payments?.captures?.[0]?.id;return v.NextResponse.json({success:!0,data:{orderId:s.id,captureId:n,status:s.status,payer:s.payer}})}case"create-refund":{let{captureId:e,amount:t,reason:s}=r;if(!e)return v.NextResponse.json({success:!1,error:"Capture ID is required"},{status:400});let n={};t&&(n.amount={currency_code:"USD",value:t.toFixed(2)}),s&&(n.note_to_payer=s);let o=await fetch(`${R}/v2/payments/captures/${e}/refund`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await o.json();if(!o.ok)throw Error(i.message||"Failed to create PayPal refund");return v.NextResponse.json({success:!0,data:{id:i.id,status:i.status,amount:i.amount}})}case"create-plan":{let{productId:e,name:t,description:s,billingCycles:n}=r;if(!e||!t||!n)return v.NextResponse.json({success:!1,error:"Product ID, name, and billing cycles are required"},{status:400});let o=await fetch(`${R}/v1/billing/plans`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({product_id:e,name:t,description:s,billing_cycles:n,payment_preferences:{auto_bill_outstanding:!0,setup_fee_failure_action:"CONTINUE",payment_failure_threshold:3}})}),i=await o.json();if(!o.ok)throw Error(i.message||"Failed to create PayPal plan");return v.NextResponse.json({success:!0,data:{id:i.id,status:i.status}})}case"create-subscription":{let{planId:e,customerId:t,startTime:s,metadata:n}=r;if(!e)return v.NextResponse.json({success:!1,error:"Plan ID is required"},{status:400});let o={plan_id:e,application_context:{brand_name:"RISIVO",user_action:"SUBSCRIBE_NOW",return_url:`${process.env.NEXT_PUBLIC_APP_URL}/subscription/success`,cancel_url:`${process.env.NEXT_PUBLIC_APP_URL}/subscription/cancel`}};s&&(o.start_time=s),t&&(o.custom_id=t);let i=await fetch(`${R}/v1/billing/subscriptions`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(o)}),c=await i.json();if(!i.ok)throw Error(c.message||"Failed to create PayPal subscription");let l=c.links?.find(e=>"approve"===e.rel)?.href;return v.NextResponse.json({success:!0,data:{subscriptionId:c.id,approvalUrl:l,status:c.status}})}case"cancel-subscription":{let{subscriptionId:e,reason:t}=r;if(!e)return v.NextResponse.json({success:!1,error:"Subscription ID is required"},{status:400});let s=await fetch(`${R}/v1/billing/subscriptions/${e}/cancel`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({reason:t||"Customer requested cancellation"})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to cancel PayPal subscription")}return v.NextResponse.json({success:!0,data:{subscriptionId:e,status:"CANCELLED"}})}case"get-order":{let{orderId:e}=r;if(!e)return v.NextResponse.json({success:!1,error:"Order ID is required"},{status:400});let t=await fetch(`${R}/v2/checkout/orders/${e}`,{headers:{Authorization:`Bearer ${a}`}}),s=await t.json();if(!t.ok)throw Error(s.message||"Failed to get PayPal order");return v.NextResponse.json({success:!0,data:s})}default:return v.NextResponse.json({success:!1,error:`Unknown action: ${t}`},{status:400})}}catch(e){return console.error("PayPal API error:",e),v.NextResponse.json({success:!1,error:e.message||"PayPal operation failed"},{status:500})}}async function w(e){try{let e=process.env.NEXT_PUBLIC_PAYPAL_CLIENT_ID||process.env.PAYPAL_CLIENT_ID,t=process.env.PAYPAL_MODE||"sandbox";if(!e)return v.NextResponse.json({success:!1,error:"PayPal is not configured"},{status:500});return v.NextResponse.json({success:!0,data:{clientId:e,mode:t,configured:!0}})}catch(e){return console.error("PayPal config error:",e),v.NextResponse.json({success:!1,error:e.message||"Failed to get PayPal config"},{status:500})}}e.s(["GET",()=>w,"POST",()=>g],58885);var E=e.i(58885);let N=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/v1/payments/paypal/route",pathname:"/api/v1/payments/paypal",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/v1/payments/paypal/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:C,workUnitAsyncStorage:A,serverHooks:b}=N;function T(){return(0,a.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:A})}async function j(e,t,a){N.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/v1/payments/paypal/route";v=v.replace(/\/index$/,"")||"/";let R=await N.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:_,params:g,nextConfig:w,parsedUrl:E,isDraftMode:C,prerenderManifest:A,routerServerContext:b,isOnDemandRevalidate:T,revalidateOnlyGenerated:j,resolvedPathname:I,clientReferenceManifest:O,serverActionsManifest:S}=R,k=(0,c.normalizeAppPath)(v),$=!!(A.dynamicRoutes[k]||A.routes[I]),U=async()=>((null==b?void 0:b.render404)?await b.render404(e,t,E,!1):t.end("This page could not be found"),null);if($&&!C){let e=!!A.routes[I],t=A.dynamicRoutes[k];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await U();throw new P.NoFallbackError}}let q=null;!$||N.isDev||C||(q="/index"===(q=I)?"/":q);let L=!0===N.isDev||!$,D=$&&!L;S&&O&&(0,o.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:O,serverActionsManifest:S,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:S})});let B=e.method||"GET",F=(0,n.getTracer)(),M=F.getActiveScopeSpan(),H={params:g,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>N.onRequestError(e,t,a,b)},sharedContext:{buildId:_}},z=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),X=u.NextRequestAdapter.fromNodeNextRequest(z,(0,u.signalFromNodeResponse)(t));try{let o=async e=>N.handle(X,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${B} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${B} ${v}`)}),i=!!(0,s.getRequestMeta)(e,"minimalMode"),c=async s=>{var n,c;let l=async({previousCacheEntry:r})=>{try{if(!i&&T&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(s);e.fetchMetrics=H.renderOpts.fetchMetrics;let c=H.renderOpts.pendingWaitUntil;c&&a.waitUntil&&(a.waitUntil(c),c=void 0);let l=H.renderOpts.collectedTags;if(!$)return await (0,h.sendResponse)(z,K,n,H.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(n.headers);l&&(t[x.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,a=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await N.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:T})},b),t}},u=await N.handleResponse({req:e,nextConfig:w,cacheKey:q,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:j,responseGenerator:l,waitUntil:a.waitUntil,isMinimalMode:i});if(!$)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",T?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,f.fromNodeOutgoingHttpHeaders)(u.value.headers);return i&&$||d.delete(x.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,y.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(z,K,new Response(u.value.body,{headers:d,status:u.value.status||200})),null};M?await c(M):await F.withPropagatedContext(e.headers,()=>F.trace(d.BaseServerSpan.handleRequest,{spanName:`${B} ${v}`,kind:n.SpanKind.SERVER,attributes:{"http.method":B,"http.target":e.url}},c))}catch(t){if(t instanceof P.NoFallbackError||await N.onRequestError(e,t,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:T})}),$)throw t;return await (0,h.sendResponse)(z,K,new Response(null,{status:500})),null}}e.s(["handler",()=>j,"patchFetch",()=>T,"routeModule",()=>N,"serverHooks",()=>b,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>A],85695)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__04dd6036._.js.map