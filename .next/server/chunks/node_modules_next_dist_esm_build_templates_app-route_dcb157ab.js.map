{"version":3,"sources":["../../../app/api/v1/ai/assistant/route.ts","../../../node_modules/next/dist/esm/build/templates/app-route.js","../../../lib/ai/contact-assistant.ts"],"sourcesContent":["// ============================================\n// AI Assistant API Route\n// Handles natural language commands for CRM\n// ============================================\n\nimport { NextRequest, NextResponse } from 'next/server'\nimport { GoogleGenerativeAI } from '@google/generative-ai'\nimport { createContactAssistant } from '@/lib/ai/contact-assistant'\nimport { supabaseAdmin } from '@/lib/supabase/server'\n\nconst genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY || '')\n\n// Define intent categories for the AI\nconst INTENT_PROMPT = `You are Sarah, an intelligent AI assistant for RISIVO CRM. Your job is to help users manage their CRM effectively.\n\nAnalyze the user's message and determine the intent and extract relevant entities.\n\nCONTACT INTENTS:\n- create_contact: User wants to add a new contact\n- search_contacts: User wants to find contacts\n- list_contacts: User wants to see all contacts or a summary\n- update_contact: User wants to modify a contact\n- delete_contact: User wants to remove a contact\n- analyze_contacts: User wants statistics or insights about contacts\n\nPIPELINE INTENTS:\n- create_pipeline: User wants to create a sales pipeline\n- list_pipelines: User wants to see pipelines\n- pipeline_stats: User wants pipeline analytics\n\nOTHER INTENTS:\n- help: User needs guidance\n- greeting: User is greeting\n- unknown: Cannot determine intent\n\nRespond in JSON format:\n{\n  \"intent\": \"intent_name\",\n  \"confidence\": 0.0-1.0,\n  \"entities\": {\n    \"firstName\": \"extracted name\",\n    \"lastName\": \"if found\",\n    \"email\": \"if found\",\n    \"phone\": \"if found\",\n    \"company\": \"if found\",\n    \"query\": \"search term if applicable\"\n  },\n  \"suggestedResponse\": \"A helpful response to guide the user\"\n}\n\nUser message: `\n\n/**\n * POST /api/v1/ai/assistant\n * Process natural language commands for CRM\n */\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { message, subAccountId, userId, context } = body\n\n    if (!message || typeof message !== 'string') {\n      return NextResponse.json(\n        { success: false, error: 'Message is required' },\n        { status: 400 }\n      )\n    }\n\n    if (!subAccountId || !userId) {\n      return NextResponse.json(\n        { success: false, error: 'subAccountId and userId are required' },\n        { status: 400 }\n      )\n    }\n\n    // Use AI to understand intent\n    const model = genAI.getGenerativeModel({ model: 'gemini-2.0-flash-exp' })\n    const intentResult = await model.generateContent(INTENT_PROMPT + message)\n    const intentText = intentResult.response.text()\n\n    // Parse AI response\n    let intentData\n    try {\n      // Extract JSON from response\n      const jsonMatch = intentText.match(/\\{[\\s\\S]*\\}/)\n      if (jsonMatch) {\n        intentData = JSON.parse(jsonMatch[0])\n      } else {\n        throw new Error('No JSON found in response')\n      }\n    } catch (e) {\n      console.error('Failed to parse intent:', intentText)\n      intentData = {\n        intent: 'unknown',\n        confidence: 0,\n        entities: {},\n        suggestedResponse: \"I'd be happy to help! You can ask me to manage contacts, search your CRM, create pipelines, or get analytics. What would you like to do?\",\n      }\n    }\n\n    // Handle different intents\n    let response\n    const intent = intentData.intent\n\n    // Contact-related intents\n    if (intent.includes('contact')) {\n      const contactAssistant = createContactAssistant(subAccountId)\n      const result = await contactAssistant.processRequest(message)\n      \n      response = {\n        message: result.message,\n        action: {\n          type: result.action,\n          data: result.data,\n          suggestions: result.suggestions,\n          actionButtons: result.actionButtons,\n        },\n      }\n    }\n    // Pipeline intents\n    else if (intent === 'create_pipeline') {\n      response = {\n        message: \"I can help you create a pipeline! What type of business are you in? I'll suggest stages that work best for your industry.\\n\\n**Popular templates:**\\nâ€¢ Sales Pipeline (Lead â†’ Qualified â†’ Demo â†’ Proposal â†’ Closed)\\nâ€¢ Real Estate (Inquiry â†’ Showing â†’ Offer â†’ Contract â†’ Closed)\\nâ€¢ Agency (Prospect â†’ Discovery â†’ Proposal â†’ Negotiation â†’ Won)\",\n        action: {\n          type: 'create_pipeline',\n          suggestions: [\n            \"Create a sales pipeline\",\n            \"Create a real estate pipeline\",\n            \"Create a custom pipeline\",\n          ],\n        },\n      }\n    }\n    else if (intent === 'list_pipelines' || intent === 'pipeline_stats') {\n      // Get pipeline data\n      const { data: pipelines } = await supabaseAdmin\n        .from('Pipeline')\n        .select('*, stages:PipelineStage(*)')\n        .eq('subAccountId', subAccountId)\n\n      if (!pipelines || pipelines.length === 0) {\n        response = {\n          message: \"You don't have any pipelines set up yet. Would you like me to help you create one?\",\n          action: {\n            type: 'list_pipelines',\n            data: { pipelines: [] },\n            suggestions: [\"Create a new pipeline\", \"What is a pipeline?\"],\n          },\n        }\n      } else {\n        const pipelineList = pipelines.map((p, i) => \n          `${i + 1}. **${p.name}** - ${p.stages?.length || 0} stages`\n        ).join('\\n')\n\n        response = {\n          message: `You have **${pipelines.length}** pipeline${pipelines.length !== 1 ? 's' : ''}:\\n\\n${pipelineList}`,\n          action: {\n            type: 'list_pipelines',\n            data: { pipelines },\n            suggestions: [\"View pipeline details\", \"Create new pipeline\", \"Show pipeline analytics\"],\n          },\n        }\n      }\n    }\n    // Help intent\n    else if (intent === 'help') {\n      response = {\n        message: `**Here's what I can help you with:**\n\nðŸ§‘â€ðŸ’¼ **Contacts**\nâ€¢ \"Add a new contact\" - Create contacts with voice or text\nâ€¢ \"Find John Smith\" - Search your contacts\nâ€¢ \"Show all my contacts\" - List and manage contacts\nâ€¢ \"How many customers do I have?\" - Get contact analytics\n\nðŸ“Š **Pipelines**\nâ€¢ \"Create a sales pipeline\" - Set up deal stages\nâ€¢ \"Show my pipelines\" - View your sales funnels\n\nðŸ“ˆ **Analytics**\nâ€¢ \"Analyze my contacts\" - Get insights and reports\n\nðŸ’¬ **Just ask naturally!** I understand context, so feel free to chat like you would with a real assistant.`,\n        action: {\n          type: 'help',\n          suggestions: [\n            \"Add a new contact\",\n            \"Show my contacts\",\n            \"Create a pipeline\",\n            \"Analyze my data\",\n          ],\n        },\n      }\n    }\n    // Greeting\n    else if (intent === 'greeting') {\n      const greetings = [\n        \"Hello! ðŸ‘‹ I'm Sarah, your AI assistant. How can I help you manage your CRM today?\",\n        \"Hi there! Ready to help you with your contacts, pipelines, or anything else you need!\",\n        \"Hey! What can I do for you today? I'm here to make CRM management easier.\",\n      ]\n      response = {\n        message: greetings[Math.floor(Math.random() * greetings.length)],\n        action: {\n          type: 'greeting',\n          suggestions: [\n            \"Show my contacts\",\n            \"Create a contact\",\n            \"What can you do?\",\n          ],\n        },\n      }\n    }\n    // Unknown intent - use AI response\n    else {\n      response = {\n        message: intentData.suggestedResponse || \"I'm not sure what you'd like to do. Try asking me to manage contacts, search your CRM, or create pipelines!\",\n        action: {\n          type: 'unknown',\n          suggestions: [\n            \"Show all contacts\",\n            \"Add a contact\",\n            \"Help\",\n          ],\n        },\n      }\n    }\n\n    // Log the interaction\n    await logInteraction({\n      subAccountId,\n      userId,\n      message,\n      intent: intent,\n      response: response.message,\n    })\n\n    return NextResponse.json({\n      success: true,\n      data: response,\n    })\n\n  } catch (error: any) {\n    console.error('AI Assistant Error:', error)\n    return NextResponse.json(\n      {\n        success: false,\n        error: error.message || 'Failed to process request',\n        data: {\n          message: \"Sorry, I encountered an error. Please try again or rephrase your request.\",\n          action: {\n            type: 'error',\n            suggestions: [\"Try again\", \"Help\"],\n          },\n        },\n      },\n      { status: 500 }\n    )\n  }\n}\n\n/**\n * Log AI interactions for analytics\n */\nasync function logInteraction(params: {\n  subAccountId: string\n  userId: string\n  message: string\n  intent: string\n  response: string\n}) {\n  try {\n    await supabaseAdmin.from('AiUsageLog').insert({\n      subAccountId: params.subAccountId,\n      aiModel: 'gemini-2.0-flash-exp',\n      tokensUsed: Math.ceil((params.message.length + params.response.length) / 4),\n      cost: 0, // Free tier\n      metadata: {\n        type: 'assistant_interaction',\n        intent: params.intent,\n        userId: params.userId,\n      },\n    })\n  } catch (e) {\n    console.error('Failed to log interaction:', e)\n  }\n}\n\n/**\n * GET /api/v1/ai/assistant\n * Get AI assistant capabilities and status\n */\nexport async function GET() {\n  return NextResponse.json({\n    success: true,\n    data: {\n      name: 'Sarah',\n      model: 'Gemini 2.0 Flash',\n      capabilities: [\n        'contact_management',\n        'pipeline_management',\n        'voice_commands',\n        'natural_language_search',\n        'analytics',\n      ],\n      status: 'active',\n      version: '1.0.0',\n    },\n  })\n}\n","import { AppRouteRouteModule } from \"next/dist/esm/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/esm/server/lib/patch-fetch\";\nimport { addRequestMeta, getRequestMeta } from \"next/dist/esm/server/request-meta\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { setReferenceManifestsSingleton } from \"next/dist/esm/server/app-render/encryption-utils\";\nimport { createServerModuleMap } from \"next/dist/esm/server/app-render/action-utils\";\nimport { normalizeAppPath } from \"next/dist/esm/shared/lib/router/utils/app-paths\";\nimport { NodeNextRequest, NodeNextResponse } from \"next/dist/esm/server/base-http/node\";\nimport { NextRequestAdapter, signalFromNodeResponse } from \"next/dist/esm/server/web/spec-extension/adapters/next-request\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { getRevalidateReason } from \"next/dist/esm/server/instrumentation/utils\";\nimport { sendResponse } from \"next/dist/esm/server/send-response\";\nimport { fromNodeOutgoingHttpHeaders, toNodeOutgoingHttpHeaders } from \"next/dist/esm/server/web/utils\";\nimport { getCacheControlHeader } from \"next/dist/esm/server/lib/cache-control\";\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from \"next/dist/esm/lib/constants\";\nimport { NoFallbackError } from \"next/dist/esm/shared/lib/no-fallback-error.external\";\nimport { CachedRouteKind } from \"next/dist/esm/server/response-cache\";\nimport * as userland from \"INNER_APP_ROUTE\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/v1/ai/assistant/route\",\n        pathname: \"/api/v1/ai/assistant\",\n        filename: \"route\",\n        bundlePath: \"\"\n    },\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n    resolvedPagePath: \"[project]/app/api/v1/ai/assistant/route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\nexport async function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/v1/ai/assistant/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    } else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = process.env.__NEXT_MULTI_ZONE_DRAFT_MODE;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, parsedUrl, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname, clientReferenceManifest, serverActionsManifest } = prepareResult;\n    const normalizedSrcPage = normalizeAppPath(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    const render404 = async ()=>{\n        // TODO: should route-module itself handle rendering the 404\n        if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false);\n        } else {\n            res.end('This page could not be found');\n        }\n        return null;\n    };\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                if (nextConfig.experimental.adapterPath) {\n                    return await render404();\n                }\n                throw new NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isStaticGeneration = isIsr && !supportsDynamicResponse;\n    // Before rendering (which initializes component tree modules), we have to\n    // set the reference manifests to our global store so Server Action's\n    // encryption util can access to them at the top level of the page module.\n    if (serverActionsManifest && clientReferenceManifest) {\n        setReferenceManifestsSingleton({\n            page: srcPage,\n            clientReferenceManifest,\n            serverActionsManifest,\n            serverModuleMap: createServerModuleMap({\n                serverActionsManifest\n            })\n        });\n    }\n    const method = req.method || 'GET';\n    const tracer = getTracer();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            cacheComponents: Boolean(nextConfig.cacheComponents),\n            supportsDynamicResponse,\n            incrementalCache: getRequestMeta(req, 'incrementalCache'),\n            cacheLifeProfiles: nextConfig.cacheLife,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new NodeNextRequest(req);\n    const nodeNextRes = new NodeNextResponse(res);\n    const nextReq = NextRequestAdapter.fromNodeNextRequest(nodeNextReq, signalFromNodeResponse(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        };\n        const isMinimalMode = Boolean(process.env.MINIMAL_MODE || getRequestMeta(req, 'minimalMode'));\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!isMinimalMode && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = toNodeOutgoingHttpHeaders(response.headers);\n                        if (cacheTags) {\n                            headers[NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await sendResponse(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: getRevalidateReason({\n                                isStaticGeneration,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil,\n                isMinimalMode\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!isMinimalMode) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers);\n            if (!(isMinimalMode && isIsr)) {\n                headers.delete(NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', getCacheControlHeader(cacheEntry.cacheControl));\n            }\n            await sendResponse(nodeNextReq, nodeNextRes, // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n            new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                    isStaticGeneration,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await sendResponse(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n","// ============================================\n// AI Contact Assistant Service\n// Provides intelligent contact management through AI\n// Full integration with RISIVO CRM Contact Module\n// ============================================\n\nimport { supabaseAdmin } from '@/lib/supabase/server'\n\ninterface ContactQueryIntent {\n  action: 'create' | 'search' | 'update' | 'delete' | 'list' | 'analyze' | 'bulk_email' | 'bulk_sms' | 'bulk_tag' | 'bulk_delete' | 'smart_list' | 'export' | 'import' | 'call' | 'email' | 'sms' | 'unknown'\n  confidence: number\n  entities: {\n    firstName?: string\n    lastName?: string\n    email?: string\n    phone?: string\n    company?: string\n    status?: string\n    tags?: string[]\n    query?: string\n    contactId?: string\n    listName?: string\n    exportFormat?: 'csv' | 'json'\n    filterStatus?: string\n    filterTag?: string\n    message?: string\n    subject?: string\n    newEmail?: string  // For update operations\n    newPhone?: string  // For update operations\n  }\n}\n\ninterface ContactActionResult {\n  success: boolean\n  action: string\n  message: string\n  data?: any\n  suggestions?: string[]\n  actionButtons?: Array<{\n    label: string\n    action: string\n    params?: Record<string, any>\n  }>\n}\n\n// Intent patterns for contact-related queries\n// NOTE: Order matters! More specific patterns should be checked first\nconst INTENT_PATTERNS = {\n  // UPDATE must come before EMAIL to catch \"change email\", \"update email\", \"edit email\"\n  update: [\n    /add\\s+(the\\s+)?tag/i,  // \"add tag X to Y\" for individual contacts\n    /tag\\s+(him|her|them|the\\s+contact|.+)\\s+(as|with)/i,  // \"tag Mike as VIP\"\n    /change\\s+(his|her|their|the)?\\s*(email|phone|status|name|tag)/i,\n    /update\\s+(his|her|their|the)?\\s*(email|phone|status|name|tag)/i,\n    /edit\\s+(his|her|their|the)?\\s*(email|phone|status|name|tag)/i,\n    /modify\\s+(his|her|their|the)?\\s*(email|phone|status|name|tag)/i,\n    /change\\s+(.+)\\s+(email|phone)\\s+(to|from)/i,\n    /update\\s+(the\\s+)?contact/i,\n    /change\\s+(.+)\\s+for\\s+(.+)/i,\n    /edit\\s+(the\\s+)?contact/i,\n    /modify\\s+(the\\s+)?contact/i,\n    /set\\s+(.+)\\s+to\\s+(.+)/i,\n    /mark\\s+(.+)\\s+as\\s+(.+)/i,\n    /(email|phone)\\s+(to|=|:)\\s*[\\w@.-]+/i,  // \"email to xxx@xxx.com\" pattern\n    /from\\s+[\\w@.-]+\\s+to\\s+[\\w@.-]+/i,  // \"from xxx to yyy\" pattern\n  ],\n  create: [\n    /add\\s+(a\\s+)?new?\\s+contact/i,\n    /create\\s+(a\\s+)?contact/i,\n    /new\\s+contact/i,\n    /add\\s+(.+)\\s+to\\s+(my\\s+)?contacts/i,\n    /save\\s+(.+)\\s+as\\s+(a\\s+)?contact/i,\n  ],\n  search: [\n    /find\\s+(contacts?|people|mike|john|jane|.+doe)/i,\n    /search\\s+(for\\s+)?(contacts?|people)\\s+(.+)/i,\n    /look\\s+(up|for)\\s+(.+)/i,\n    /who\\s+(is|are)\\s+(.+)/i,\n    /show\\s+(me\\s+)?(contacts?\\s+)?(named?|called?|from?)\\s+(.+)/i,\n    /get\\s+(contact|info|details)\\s+(for|about|of)\\s+(.+)/i,\n    /pull\\s+(up\\s+)?(the\\s+)?(details|info|contact)/i,\n    /his\\s+current\\s+email/i,\n    /her\\s+current\\s+email/i,\n  ],\n  delete: [\n    /delete\\s+(the\\s+)?contact/i,\n    /remove\\s+(the\\s+)?contact/i,\n    /trash\\s+(the\\s+)?contact/i,\n  ],\n  list: [\n    /list\\s+(all\\s+)?(my\\s+)?contacts/i,\n    /show\\s+(me\\s+)?(all\\s+)?(my\\s+)?contacts/i,\n    /get\\s+(all\\s+)?contacts/i,\n    /how\\s+many\\s+contacts/i,\n    /display\\s+(all\\s+)?contacts/i,\n  ],\n  analyze: [\n    /analyze\\s+(my\\s+)?contacts/i,\n    /contact\\s+statistics/i,\n    /contact\\s+report/i,\n    /summarize\\s+(my\\s+)?contacts/i,\n    /contact\\s+insights/i,\n    /contact\\s+analytics/i,\n  ],\n  bulk_email: [\n    /send\\s+email\\s+to\\s+(all|multiple|selected)/i,\n    /bulk\\s+email/i,\n    /email\\s+all\\s+(.+)?contacts/i,\n    /mass\\s+email/i,\n  ],\n  bulk_sms: [\n    /send\\s+sms\\s+to\\s+(all|multiple|selected)/i,\n    /bulk\\s+sms/i,\n    /sms\\s+all\\s+(.+)?contacts/i,\n    /mass\\s+sms/i,\n    /text\\s+(all|multiple)\\s+contacts/i,\n  ],\n  bulk_tag: [\n    /add\\s+tag\\s+(.+)\\s+to\\s+(all|multiple|selected)/i,\n    /tag\\s+(all|multiple)\\s+contacts/i,\n    /bulk\\s+tag/i,\n  ],\n  bulk_delete: [\n    /delete\\s+(all|multiple|selected)\\s+contacts/i,\n    /bulk\\s+delete/i,\n    /remove\\s+(all|multiple)\\s+contacts/i,\n  ],\n  smart_list: [\n    /create\\s+(a\\s+)?smart\\s+list/i,\n    /save\\s+(this\\s+)?filter\\s+as/i,\n    /save\\s+(as\\s+)?smart\\s+list/i,\n    /new\\s+smart\\s+list/i,\n  ],\n  export: [\n    /export\\s+(all\\s+)?(my\\s+)?contacts/i,\n    /download\\s+contacts/i,\n    /export\\s+to\\s+(csv|json)/i,\n    /get\\s+contact\\s+export/i,\n  ],\n  import: [\n    /import\\s+contacts/i,\n    /upload\\s+contacts/i,\n    /import\\s+from\\s+(csv|file)/i,\n  ],\n  call: [\n    /call\\s+(.+)/i,\n    /dial\\s+(.+)/i,\n    /phone\\s+(.+)/i,\n    /ring\\s+(.+)/i,\n  ],\n  email: [\n    /send\\s+(an\\s+)?email\\s+to\\s+(.+)/i,\n    /compose\\s+(an\\s+)?email\\s+(to\\s+)?(.+)/i,\n    /write\\s+(an\\s+)?email\\s+(to\\s+)?(.+)/i,\n    /email\\s+(him|her|them|this\\s+contact)/i,\n  ],\n  sms: [\n    /sms\\s+(.+)/i,\n    /text\\s+(.+)/i,\n    /send\\s+sms\\s+to\\s+(.+)/i,\n    /message\\s+(.+)/i,\n  ],\n}\n\n// Entity extraction patterns\nconst ENTITY_PATTERNS = {\n  email: /[\\w.-]+@[\\w.-]+\\.\\w+/i,\n  phone: /[\\d\\s()+-]{10,}/,\n  name: /(?:named?|called?|for|find|search|get|show)\\s+[\"']?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)?)[\"']?/i,\n  company: /(?:from|at|company)\\s+[\"']?([A-Za-z0-9\\s&]+?)[\"']?(?:\\s|$)/i,\n  status: /(?:status|stage|marked?\\s+as)\\s*(?:is|:)?\\s*(new|contacted|qualified|customer|lost)/i,\n  tags: /(?:tag(?:s|ged)?|add\\s+(?:the\\s+)?tag)\\s*(?:with|:)?\\s*[\"']?([^\"']+?)[\"']?(?:\\s+to\\s+|$)/i,\n  listName: /(?:list|as)\\s+[\"']?([^\"']+?)[\"']?(?:\\s|$)/i,\n  exportFormat: /(?:export|download)\\s+(?:as|to)\\s+(csv|json)/i,\n  newEmail: /(?:email|e-mail)(?:\\s+address)?\\s*(?:to|=|:)\\s*([\\w.-]+@[\\w.-]+\\.\\w+)/i,\n  newPhone: /(?:phone|number)\\s*(?:to|=|:)\\s*([\\d\\s()+-]{10,})/i,\n  emailChange: /(?:from\\s+)?([\\w.-]+@[\\w.-]+\\.\\w+)\\s+to\\s+([\\w.-]+@[\\w.-]+\\.\\w+)/i,\n}\n\nexport class ContactAssistantService {\n  private subAccountId: string\n\n  constructor(subAccountId: string) {\n    this.subAccountId = subAccountId\n  }\n\n  /**\n   * Parse natural language intent\n   */\n  parseIntent(message: string): ContactQueryIntent {\n    const normalizedMessage = message.toLowerCase().trim()\n    \n    // Detect action intent\n    let action: ContactQueryIntent['action'] = 'unknown'\n    let confidence = 0\n\n    // Check for update keywords first (highest priority)\n    const updateKeywords = ['change', 'update', 'edit', 'modify', 'set']\n    const emailMentioned = normalizedMessage.includes('email')\n    const hasUpdateKeyword = updateKeywords.some(kw => normalizedMessage.includes(kw))\n    \n    if (hasUpdateKeyword && emailMentioned) {\n      action = 'update'\n      confidence = 0.95\n    } else {\n      // Fall back to pattern matching\n      for (const [intentType, patterns] of Object.entries(INTENT_PATTERNS)) {\n        for (const pattern of patterns) {\n          if (pattern.test(normalizedMessage)) {\n            action = intentType as ContactQueryIntent['action']\n            confidence = 0.9\n            break\n          }\n        }\n        if (confidence > 0) break\n      }\n    }\n\n    // Extract entities\n    const entities: ContactQueryIntent['entities'] = {}\n\n    // Check for context prefix like \"for mike.doe@email.com:\" or \"for Mike Doe:\"\n    const contextMatch = message.match(/^for\\s+([\\w.-]+@[\\w.-]+\\.\\w+|[A-Z][a-z]+\\s+[A-Z][a-z]+)\\s*:/i)\n    if (contextMatch) {\n      const contextValue = contextMatch[1]\n      if (contextValue.includes('@')) {\n        entities.email = contextValue.toLowerCase()\n      } else {\n        const parts = contextValue.split(/\\s+/)\n        entities.firstName = parts[0]\n        if (parts.length > 1) entities.lastName = parts.slice(1).join(' ')\n      }\n    }\n\n    // Extract email (but don't override context email, and skip \"email to xxx\" which is the new email)\n    if (!entities.email) {\n      // Find all emails in message\n      const allEmails = message.match(/[\\w.-]+@[\\w.-]+\\.\\w+/gi) || []\n      // Check if this is an update with \"to\" - the email after \"to\" is the NEW email\n      const emailToMatch = message.match(/email\\s+to\\s+([\\w.-]+@[\\w.-]+\\.\\w+)/i)\n      const newEmail = emailToMatch ? emailToMatch[1].toLowerCase() : null\n      \n      // Use the first email that's not the \"new\" email\n      for (const email of allEmails) {\n        if (email.toLowerCase() !== newEmail) {\n          entities.email = email.toLowerCase()\n          break\n        }\n      }\n    }\n\n    // Extract phone\n    const phoneMatch = message.match(ENTITY_PATTERNS.phone)\n    if (phoneMatch) entities.phone = phoneMatch[0].replace(/\\s/g, '')\n\n    // Extract name\n    const nameMatch = message.match(ENTITY_PATTERNS.name)\n    if (nameMatch) {\n      const nameParts = nameMatch[1].split(' ')\n      entities.firstName = nameParts[0]\n      if (nameParts.length > 1) entities.lastName = nameParts.slice(1).join(' ')\n    }\n\n    // Extract company\n    const companyMatch = message.match(ENTITY_PATTERNS.company)\n    if (companyMatch) entities.company = companyMatch[1].trim()\n\n    // Extract status\n    const statusMatch = message.match(ENTITY_PATTERNS.status)\n    if (statusMatch) entities.status = statusMatch[1].toLowerCase()\n\n    // Extract tags - try multiple patterns\n    let tagsMatch = message.match(ENTITY_PATTERNS.tags)\n    if (tagsMatch) {\n      entities.tags = tagsMatch[1].split(/[,;]+/).map(t => t.trim()).filter(t => t.length > 0)\n    }\n    \n    // Also try: \"add tag X to Y\" or \"tag X\" pattern\n    if (!entities.tags || entities.tags.length === 0) {\n      const addTagMatch = message.match(/add\\s+(?:the\\s+)?tag\\s+[\"']?([^\"']+?)[\"']?\\s+to/i)\n      if (addTagMatch) {\n        entities.tags = [addTagMatch[1].trim()]\n      }\n    }\n    \n    // Also try quoted tag: tag \"Something\"\n    if (!entities.tags || entities.tags.length === 0) {\n      const quotedTagMatch = message.match(/tag\\s+[\"']([^\"']+)[\"']/i)\n      if (quotedTagMatch) {\n        entities.tags = [quotedTagMatch[1].trim()]\n      }\n    }\n\n    // Extract list name\n    const listNameMatch = message.match(ENTITY_PATTERNS.listName)\n    if (listNameMatch) entities.listName = listNameMatch[1].trim()\n\n    // Extract export format\n    const exportFormatMatch = message.match(ENTITY_PATTERNS.exportFormat)\n    if (exportFormatMatch) entities.exportFormat = exportFormatMatch[1].toLowerCase() as 'csv' | 'json'\n\n    // Extract email change pattern: \"from xxx@xxx.com to yyy@yyy.com\"\n    const emailChangeMatch = message.match(ENTITY_PATTERNS.emailChange)\n    if (emailChangeMatch) {\n      entities.email = emailChangeMatch[1].toLowerCase()  // Current email (to find contact)\n      entities.newEmail = emailChangeMatch[2].toLowerCase()  // New email\n      // Force update action when we detect email change\n      if (action !== 'update') action = 'update'\n      confidence = 0.95\n    }\n\n    // Extract new email (for updates like \"update email to xxx@xxx.com\")\n    if (!entities.newEmail) {\n      const newEmailMatch = message.match(ENTITY_PATTERNS.newEmail)\n      if (newEmailMatch) entities.newEmail = newEmailMatch[1].toLowerCase()\n    }\n\n    // Extract new phone (for updates)\n    const newPhoneMatch = message.match(ENTITY_PATTERNS.newPhone)\n    if (newPhoneMatch) entities.newPhone = newPhoneMatch[1].replace(/\\s/g, '')\n    \n    // If we have a newEmail but no current email, and there's another email in the message, use it\n    if (entities.newEmail && !entities.email) {\n      const allEmails = message.match(/[\\w.-]+@[\\w.-]+\\.\\w+/gi) || []\n      const otherEmails = allEmails.filter(e => e.toLowerCase() !== entities.newEmail)\n      if (otherEmails.length > 0) {\n        entities.email = otherEmails[0].toLowerCase()\n      }\n    }\n\n    // If searching, extract the search query more intelligently\n    if (['search', 'call', 'email', 'sms'].includes(action) && !entities.firstName && !entities.email) {\n      // Try to extract name directly (e.g., \"find Mike Doe\", \"search for John Smith\")\n      const nameExtractPatterns = [\n        /(?:find|search|look\\s*(?:for|up)?|show|get|pull)\\s+(?:contact\\s+)?(?:for\\s+)?(?:details?\\s+)?(?:of\\s+)?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)?)/i,\n        /([A-Z][a-z]+\\s+[A-Z][a-z]+)/,  // Just a capitalized name\n      ]\n      \n      let searchQuery = ''\n      for (const pattern of nameExtractPatterns) {\n        const match = message.match(pattern)\n        if (match && match[1]) {\n          searchQuery = match[1].trim()\n          break\n        }\n      }\n      \n      // Fallback: remove common words and use what's left\n      if (!searchQuery) {\n        searchQuery = normalizedMessage\n          .replace(/^(hi|hello|hey|please|can you|could you|i need you to|i want to|i'd like to)[,\\s]*/gi, '')\n          .replace(/\\b(find|search|look|for|show|me|get|pull|up|contacts?|people|named?|called?|details?|of|the)\\b/gi, '')\n          .replace(/\\s+/g, ' ')\n          .trim()\n      }\n      \n      if (searchQuery && searchQuery.length > 1) {\n        entities.query = searchQuery\n      }\n    }\n\n    return { action, confidence, entities }\n  }\n\n  /**\n   * Execute contact action based on intent\n   */\n  async executeAction(intent: ContactQueryIntent): Promise<ContactActionResult> {\n    const { action, entities } = intent\n\n    switch (action) {\n      case 'create':\n        return this.createContact(entities)\n      case 'search':\n        return this.searchContacts(entities)\n      case 'update':\n        return this.updateContact(entities)\n      case 'delete':\n        return this.deleteContact(entities)\n      case 'list':\n        return this.listContacts(entities)\n      case 'analyze':\n        return this.analyzeContacts()\n      case 'bulk_email':\n        return this.bulkEmail(entities)\n      case 'bulk_sms':\n        return this.bulkSms(entities)\n      case 'bulk_tag':\n        return this.bulkTag(entities)\n      case 'bulk_delete':\n        return this.bulkDelete(entities)\n      case 'smart_list':\n        return this.createSmartList(entities)\n      case 'export':\n        return this.exportContacts(entities)\n      case 'import':\n        return this.importContacts()\n      case 'call':\n        return this.initiateCall(entities)\n      case 'email':\n        return this.composeEmail(entities)\n      case 'sms':\n        return this.composeSms(entities)\n      default:\n        return {\n          success: false,\n          action: 'unknown',\n          message: \"I can help you manage contacts! Here are some things you can ask me:\",\n          suggestions: [\n            \"Add a new contact\",\n            \"Find contacts named John\",\n            \"Show all my contacts\",\n            \"How many customers do I have?\",\n            \"Analyze my contacts\",\n            \"Export contacts to CSV\",\n            \"Create a smart list\",\n            \"Send email to all customers\",\n          ],\n          actionButtons: [\n            { label: 'Add Contact', action: 'create', params: {} },\n            { label: 'List Contacts', action: 'list', params: {} },\n            { label: 'Analyze', action: 'analyze', params: {} },\n            { label: 'Export', action: 'export', params: {} },\n          ],\n        }\n    }\n  }\n\n  /**\n   * Create a new contact\n   */\n  private async createContact(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    if (!entities.firstName && !entities.email) {\n      return {\n        success: false,\n        action: 'create',\n        message: \"I need at least a name or email to create a contact. What information do you have?\",\n        suggestions: [\n          \"Add John Smith with email john@example.com\",\n          \"Create a contact named Sarah at Tech Corp\",\n          \"New contact: Mike Johnson, mike@acme.com, 555-0123\",\n        ],\n        actionButtons: [\n          { label: 'Open Contact Form', action: 'open_form', params: { type: 'create' } },\n        ],\n      }\n    }\n\n    try {\n      const contactData = {\n        subAccountId: this.subAccountId,\n        firstName: entities.firstName || 'New',\n        lastName: entities.lastName || 'Contact',\n        email: entities.email,\n        phone: entities.phone,\n        company: entities.company,\n        status: entities.status || 'new',\n        tags: entities.tags || [],\n        score: 50,\n      }\n\n      const { data: contact, error } = await supabaseAdmin\n        .from('Contact')\n        .insert(contactData)\n        .select()\n        .single()\n\n      if (error) throw error\n\n      const fullName = `${contact.firstName} ${contact.lastName}`.trim()\n      return {\n        success: true,\n        action: 'create',\n        message: `I've created a new contact for **${fullName}**${contact.email ? ` (${contact.email})` : ''}.\\n\\nWhat would you like to do next?`,\n        data: {\n          contact,\n          viewUrl: `/sub-account/contacts/${contact.id}`,\n        },\n        suggestions: [\n          `Add ${contact.firstName} to a pipeline`,\n          `Send a welcome email to ${contact.firstName}`,\n          `Add more details to ${fullName}'s profile`,\n        ],\n        actionButtons: [\n          { label: 'View Contact', action: 'navigate', params: { url: `/sub-account/contacts/${contact.id}` } },\n          { label: 'Send Email', action: 'email', params: { contactId: contact.id } },\n          { label: 'Edit Details', action: 'edit', params: { contactId: contact.id } },\n        ],\n      }\n    } catch (error: any) {\n      return {\n        success: false,\n        action: 'create',\n        message: `Sorry, I couldn't create the contact: ${error.message}`,\n      }\n    }\n  }\n\n  /**\n   * Search for contacts\n   */\n  private async searchContacts(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    try {\n      let query = supabaseAdmin\n        .from('Contact')\n        .select('*')\n        .eq('subAccountId', this.subAccountId)\n        .limit(10)\n\n      // Build search conditions\n      if (entities.email) {\n        query = query.ilike('email', `%${entities.email}%`)\n      } else if (entities.firstName || entities.lastName || entities.query) {\n        // Parse the search term - could be \"Mike Doe\" or \"Mike\" or \"Doe\"\n        const searchTerm = entities.query || `${entities.firstName || ''} ${entities.lastName || ''}`.trim()\n        const parts = searchTerm.split(/\\s+/).filter(p => p.length > 0)\n        \n        if (parts.length >= 2) {\n          // If we have two parts like \"Mike Doe\", search firstName AND lastName\n          const firstName = parts[0]\n          const lastName = parts.slice(1).join(' ')\n          query = query.or(\n            `and(firstName.ilike.%${firstName}%,lastName.ilike.%${lastName}%),email.ilike.%${searchTerm}%,company.ilike.%${searchTerm}%`\n          )\n        } else if (parts.length === 1) {\n          // Single term - search across all fields\n          const term = parts[0]\n          query = query.or(\n            `firstName.ilike.%${term}%,lastName.ilike.%${term}%,email.ilike.%${term}%,company.ilike.%${term}%`\n          )\n        }\n      }\n\n      if (entities.company) {\n        query = query.ilike('company', `%${entities.company}%`)\n      }\n\n      if (entities.status) {\n        query = query.eq('status', entities.status)\n      }\n\n      const { data: contacts, error } = await query.order('createdAt', { ascending: false })\n\n      if (error) throw error\n\n      if (!contacts || contacts.length === 0) {\n        return {\n          success: true,\n          action: 'search',\n          message: \"I couldn't find any contacts matching your search. Would you like to create a new contact?\",\n          data: { contacts: [] },\n          suggestions: [\n            \"Add a new contact\",\n            \"Show all my contacts\",\n            \"Search with different criteria\",\n          ],\n          actionButtons: [\n            { label: 'Add Contact', action: 'create', params: {} },\n            { label: 'View All Contacts', action: 'navigate', params: { url: '/sub-account/contacts' } },\n          ],\n        }\n      }\n\n      // Format results\n      const resultList = contacts.slice(0, 5).map((c, i) => \n        `${i + 1}. **${c.firstName} ${c.lastName}** - ${c.email || 'No email'}${c.company ? ` (${c.company})` : ''} - *${c.status}*`\n      ).join('\\n')\n\n      return {\n        success: true,\n        action: 'search',\n        message: `Found **${contacts.length}** contact${contacts.length !== 1 ? 's' : ''}:\\n\\n${resultList}${contacts.length > 5 ? '\\n\\n...and more' : ''}\\n\\nWhat would you like to do?`,\n        data: {\n          contacts,\n          count: contacts.length,\n        },\n        suggestions: contacts.slice(0, 3).map(c => `View ${c.firstName}'s profile`),\n        actionButtons: contacts.slice(0, 3).map(c => ({\n          label: `View ${c.firstName}`,\n          action: 'navigate',\n          params: { url: `/sub-account/contacts/${c.id}` }\n        })),\n      }\n    } catch (error: any) {\n      return {\n        success: false,\n        action: 'search',\n        message: `Sorry, I had trouble searching contacts: ${error.message}`,\n      }\n    }\n  }\n\n  /**\n   * Update a contact\n   */\n  private async updateContact(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    if (!entities.contactId && !entities.email && !entities.firstName) {\n      return {\n        success: false,\n        action: 'update',\n        message: \"I need to know which contact to update. Please specify a name or email.\",\n        suggestions: [\n          \"Update John Smith's email\",\n          \"Change phone for john@example.com\",\n          \"Mark Jane as customer\",\n        ],\n      }\n    }\n\n    // First find the contact\n    const searchResult = await this.searchContacts(entities)\n    if (!searchResult.data?.contacts?.length) {\n      return {\n        success: false,\n        action: 'update',\n        message: \"I couldn't find a contact to update. Please check the name or email.\",\n      }\n    }\n\n    const contact = searchResult.data.contacts[0]\n\n    // Build update object based on what was requested\n    const updateData: any = { lastActivityAt: new Date().toISOString() }\n    const changes: string[] = []\n\n    // Check for email update\n    if (entities.newEmail) {\n      updateData.email = entities.newEmail\n      changes.push(`email to **${entities.newEmail}**`)\n    }\n\n    // Check for phone update\n    if (entities.newPhone) {\n      updateData.phone = entities.newPhone\n      changes.push(`phone to **${entities.newPhone}**`)\n    }\n\n    // Check for status update\n    if (entities.status) {\n      updateData.status = entities.status\n      changes.push(`status to **${entities.status}**`)\n    }\n\n    // Check for tags update\n    if (entities.tags && entities.tags.length > 0) {\n      updateData.tags = [...(contact.tags || []), ...entities.tags]\n      changes.push(`added tags: **${entities.tags.join(', ')}**`)\n    }\n\n    // If we have updates to make\n    if (changes.length > 0) {\n      try {\n        const { data: updated, error } = await supabaseAdmin\n          .from('Contact')\n          .update(updateData)\n          .eq('id', contact.id)\n          .eq('subAccountId', this.subAccountId)\n          .select()\n          .single()\n\n        if (error) throw error\n\n        return {\n          success: true,\n          action: 'update',\n          message: `âœ… Updated **${contact.firstName} ${contact.lastName}**:\\nâ€¢ ${changes.join('\\nâ€¢ ')}`,\n          data: { contact: updated },\n          actionButtons: [\n            { label: 'View Contact', action: 'navigate', params: { url: `/sub-account/contacts/${contact.id}` } },\n          ],\n        }\n      } catch (error: any) {\n        return {\n          success: false,\n          action: 'update',\n          message: `Failed to update contact: ${error.message}`,\n        }\n      }\n    }\n\n    return {\n      success: true,\n      action: 'update',\n      message: `Found **${contact.firstName} ${contact.lastName}** (${contact.email || 'no email'}). What would you like to update?\\n\\nExamples:\\nâ€¢ \"Update email to newemail@example.com\"\\nâ€¢ \"Change status to customer\"\\nâ€¢ \"Add tag VIP\"`,\n      data: { contact },\n      suggestions: [\n        `Set status to customer`,\n        `Update email to newemail@example.com`,\n        `Add tag \"VIP\"`,\n      ],\n      actionButtons: [\n        { label: 'Edit Contact', action: 'edit', params: { contactId: contact.id } },\n      ],\n    }\n  }\n\n  /**\n   * Delete a contact\n   */\n  private async deleteContact(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    if (!entities.contactId && !entities.email && !entities.firstName) {\n      return {\n        success: false,\n        action: 'delete',\n        message: \"I need to know which contact to delete. Please specify a name or email.\",\n        suggestions: [\n          \"Delete contact john@example.com\",\n          \"Remove John Smith from contacts\",\n        ],\n      }\n    }\n\n    // Find the contact first\n    const searchResult = await this.searchContacts(entities)\n    if (!searchResult.data?.contacts?.length) {\n      return {\n        success: false,\n        action: 'delete',\n        message: \"I couldn't find that contact. Please check the name or email.\",\n      }\n    }\n\n    const contact = searchResult.data.contacts[0]\n    const fullName = `${contact.firstName} ${contact.lastName}`.trim()\n\n    // Confirm before deletion\n    return {\n      success: true,\n      action: 'delete',\n      message: `Are you sure you want to delete **${fullName}** (${contact.email})?\\n\\nThis action cannot be undone.`,\n      data: { contact, requiresConfirmation: true },\n      actionButtons: [\n        { label: 'Yes, Delete', action: 'confirm_delete', params: { contactId: contact.id } },\n        { label: 'Cancel', action: 'cancel', params: {} },\n      ],\n    }\n  }\n\n  /**\n   * List contacts with optional filters\n   */\n  private async listContacts(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    try {\n      let query = supabaseAdmin\n        .from('Contact')\n        .select('*')\n        .eq('subAccountId', this.subAccountId)\n\n      if (entities.status) {\n        query = query.eq('status', entities.status)\n      }\n\n      if (entities.filterStatus) {\n        query = query.eq('status', entities.filterStatus)\n      }\n\n      const { data: contacts, count, error } = await query\n        .order('createdAt', { ascending: false })\n        .limit(10)\n\n      if (error) throw error\n\n      if (!contacts || contacts.length === 0) {\n        return {\n          success: true,\n          action: 'list',\n          message: \"You don't have any contacts yet. Would you like to add your first contact or import contacts?\",\n          data: { contacts: [], count: 0 },\n          suggestions: [\n            \"Add a new contact\",\n            \"Import contacts from CSV\",\n            \"Import from GoHighLevel\",\n          ],\n          actionButtons: [\n            { label: 'Add Contact', action: 'create', params: {} },\n            { label: 'Import Contacts', action: 'navigate', params: { url: '/sub-account/settings/import' } },\n          ],\n        }\n      }\n\n      // Get total count\n      const { count: totalCount } = await supabaseAdmin\n        .from('Contact')\n        .select('*', { count: 'exact', head: true })\n        .eq('subAccountId', this.subAccountId)\n\n      // Group by status\n      const statusCounts = contacts.reduce((acc: Record<string, number>, c) => {\n        acc[c.status] = (acc[c.status] || 0) + 1\n        return acc\n      }, {})\n\n      const statusSummary = Object.entries(statusCounts)\n        .map(([status, count]) => `${status}: ${count}`)\n        .join(', ')\n\n      const recentList = contacts.slice(0, 5).map((c, i) => \n        `${i + 1}. **${c.firstName} ${c.lastName}** - ${c.status}${c.company ? ` at ${c.company}` : ''}`\n      ).join('\\n')\n\n      return {\n        success: true,\n        action: 'list',\n        message: `You have **${totalCount || contacts.length}** total contacts.\\n\\n**Recent contacts:**\\n${recentList}\\n\\n**By status:** ${statusSummary}`,\n        data: {\n          contacts,\n          totalCount: totalCount || contacts.length,\n          statusCounts,\n        },\n        suggestions: [\n          \"Show me customers only\",\n          \"Find new leads\",\n          \"Export all contacts\",\n        ],\n        actionButtons: [\n          { label: 'View All', action: 'navigate', params: { url: '/sub-account/contacts' } },\n          { label: 'Add Contact', action: 'create', params: {} },\n          { label: 'Export', action: 'export', params: {} },\n        ],\n      }\n    } catch (error: any) {\n      return {\n        success: false,\n        action: 'list',\n        message: `Sorry, I couldn't list contacts: ${error.message}`,\n      }\n    }\n  }\n\n  /**\n   * Analyze contacts and provide insights\n   */\n  private async analyzeContacts(): Promise<ContactActionResult> {\n    try {\n      // Get all contacts for analysis\n      const { data: contacts, error } = await supabaseAdmin\n        .from('Contact')\n        .select('*')\n        .eq('subAccountId', this.subAccountId)\n\n      if (error) throw error\n\n      if (!contacts || contacts.length === 0) {\n        return {\n          success: true,\n          action: 'analyze',\n          message: \"You don't have any contacts to analyze yet. Let's get started by adding some contacts!\",\n          suggestions: [\n            \"Add a new contact\",\n            \"Import from GoHighLevel\",\n          ],\n          actionButtons: [\n            { label: 'Add Contact', action: 'create', params: {} },\n            { label: 'Import', action: 'navigate', params: { url: '/sub-account/settings/import' } },\n          ],\n        }\n      }\n\n      // Calculate analytics\n      const total = contacts.length\n      const statusBreakdown = contacts.reduce((acc: Record<string, number>, c) => {\n        acc[c.status] = (acc[c.status] || 0) + 1\n        return acc\n      }, {})\n\n      const withEmail = contacts.filter(c => c.email).length\n      const withPhone = contacts.filter(c => c.phone).length\n      const avgScore = Math.round(contacts.reduce((sum, c) => sum + (c.score || 0), 0) / total)\n\n      // Top tags\n      const tagCounts: Record<string, number> = {}\n      contacts.forEach(c => {\n        (c.tags || []).forEach((tag: string) => {\n          tagCounts[tag] = (tagCounts[tag] || 0) + 1\n        })\n      })\n      const topTags = Object.entries(tagCounts)\n        .sort(([, a], [, b]) => b - a)\n        .slice(0, 5)\n\n      // Sources breakdown\n      const sourceCounts: Record<string, number> = {}\n      contacts.forEach(c => {\n        const source = c.source || 'Unknown'\n        sourceCounts[source] = (sourceCounts[source] || 0) + 1\n      })\n      const topSources = Object.entries(sourceCounts)\n        .sort(([, a], [, b]) => b - a)\n        .slice(0, 5)\n\n      // Build report\n      const report = `## Contact Database Analysis\n\n**Total Contacts:** ${total}\n\n### By Status\n${Object.entries(statusBreakdown).map(([s, c]) => `- **${s}:** ${c} (${Math.round((c/total)*100)}%)`).join('\\n')}\n\n### Data Quality\n- With email: ${withEmail} (${Math.round((withEmail/total)*100)}%)\n- With phone: ${withPhone} (${Math.round((withPhone/total)*100)}%)\n- Average lead score: ${avgScore}/100\n\n${topTags.length > 0 ? `### Top Tags\\n${topTags.map(([tag, count]) => `- ${tag}: ${count}`).join('\\n')}` : ''}\n\n${topSources.length > 0 ? `### Top Sources\\n${topSources.map(([source, count]) => `- ${source}: ${count}`).join('\\n')}` : ''}`\n\n      return {\n        success: true,\n        action: 'analyze',\n        message: report,\n        data: {\n          total,\n          statusBreakdown,\n          dataQuality: { withEmail, withPhone, avgScore },\n          topTags,\n          topSources,\n        },\n        suggestions: [\n          \"Show me contacts without email\",\n          \"Find hot leads (score > 80)\",\n          \"Export contact report\",\n          \"Create smart list for customers\",\n        ],\n        actionButtons: [\n          { label: 'View Contacts', action: 'navigate', params: { url: '/sub-account/contacts' } },\n          { label: 'Export Report', action: 'export', params: { format: 'csv' } },\n        ],\n      }\n    } catch (error: any) {\n      return {\n        success: false,\n        action: 'analyze',\n        message: `Sorry, I couldn't analyze contacts: ${error.message}`,\n      }\n    }\n  }\n\n  /**\n   * Bulk email to contacts\n   */\n  private async bulkEmail(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    // Get contacts based on filter\n    let query = supabaseAdmin\n      .from('Contact')\n      .select('id, firstName, lastName, email')\n      .eq('subAccountId', this.subAccountId)\n      .not('email', 'is', null)\n\n    if (entities.filterStatus) {\n      query = query.eq('status', entities.filterStatus)\n    }\n\n    const { data: contacts, error } = await query\n\n    if (error || !contacts || contacts.length === 0) {\n      return {\n        success: false,\n        action: 'bulk_email',\n        message: \"No contacts found matching your criteria. Try a different filter.\",\n      }\n    }\n\n    return {\n      success: true,\n      action: 'bulk_email',\n      message: `Ready to send email to **${contacts.length}** contacts.\\n\\nPlease compose your email:`,\n      data: { contacts, count: contacts.length },\n      suggestions: [\n        \"What subject line would you like?\",\n        \"What message would you like to send?\",\n      ],\n      actionButtons: [\n        { label: 'Open Bulk Email', action: 'navigate', params: { url: '/sub-account/contacts/bulk-actions' } },\n      ],\n    }\n  }\n\n  /**\n   * Bulk SMS to contacts\n   */\n  private async bulkSms(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    // Get contacts with phone numbers\n    let query = supabaseAdmin\n      .from('Contact')\n      .select('id, firstName, lastName, phone')\n      .eq('subAccountId', this.subAccountId)\n      .not('phone', 'is', null)\n\n    if (entities.filterStatus) {\n      query = query.eq('status', entities.filterStatus)\n    }\n\n    const { data: contacts, error } = await query\n\n    if (error || !contacts || contacts.length === 0) {\n      return {\n        success: false,\n        action: 'bulk_sms',\n        message: \"No contacts with phone numbers found. Try adding phone numbers to your contacts.\",\n      }\n    }\n\n    return {\n      success: true,\n      action: 'bulk_sms',\n      message: `Ready to send SMS to **${contacts.length}** contacts with phone numbers.\\n\\nPlease compose your message:`,\n      data: { contacts, count: contacts.length },\n      actionButtons: [\n        { label: 'Open Bulk Actions', action: 'navigate', params: { url: '/sub-account/contacts/bulk-actions' } },\n      ],\n    }\n  }\n\n  /**\n   * Bulk add tag\n   */\n  private async bulkTag(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    if (!entities.tags || entities.tags.length === 0) {\n      return {\n        success: false,\n        action: 'bulk_tag',\n        message: \"What tag would you like to add? For example: 'Add tag VIP to all customers'\",\n        suggestions: [\n          \"Add tag 'VIP' to all customers\",\n          \"Tag all new contacts with 'Newsletter'\",\n        ],\n      }\n    }\n\n    return {\n      success: true,\n      action: 'bulk_tag',\n      message: `Ready to add tag **${entities.tags.join(', ')}** to selected contacts.\\n\\nWould you like to proceed?`,\n      data: { tags: entities.tags },\n      actionButtons: [\n        { label: 'Go to Bulk Actions', action: 'navigate', params: { url: '/sub-account/contacts/bulk-actions' } },\n      ],\n    }\n  }\n\n  /**\n   * Bulk delete contacts\n   */\n  private async bulkDelete(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    return {\n      success: true,\n      action: 'bulk_delete',\n      message: \"âš ï¸ **Warning:** Bulk delete is a destructive action.\\n\\nPlease go to the Contacts page, select the contacts you want to delete, and use the bulk delete option.\",\n      actionButtons: [\n        { label: 'Go to Contacts', action: 'navigate', params: { url: '/sub-account/contacts' } },\n      ],\n    }\n  }\n\n  /**\n   * Create smart list\n   */\n  private async createSmartList(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    if (!entities.listName) {\n      return {\n        success: false,\n        action: 'smart_list',\n        message: \"What would you like to name this smart list? For example: 'Save as Hot Leads'\",\n        suggestions: [\n          \"Save as 'Hot Leads'\",\n          \"Create list 'VIP Customers'\",\n          \"Save filter as 'Needs Follow-up'\",\n        ],\n      }\n    }\n\n    return {\n      success: true,\n      action: 'smart_list',\n      message: `I'll help you create a smart list called **${entities.listName}**.\\n\\nPlease go to the Smart Lists page to configure the filters.`,\n      data: { listName: entities.listName },\n      actionButtons: [\n        { label: 'Create Smart List', action: 'navigate', params: { url: '/sub-account/contacts/smart-lists' } },\n      ],\n    }\n  }\n\n  /**\n   * Export contacts\n   */\n  private async exportContacts(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    const format = entities.exportFormat || 'csv'\n\n    return {\n      success: true,\n      action: 'export',\n      message: `I'll help you export your contacts as ${format.toUpperCase()}.\\n\\nClick the button below or go to the Contacts page and click the Export button.`,\n      data: { format },\n      actionButtons: [\n        { label: 'Export Contacts', action: 'navigate', params: { url: '/sub-account/contacts?export=true' } },\n      ],\n    }\n  }\n\n  /**\n   * Import contacts instructions\n   */\n  private async importContacts(): Promise<ContactActionResult> {\n    return {\n      success: true,\n      action: 'import',\n      message: `I can help you import contacts from:\\n\\n1. **CSV File** - Upload a spreadsheet\\n2. **GoHighLevel** - Import from your GHL account\\n3. **Other CRMs** - HubSpot, Salesforce, etc. (coming soon)\\n\\nClick below to get started!`,\n      actionButtons: [\n        { label: 'Import CSV', action: 'navigate', params: { url: '/sub-account/contacts?import=true' } },\n        { label: 'Import from GHL', action: 'navigate', params: { url: '/sub-account/settings/import' } },\n      ],\n    }\n  }\n\n  /**\n   * Initiate call to contact\n   */\n  private async initiateCall(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    // Search for the contact\n    const searchResult = await this.searchContacts(entities)\n    \n    if (!searchResult.data?.contacts?.length) {\n      return {\n        success: false,\n        action: 'call',\n        message: \"I couldn't find that contact. Please provide a name or phone number.\",\n        suggestions: [\n          \"Call John Smith\",\n          \"Dial 555-0123\",\n        ],\n      }\n    }\n\n    const contact = searchResult.data.contacts[0]\n\n    if (!contact.phone) {\n      return {\n        success: false,\n        action: 'call',\n        message: `**${contact.firstName} ${contact.lastName}** doesn't have a phone number on file. Would you like to add one?`,\n        actionButtons: [\n          { label: 'Edit Contact', action: 'edit', params: { contactId: contact.id } },\n        ],\n      }\n    }\n\n    return {\n      success: true,\n      action: 'call',\n      message: `Ready to call **${contact.firstName} ${contact.lastName}** at ${contact.phone}`,\n      data: { contact },\n      actionButtons: [\n        { label: `Call ${contact.phone}`, action: 'call', params: { phone: contact.phone, contactId: contact.id } },\n        { label: 'View Contact', action: 'navigate', params: { url: `/sub-account/contacts/${contact.id}` } },\n      ],\n    }\n  }\n\n  /**\n   * Compose email to contact\n   */\n  private async composeEmail(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    const searchResult = await this.searchContacts(entities)\n    \n    if (!searchResult.data?.contacts?.length) {\n      return {\n        success: false,\n        action: 'email',\n        message: \"I couldn't find that contact. Please provide a name or email address.\",\n      }\n    }\n\n    const contact = searchResult.data.contacts[0]\n\n    return {\n      success: true,\n      action: 'email',\n      message: `Ready to send email to **${contact.firstName} ${contact.lastName}** (${contact.email})`,\n      data: { contact },\n      actionButtons: [\n        { label: 'Compose Email', action: 'email', params: { contactId: contact.id, email: contact.email } },\n        { label: 'View Contact', action: 'navigate', params: { url: `/sub-account/contacts/${contact.id}` } },\n      ],\n    }\n  }\n\n  /**\n   * Compose SMS to contact\n   */\n  private async composeSms(entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    const searchResult = await this.searchContacts(entities)\n    \n    if (!searchResult.data?.contacts?.length) {\n      return {\n        success: false,\n        action: 'sms',\n        message: \"I couldn't find that contact. Please provide a name or phone number.\",\n      }\n    }\n\n    const contact = searchResult.data.contacts[0]\n\n    if (!contact.phone) {\n      return {\n        success: false,\n        action: 'sms',\n        message: `**${contact.firstName} ${contact.lastName}** doesn't have a phone number. Would you like to add one?`,\n        actionButtons: [\n          { label: 'Edit Contact', action: 'edit', params: { contactId: contact.id } },\n        ],\n      }\n    }\n\n    return {\n      success: true,\n      action: 'sms',\n      message: `Ready to send SMS to **${contact.firstName} ${contact.lastName}** (${contact.phone})`,\n      data: { contact },\n      actionButtons: [\n        { label: 'Send SMS', action: 'sms', params: { contactId: contact.id, phone: contact.phone } },\n        { label: 'View Contact', action: 'navigate', params: { url: `/sub-account/contacts/${contact.id}` } },\n      ],\n    }\n  }\n\n  /**\n   * Process natural language request\n   */\n  async processRequest(message: string): Promise<ContactActionResult> {\n    const intent = this.parseIntent(message)\n    return this.executeAction(intent)\n  }\n\n  /**\n   * Process request with a known contact (for follow-up actions in conversation)\n   * This is used when the AI already knows which contact the user is referring to\n   */\n  async processRequestWithContact(message: string, contact: any): Promise<ContactActionResult> {\n    const intent = this.parseIntent(message)\n    \n    // If this is an update action, directly update the provided contact\n    if (intent.action === 'update') {\n      return this.updateContactDirect(contact, intent.entities)\n    }\n    \n    // For other actions, use the contact's info to help\n    if (!intent.entities.email && contact.email) {\n      intent.entities.email = contact.email\n    }\n    if (!intent.entities.firstName && contact.firstName) {\n      intent.entities.firstName = contact.firstName\n      intent.entities.lastName = contact.lastName\n    }\n    if (!intent.entities.contactId && contact.id) {\n      intent.entities.contactId = contact.id\n    }\n    \n    return this.executeAction(intent)\n  }\n\n  /**\n   * Directly update a contact without searching (used when contact is already known)\n   */\n  private async updateContactDirect(contact: any, entities: ContactQueryIntent['entities']): Promise<ContactActionResult> {\n    // Build update object based on what was requested\n    const updateData: any = { lastActivityAt: new Date().toISOString() }\n    const changes: string[] = []\n\n    // Check for new email\n    if (entities.newEmail) {\n      updateData.email = entities.newEmail\n      changes.push(`email from **${contact.email}** to **${entities.newEmail}**`)\n    }\n\n    // Check for new phone\n    if (entities.newPhone) {\n      updateData.phone = entities.newPhone\n      changes.push(`phone to **${entities.newPhone}**`)\n    }\n\n    // Check for status update\n    if (entities.status) {\n      updateData.status = entities.status\n      changes.push(`status to **${entities.status}**`)\n    }\n\n    // Check for tags update\n    if (entities.tags && entities.tags.length > 0) {\n      updateData.tags = [...(contact.tags || []), ...entities.tags]\n      changes.push(`added tags: **${entities.tags.join(', ')}**`)\n    }\n\n    // If we have updates to make\n    if (changes.length > 0) {\n      try {\n        const { data: updated, error } = await supabaseAdmin\n          .from('Contact')\n          .update(updateData)\n          .eq('id', contact.id)\n          .eq('subAccountId', this.subAccountId)\n          .select()\n          .single()\n\n        if (error) throw error\n\n        return {\n          success: true,\n          action: 'update',\n          message: `âœ… Updated **${contact.firstName} ${contact.lastName}**:\\nâ€¢ ${changes.join('\\nâ€¢ ')}`,\n          data: { contact: updated },\n          actionButtons: [\n            { label: 'View Contact', action: 'navigate', params: { url: `/sub-account/contacts/${contact.id}` } },\n          ],\n        }\n      } catch (error: any) {\n        return {\n          success: false,\n          action: 'update',\n          message: `Failed to update contact: ${error.message}`,\n        }\n      }\n    }\n\n    return {\n      success: true,\n      action: 'update',\n      message: `What would you like to update for **${contact.firstName} ${contact.lastName}** (${contact.email})?\\n\\nYou can say:\\nâ€¢ \"Update email to newemail@example.com\"\\nâ€¢ \"Change status to customer\"\\nâ€¢ \"Add tag VIP\"`,\n      data: { contact },\n      actionButtons: [\n        { label: 'Edit Contact', action: 'edit', params: { contactId: contact.id } },\n      ],\n    }\n  }\n}\n\n// Export factory function\nexport function createContactAssistant(subAccountId: string): ContactAssistantService {\n  return new ContactAssistantService(subAccountId)\n}\n"],"names":[],"mappings":"uCCAA,oDAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,KDZA,EAAA,EAAA,CAAA,CAAA,mnhBECA,IAAA,GAAA,EAAA,CAAA,CAAA,OAyCA,IAAM,GAAkB,CAEtB,OAAQ,CACN,sBACA,qDACA,iEACA,iEACA,+DACA,iEACA,6CACA,6BACA,8BACA,2BACA,6BACA,0BACA,2BACA,uCACA,mCACD,CACD,OAAQ,CACN,+BACA,2BACA,iBACA,sCACA,qCACD,CACD,OAAQ,CACN,kDACA,+CACA,0BACA,yBACA,+DACA,wDACA,kDACA,yBACA,yBACD,CACD,OAAQ,CACN,6BACA,6BACA,4BACD,CACD,KAAM,CACJ,oCACA,4CACA,2BACA,yBACA,+BACD,CACD,QAAS,CACP,8BACA,wBACA,oBACA,gCACA,sBACA,uBACD,CACD,WAAY,CACV,+CACA,gBACA,+BACA,gBACD,CACD,SAAU,CACR,6CACA,cACA,6BACA,cACA,oCACD,CACD,SAAU,CACR,mDACA,mCACA,cACD,CACD,YAAa,CACX,+CACA,iBACA,sCACD,CACD,WAAY,CACV,gCACA,gCACA,+BACA,sBACD,CACD,OAAQ,CACN,sCACA,uBACA,4BACA,0BACD,CACD,OAAQ,CACN,qBACA,qBACA,8BACD,CACD,KAAM,CACJ,eACA,eACA,gBACA,eACD,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","ignoreList":[1]}