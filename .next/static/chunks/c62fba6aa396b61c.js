(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96294,e=>{"use strict";let t;var r,n,l,a,s,i,o,d,c,u,g,p,h,x,m,f,y,b,v,j=e.i(43476),w=e.i(71645),N=e.i(22016),C=e.i(18566),S=e.i(74080);let k="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function D(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function E(e){return"nodeType"in e}function O(e){var t,r;return e?D(e)?e:E(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function T(e){let{Document:t}=O(e);return e instanceof t}function M(e){return!D(e)&&e instanceof O(e).HTMLElement}function P(e){return e instanceof O(e).SVGElement}function L(e){return e?D(e)?e.document:E(e)?T(e)?e:M(e)||P(e)?e.ownerDocument:document:document:document}let R=k?w.useLayoutEffect:w.useEffect;function I(e){let t=(0,w.useRef)(e);return R(()=>{t.current=e}),(0,w.useCallback)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)},[])}function A(e,t){void 0===t&&(t=[e]);let r=(0,w.useRef)(e);return R(()=>{r.current!==e&&(r.current=e)},t),r}function $(e,t){let r=(0,w.useRef)();return(0,w.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function F(e){let t=I(e),r=(0,w.useRef)(null),n=(0,w.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,n]}function B(e){let t=(0,w.useRef)();return(0,w.useEffect)(()=>{t.current=e},[e]),t.current}let z={};function U(e,t){return(0,w.useMemo)(()=>{if(t)return t;let r=null==z[e]?0:z[e]+1;return z[e]=r,e+"-"+r},[e,t])}function W(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),l=1;l<r;l++)n[l-1]=arguments[l];return n.reduce((t,r)=>{for(let[n,l]of Object.entries(r)){let r=t[n];null!=r&&(t[n]=r+e*l)}return t},{...t})}}let V=W(1),H=W(-1);function X(e){if(!e)return!1;let{KeyboardEvent:t}=O(e.target);return t&&e instanceof t}function Y(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=O(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let K=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[K.Translate.toString(e),K.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),J="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",q={display:"none"};function _(e){let{id:t,value:r}=e;return w.default.createElement("div",{id:t,style:q},r)}function G(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;return w.default.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":n,"aria-atomic":!0},r)}let Q=(0,w.createContext)(null),Z={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},ee={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function et(e){var t;let r,{announcements:n=ee,container:l,hiddenTextDescribedById:a,screenReaderInstructions:s=Z}=e,{announce:i,announcement:o}=function(){let[e,t]=(0,w.useState)("");return{announce:(0,w.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),d=U("DndLiveRegion"),[c,u]=(0,w.useState)(!1);if((0,w.useEffect)(()=>{u(!0)},[]),t=(0,w.useMemo)(()=>({onDragStart(e){let{active:t}=e;i(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;n.onDragMove&&i(n.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;i(n.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;i(n.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;i(n.onDragCancel({active:t,over:r}))}}),[i,n]),r=(0,w.useContext)(Q),(0,w.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!c)return null;let g=w.default.createElement(w.default.Fragment,null,w.default.createElement(_,{id:a,value:s.draggable}),w.default.createElement(G,{id:d,announcement:o}));return l?(0,S.createPortal)(g,l):g}function er(){}(r=u||(u={})).DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable";let en=Object.freeze({x:0,y:0});function el(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function ea(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function es(e){let{left:t,top:r,height:n,width:l}=e;return[{x:t,y:r},{x:t+l,y:r},{x:t,y:r+n},{x:t+l,y:r+n}]}let ei=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,l=es(t),a=[];for(let e of n){let{id:t}=e,n=r.get(t);if(n){let r=es(n),s=Number((l.reduce((e,t,n)=>{var l;return e+(l=r[n],Math.sqrt(Math.pow(l.x-t.x,2)+Math.pow(l.y-t.y,2)))},0)/4).toFixed(4));a.push({id:t,data:{droppableContainer:e,value:s}})}}return a.sort(el)},eo=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,l=[];for(let e of n){let{id:n}=e,a=r.get(n);if(a){let r=function(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),l=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height);if(n<l&&r<a){let s=t.width*t.height,i=e.width*e.height,o=(l-n)*(a-r);return Number((o/(s+i-o)).toFixed(4))}return 0}(a,t);r>0&&l.push({id:n,data:{droppableContainer:e,value:r}})}}return l.sort(ea)};function ed(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:en}let ec=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})};function eu(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}let eg={ignoreTransform:!1};function ep(e,t){void 0===t&&(t=eg);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:n}=O(e).getComputedStyle(e);t&&(r=function(e,t,r){let n=eu(t);if(!n)return e;let{scaleX:l,scaleY:a,x:s,y:i}=n,o=e.left-s-(1-l)*parseFloat(r),d=e.top-i-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),c=l?e.width/l:e.width,u=a?e.height/a:e.height;return{width:c,height:u,top:d,right:o+c,bottom:d+u,left:o}}(r,t,n))}let{top:n,left:l,width:a,height:s,bottom:i,right:o}=r;return{top:n,left:l,width:a,height:s,bottom:i,right:o}}function eh(e){return ep(e,{ignoreTransform:!0})}function ex(e,t){let r=[];return e?function n(l){var a,s;let i;if(null!=t&&r.length>=t||!l)return r;if(T(l)&&null!=l.scrollingElement&&!r.includes(l.scrollingElement))return r.push(l.scrollingElement),r;if(!M(l)||P(l)||r.includes(l))return r;let o=O(e).getComputedStyle(l);return(l!==e&&(void 0===(a=o)&&(a=O(l).getComputedStyle(l)),i=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=a[e];return"string"==typeof t&&i.test(t)}))&&r.push(l),void 0===(s=o)&&(s=O(l).getComputedStyle(l)),"fixed"===s.position)?r:n(l.parentNode)}(e):r}function em(e){let[t]=ex(e,1);return null!=t?t:null}function ef(e){return k&&e?D(e)?e:E(e)?T(e)||e===L(e).scrollingElement?window:M(e)?e:null:null:null}function ey(e){return D(e)?e.scrollX:e.scrollLeft}function eb(e){return D(e)?e.scrollY:e.scrollTop}function ev(e){return{x:ey(e),y:eb(e)}}function ej(e){return!!k&&!!e&&e===document.scrollingElement}function ew(e){let t={x:0,y:0},r=ej(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},l=e.scrollTop<=t.y,a=e.scrollLeft<=t.x;return{isTop:l,isLeft:a,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}(n=g||(g={}))[n.Forward=1]="Forward",n[n.Backward=-1]="Backward";let eN={x:.2,y:.2};function eC(e){return e.reduce((e,t)=>V(e,ev(t)),en)}function eS(e,t){if(void 0===t&&(t=ep),!e)return;let{top:r,left:n,bottom:l,right:a}=t(e);em(e)&&(l<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}let ek=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+ey(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+eb(t),0)}]];class eD{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=ex(t),n=eC(r);for(const[t,l,a]of(this.rect={...e},this.width=e.width,this.height=e.height,ek))for(const e of l)Object.defineProperty(this,e,{get:()=>{let l=a(r),s=n[t]-l;return this.rect[e]+s},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class eE{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function eO(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}function eT(e){e.preventDefault()}function eM(e){e.stopPropagation()}(l=p||(p={})).Click="click",l.DragStart="dragstart",l.Keydown="keydown",l.ContextMenu="contextmenu",l.Resize="resize",l.SelectionChange="selectionchange",l.VisibilityChange="visibilitychange",(a=h||(h={})).Space="Space",a.Down="ArrowDown",a.Right="ArrowRight",a.Left="ArrowLeft",a.Up="ArrowUp",a.Esc="Escape",a.Enter="Enter",a.Tab="Tab";let eP={start:[h.Space,h.Enter],cancel:[h.Esc],end:[h.Space,h.Enter,h.Tab]},eL=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case h.Right:return{...r,x:r.x+25};case h.Left:return{...r,x:r.x-25};case h.Down:return{...r,y:r.y+25};case h.Up:return{...r,y:r.y-25}}};class eR{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new eE(L(t)),this.windowListeners=new eE(O(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(p.Resize,this.handleCancel),this.windowListeners.add(p.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(p.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&eS(r),t(en)}handleKeyDown(e){if(X(e)){let{active:t,context:r,options:n}=this.props,{keyboardCodes:l=eP,coordinateGetter:a=eL,scrollBehavior:s="smooth"}=n,{code:i}=e;if(l.end.includes(i))return void this.handleEnd(e);if(l.cancel.includes(i))return void this.handleCancel(e);let{collisionRect:o}=r.current,d=o?{x:o.left,y:o.top}:en;this.referenceCoordinates||(this.referenceCoordinates=d);let c=a(e,{active:t,context:r.current,currentCoordinates:d});if(c){let t=H(c,d),n={x:0,y:0},{scrollableAncestors:l}=r.current;for(let r of l){let l=e.code,{isTop:a,isRight:i,isLeft:o,isBottom:d,maxScroll:u,minScroll:g}=ew(r),p=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:n,bottom:l}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:l,width:e.clientWidth,height:e.clientHeight}}(r),x={x:Math.min(l===h.Right?p.right-p.width/2:p.right,Math.max(l===h.Right?p.left:p.left+p.width/2,c.x)),y:Math.min(l===h.Down?p.bottom-p.height/2:p.bottom,Math.max(l===h.Down?p.top:p.top+p.height/2,c.y))},m=l===h.Right&&!i||l===h.Left&&!o,f=l===h.Down&&!d||l===h.Up&&!a;if(m&&x.x!==c.x){let e=r.scrollLeft+t.x,a=l===h.Right&&e<=u.x||l===h.Left&&e>=g.x;if(a&&!t.y)return void r.scrollTo({left:e,behavior:s});a?n.x=r.scrollLeft-e:n.x=l===h.Right?r.scrollLeft-u.x:r.scrollLeft-g.x,n.x&&r.scrollBy({left:-n.x,behavior:s});break}if(f&&x.y!==c.y){let e=r.scrollTop+t.y,a=l===h.Down&&e<=u.y||l===h.Up&&e>=g.y;if(a&&!t.x)return void r.scrollTo({top:e,behavior:s});a?n.y=r.scrollTop-e:n.y=l===h.Down?r.scrollTop-u.y:r.scrollTop-g.y,n.y&&r.scrollBy({top:-n.y,behavior:s});break}}this.handleMove(e,V(H(c,this.referenceCoordinates),n))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function eI(e){return!!(e&&"distance"in e)}function eA(e){return!!(e&&"delay"in e)}eR.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=eP,onActivation:l}=t,{active:a}=r,{code:s}=e.nativeEvent;if(n.start.includes(s)){let t=a.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==l||l({event:e.nativeEvent}),!0)}return!1}}];class e${constructor(e,t,r){var n;void 0===r&&(r=function(e){let{EventTarget:t}=O(e);return e instanceof t?e:L(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:l}=e,{target:a}=l;this.props=e,this.events=t,this.document=L(a),this.documentListeners=new eE(this.document),this.listeners=new eE(r),this.windowListeners=new eE(O(a)),this.initialCoordinates=null!=(n=Y(l))?n:en,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(p.Resize,this.handleCancel),this.windowListeners.add(p.DragStart,eT),this.windowListeners.add(p.VisibilityChange,this.handleCancel),this.windowListeners.add(p.ContextMenu,eT),this.documentListeners.add(p.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(eA(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(eI(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:n}=this.props;n(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(p.Click,eM,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(p.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:n,props:l}=this,{onMove:a,options:{activationConstraint:s}}=l;if(!n)return;let i=null!=(t=Y(e))?t:en,o=H(n,i);if(!r&&s){if(eI(s)){if(null!=s.tolerance&&eO(o,s.tolerance))return this.handleCancel();if(eO(o,s.distance))return this.handleStart()}return eA(s)&&eO(o,s.tolerance)?this.handleCancel():void this.handlePending(s,o)}e.cancelable&&e.preventDefault(),a(i)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===h.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let eF={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class eB extends e${constructor(e){const{event:t}=e;super(e,eF,L(t.target))}}eB.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!!r.isPrimary&&0===r.button&&(null==n||n({event:r}),!0)}}];(s=x||(x={}))[s.RightClick=2]="RightClick";(i=m||(m={}))[i.Pointer=0]="Pointer",i[i.DraggableRect=1]="DraggableRect",(o=f||(f={}))[o.TreeOrder=0]="TreeOrder",o[o.ReversedTreeOrder=1]="ReversedTreeOrder";let ez={x:{[g.Backward]:!1,[g.Forward]:!1},y:{[g.Backward]:!1,[g.Forward]:!1}};(d=y||(y={}))[d.Always=0]="Always",d[d.BeforeDragging=1]="BeforeDragging",d[d.WhileDragging=2]="WhileDragging",(b||(b={})).Optimized="optimized";let eU=new Map;function eW(e,t){return $(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function eV(e){let{callback:t,disabled:r}=e,n=I(t),l=(0,w.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(n)},[r]);return(0,w.useEffect)(()=>()=>null==l?void 0:l.disconnect(),[l]),l}function eH(e){return new eD(ep(e),e)}function eX(e,t,r){void 0===t&&(t=eH);let[n,l]=(0,w.useState)(null);function a(){l(n=>{if(!e)return null;if(!1===e.isConnected){var l;return null!=(l=null!=n?n:r)?l:null}let a=t(e);return JSON.stringify(n)===JSON.stringify(a)?n:a})}let s=function(e){let{callback:t,disabled:r}=e,n=I(t),l=(0,w.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(n)},[n,r]);return(0,w.useEffect)(()=>()=>null==l?void 0:l.disconnect(),[l]),l}({callback(t){if(e)for(let r of t){let{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){a();break}}}}),i=eV({callback:a});return R(()=>{a(),e?(null==i||i.observe(e),null==s||s.observe(document.body,{childList:!0,subtree:!0})):(null==i||i.disconnect(),null==s||s.disconnect())},[e]),n}let eY=[];function eK(e,t){void 0===t&&(t=[]);let r=(0,w.useRef)(null);return(0,w.useEffect)(()=>{r.current=null},t),(0,w.useEffect)(()=>{let t=e!==en;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?H(e,r.current):en}function eJ(e){return(0,w.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let eq=[];function e_(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return M(t)?t:e}let eG=[{sensor:eB,options:{}},{sensor:eR,options:{}}],eQ={current:{}},eZ={draggable:{measure:eh},droppable:{measure:eh,strategy:y.WhileDragging,frequency:b.Optimized},dragOverlay:{measure:ep}};class e0 extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let e1={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new e0,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:er},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:eZ,measureDroppableContainers:er,windowRect:null,measuringScheduled:!1},e2={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:er,draggableNodes:new Map,over:null,measureDroppableContainers:er},e4=(0,w.createContext)(e2),e5=(0,w.createContext)(e1);function e6(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new e0}}}function e3(e,t){switch(t.type){case u.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case u.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case u.DragEnd:case u.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case u.RegisterDroppable:{let{element:r}=t,{id:n}=r,l=new e0(e.droppable.containers);return l.set(n,r),{...e,droppable:{...e.droppable,containers:l}}}case u.SetDroppableDisabled:{let{id:r,key:n,disabled:l}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;let s=new e0(e.droppable.containers);return s.set(r,{...a,disabled:l}),{...e,droppable:{...e.droppable,containers:s}}}case u.UnregisterDroppable:{let{id:r,key:n}=t,l=e.droppable.containers.get(r);if(!l||n!==l.key)return e;let a=new e0(e.droppable.containers);return a.delete(r),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function e7(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:l}=(0,w.useContext)(e4),a=B(n),s=B(null==r?void 0:r.id);return(0,w.useEffect)(()=>{if(!t&&!n&&a&&null!=s){if(!X(a)||document.activeElement===a.target)return;let e=l.get(s);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=e.matches(J)?e:e.querySelector(J);if(t){t.focus();break}}})}},[n,t,l,s,a]),null}function e9(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...n}),r):r}let e8=(0,w.createContext)({...en,scaleX:1,scaleY:1});(c=v||(v={}))[c.Uninitialized=0]="Uninitialized",c[c.Initializing=1]="Initializing",c[c.Initialized=2]="Initialized";let te=(0,w.memo)(function(e){var t,r,n,l,a,s,i,o;let d,c,p,h,x,b,j,N,{id:C,accessibility:D,autoScroll:E=!0,children:T,sensors:P=eG,collisionDetection:L=eo,measuring:I,modifiers:z,...W}=e,[H,X]=(0,w.useReducer)(e3,void 0,e6),[K,J]=function(){let[e]=(0,w.useState)(()=>new Set),t=(0,w.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,w.useCallback)(t=>{let{type:r,event:n}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)})},[e]),t]}(),[q,_]=(0,w.useState)(v.Uninitialized),G=q===v.Initialized,{draggable:{active:Z,nodes:ee,translate:er},droppable:{containers:el}}=H,ea=null!=Z?ee.get(Z):null,es=(0,w.useRef)({initial:null,translated:null}),ei=(0,w.useMemo)(()=>{var e;return null!=Z?{id:Z,data:null!=(e=null==ea?void 0:ea.data)?e:eQ,rect:es}:null},[Z,ea]),eu=(0,w.useRef)(null),[eg,eh]=(0,w.useState)(null),[ey,eb]=(0,w.useState)(null),eS=A(W,Object.values(W)),ek=U("DndDescribedBy",C),eE=(0,w.useMemo)(()=>el.getEnabled(),[el]),eO=(0,w.useMemo)(()=>({draggable:{...eZ.draggable,...null==I?void 0:I.draggable},droppable:{...eZ.droppable,...null==I?void 0:I.droppable},dragOverlay:{...eZ.dragOverlay,...null==I?void 0:I.dragOverlay}}),[null==I?void 0:I.draggable,null==I?void 0:I.droppable,null==I?void 0:I.dragOverlay]),{droppableRects:eT,measureDroppableContainers:eM,measuringScheduled:eP}=function(e,t){let{dragging:r,dependencies:n,config:l}=t,[a,s]=(0,w.useState)(null),{frequency:i,measure:o,strategy:d}=l,c=(0,w.useRef)(e),u=function(){switch(d){case y.Always:return!1;case y.BeforeDragging:return r;default:return!r}}(),g=A(u),p=(0,w.useCallback)(function(e){void 0===e&&(e=[]),g.current||s(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[g]),h=(0,w.useRef)(null),x=$(t=>{if(u&&!r)return eU;if(!t||t===eU||c.current!==e||null!=a){let t=new Map;for(let r of e){if(!r)continue;if(a&&a.length>0&&!a.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,n=e?new eD(o(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t},[e,a,r,u,o]);return(0,w.useEffect)(()=>{c.current=e},[e]),(0,w.useEffect)(()=>{u||p()},[r,u]),(0,w.useEffect)(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),(0,w.useEffect)(()=>{u||"number"!=typeof i||null!==h.current||(h.current=setTimeout(()=>{p(),h.current=null},i))},[i,u,p,...n]),{droppableRects:x,measureDroppableContainers:p,measuringScheduled:null!=a}}(eE,{dragging:G,dependencies:[er.x,er.y],config:eO.droppable}),eL=$(e=>{var t;return null==Z?null:null!=(t=null!=x?x:e)?t:null},[x=(h=null!=Z?ee.get(Z):void 0)?h.node.current:null,Z]),eR=(0,w.useMemo)(()=>ey?Y(ey):null,[ey]),eI=(d=(null==eg?void 0:eg.autoScrollEnabled)===!1,c="object"==typeof E?!1===E.enabled:!1===E,p=G&&!d&&!c,"object"==typeof E?{...E,enabled:p}:{enabled:p}),eA=eW(eL,eO.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:n,config:l=!0}=e,a=(0,w.useRef)(!1),{x:s,y:i}="boolean"==typeof l?{x:l,y:l}:l;R(()=>{if(!s&&!i||!t){a.current=!1;return}if(a.current||!n)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let l=ed(r(e),n);if(s||(l.x=0),i||(l.y=0),a.current=!0,Math.abs(l.x)>0||Math.abs(l.y)>0){let t=em(e);t&&t.scrollBy({top:l.y,left:l.x})}},[t,s,i,n,r])}({activeNode:null!=Z?ee.get(Z):null,config:eI.layoutShiftCompensation,initialRect:eA,measure:eO.draggable.measure});let e$=eX(eL,eO.draggable.measure,eA),eF=eX(eL?eL.parentElement:null),eB=(0,w.useRef)({activatorEvent:null,active:null,activeNode:eL,collisionRect:null,collisions:null,droppableRects:eT,draggableNodes:ee,draggingNode:null,draggingNodeRect:null,droppableContainers:el,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),eH=el.getNodeFor(null==(t=eB.current.over)?void 0:t.id),e0=function(e){let{measure:t}=e,[r,n]=(0,w.useState)(null),l=eV({callback:(0,w.useCallback)(e=>{for(let{target:r}of e)if(M(r)){n(e=>{let n=t(r);return e?{...e,width:n.width,height:n.height}:n});break}},[t])}),[a,s]=F((0,w.useCallback)(e=>{let r=e_(e);null==l||l.disconnect(),r&&(null==l||l.observe(r)),n(r?t(r):null)},[t,l]));return(0,w.useMemo)(()=>({nodeRef:a,rect:r,setRef:s}),[r,a,s])}({measure:eO.dragOverlay.measure}),e1=null!=(r=e0.nodeRef.current)?r:eL,e2=G?null!=(n=e0.rect)?n:e$:null,te=!!(e0.nodeRef.current&&e0.rect),tt=(b=eW(a=te?null:e$),ed(a,b)),tr=eJ(e1?O(e1):null),tn=(s=G?null!=eH?eH:eL:null,j=(0,w.useRef)(s),N=$(e=>s?e&&e!==eY&&s&&j.current&&s.parentNode===j.current.parentNode?e:ex(s):eY,[s]),(0,w.useEffect)(()=>{j.current=s},[s]),N),tl=function(e,t){void 0===t&&(t=ep);let[r]=e,n=eJ(r?O(r):null),[l,a]=(0,w.useState)(eq);function s(){a(()=>e.length?e.map(e=>ej(e)?n:new eD(t(e),e)):eq)}let i=eV({callback:s});return R(()=>{null==i||i.disconnect(),s(),e.forEach(e=>null==i?void 0:i.observe(e))},[e]),l}(tn),ta=e9(z,{transform:{x:er.x-tt.x,y:er.y-tt.y,scaleX:1,scaleY:1},activatorEvent:ey,active:ei,activeNodeRect:e$,containerNodeRect:eF,draggingNodeRect:e2,over:eB.current.over,overlayNodeRect:e0.rect,scrollableAncestors:tn,scrollableAncestorRects:tl,windowRect:tr}),ts=eR?V(eR,er):null,ti=function(e){let[t,r]=(0,w.useState)(null),n=(0,w.useRef)(e),l=(0,w.useCallback)(e=>{let t=ef(e.target);t&&r(e=>e?(e.set(t,ev(t)),new Map(e)):null)},[]);return(0,w.useEffect)(()=>{let t=n.current;if(e!==t){a(t);let s=e.map(e=>{let t=ef(e);return t?(t.addEventListener("scroll",l,{passive:!0}),[t,ev(t)]):null}).filter(e=>null!=e);r(s.length?new Map(s):null),n.current=e}return()=>{a(e),a(t)};function a(e){e.forEach(e=>{let t=ef(e);null==t||t.removeEventListener("scroll",l)})}},[l,e]),(0,w.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>V(e,t),en):eC(e):en,[e,t])}(tn),to=eK(ti),td=eK(ti,[e$]),tc=V(ta,to),tu=e2?ec(e2,ta):null,tg=ei&&tu?L({active:ei,collisionRect:tu,droppableRects:eT,droppableContainers:eE,pointerCoordinates:ts}):null,tp=function(e,t){if(!e||0===e.length)return null;let[r]=e;return r.id}(tg,0),[th,tx]=(0,w.useState)(null),tm=(i=te?ta:V(ta,td),o=null!=(l=null==th?void 0:th.rect)?l:null,{...i,scaleX:o&&e$?o.width/e$.width:1,scaleY:o&&e$?o.height/e$.height:1}),tf=(0,w.useRef)(null),ty=(0,w.useCallback)((e,t)=>{let{sensor:r,options:n}=t;if(null==eu.current)return;let l=ee.get(eu.current);if(!l)return;let a=e.nativeEvent,s=new r({active:eu.current,activeNode:l,event:a,options:n,context:eB,onAbort(e){if(!ee.get(e))return;let{onDragAbort:t}=eS.current,r={id:e};null==t||t(r),K({type:"onDragAbort",event:r})},onPending(e,t,r,n){if(!ee.get(e))return;let{onDragPending:l}=eS.current,a={id:e,constraint:t,initialCoordinates:r,offset:n};null==l||l(a),K({type:"onDragPending",event:a})},onStart(e){let t=eu.current;if(null==t)return;let r=ee.get(t);if(!r)return;let{onDragStart:n}=eS.current,l={activatorEvent:a,active:{id:t,data:r.data,rect:es}};(0,S.unstable_batchedUpdates)(()=>{null==n||n(l),_(v.Initializing),X({type:u.DragStart,initialCoordinates:e,active:t}),K({type:"onDragStart",event:l}),eh(tf.current),eb(a)})},onMove(e){X({type:u.DragMove,coordinates:e})},onEnd:i(u.DragEnd),onCancel:i(u.DragCancel)});function i(e){return async function(){let{active:t,collisions:r,over:n,scrollAdjustedTranslate:l}=eB.current,s=null;if(t&&l){let{cancelDrop:i}=eS.current;s={activatorEvent:a,active:t,collisions:r,delta:l,over:n},e===u.DragEnd&&"function"==typeof i&&await Promise.resolve(i(s))&&(e=u.DragCancel)}eu.current=null,(0,S.unstable_batchedUpdates)(()=>{X({type:e}),_(v.Uninitialized),tx(null),eh(null),eb(null),tf.current=null;let t=e===u.DragEnd?"onDragEnd":"onDragCancel";if(s){let e=eS.current[t];null==e||e(s),K({type:t,event:s})}})}}tf.current=s},[ee]),tb=(0,w.useCallback)((e,t)=>(r,n)=>{let l=r.nativeEvent,a=ee.get(n);null!==eu.current||!a||l.dndKit||l.defaultPrevented||!0===e(r,t.options,{active:a})&&(l.dndKit={capturedBy:t.sensor},eu.current=n,ty(r,t))},[ee,ty]),tv=(0,w.useMemo)(()=>P.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:tb(e.handler,t)}))]},[]),[P,tb]);(0,w.useEffect)(()=>{if(!k)return;let e=P.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},P.map(e=>{let{sensor:t}=e;return t})),R(()=>{e$&&q===v.Initializing&&_(v.Initialized)},[e$,q]),(0,w.useEffect)(()=>{let{onDragMove:e}=eS.current,{active:t,activatorEvent:r,collisions:n,over:l}=eB.current;if(!t||!r)return;let a={active:t,activatorEvent:r,collisions:n,delta:{x:tc.x,y:tc.y},over:l};(0,S.unstable_batchedUpdates)(()=>{null==e||e(a),K({type:"onDragMove",event:a})})},[tc.x,tc.y]),(0,w.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:l}=eB.current;if(!e||null==eu.current||!t||!l)return;let{onDragOver:a}=eS.current,s=n.get(tp),i=s&&s.rect.current?{id:s.id,rect:s.rect.current,data:s.data,disabled:s.disabled}:null,o={active:e,activatorEvent:t,collisions:r,delta:{x:l.x,y:l.y},over:i};(0,S.unstable_batchedUpdates)(()=>{tx(i),null==a||a(o),K({type:"onDragOver",event:o})})},[tp]),R(()=>{eB.current={activatorEvent:ey,active:ei,activeNode:eL,collisionRect:tu,collisions:tg,droppableRects:eT,draggableNodes:ee,draggingNode:e1,draggingNodeRect:e2,droppableContainers:el,over:th,scrollableAncestors:tn,scrollAdjustedTranslate:tc},es.current={initial:e2,translated:tu}},[ei,eL,tg,tu,ee,e1,e2,eT,el,th,tn,tc]),function(e){let t,{acceleration:r,activator:n=m.Pointer,canScroll:l,draggingRect:a,enabled:s,interval:i=5,order:o=f.TreeOrder,pointerCoordinates:d,scrollableAncestors:c,scrollableAncestorRects:u,delta:p,threshold:h}=e,x=function(e){let{delta:t,disabled:r}=e,n=B(t);return $(e=>{if(r||!n||!e)return ez;let l={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[g.Backward]:e.x[g.Backward]||-1===l.x,[g.Forward]:e.x[g.Forward]||1===l.x},y:{[g.Backward]:e.y[g.Backward]||-1===l.y,[g.Forward]:e.y[g.Forward]||1===l.y}}},[r,t,n])}({delta:p,disabled:!s}),[y,b]=(t=(0,w.useRef)(null),[(0,w.useCallback)((e,r)=>{t.current=setInterval(e,r)},[]),(0,w.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]),v=(0,w.useRef)({x:0,y:0}),j=(0,w.useRef)({x:0,y:0}),N=(0,w.useMemo)(()=>{switch(n){case m.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case m.DraggableRect:return a}},[n,a,d]),C=(0,w.useRef)(null),S=(0,w.useCallback)(()=>{let e=C.current;if(!e)return;let t=v.current.x*j.current.x,r=v.current.y*j.current.y;e.scrollBy(t,r)},[]),k=(0,w.useMemo)(()=>o===f.TreeOrder?[...c].reverse():c,[o,c]);(0,w.useEffect)(()=>{if(!s||!c.length||!N)return void b();for(let e of k){if((null==l?void 0:l(e))===!1)continue;let t=u[c.indexOf(e)];if(!t)continue;let{direction:n,speed:a}=function(e,t,r,n,l){let{top:a,left:s,right:i,bottom:o}=r;void 0===n&&(n=10),void 0===l&&(l=eN);let{isTop:d,isBottom:c,isLeft:u,isRight:p}=ew(e),h={x:0,y:0},x={x:0,y:0},m={height:t.height*l.y,width:t.width*l.x};return!d&&a<=t.top+m.height?(h.y=g.Backward,x.y=n*Math.abs((t.top+m.height-a)/m.height)):!c&&o>=t.bottom-m.height&&(h.y=g.Forward,x.y=n*Math.abs((t.bottom-m.height-o)/m.height)),!p&&i>=t.right-m.width?(h.x=g.Forward,x.x=n*Math.abs((t.right-m.width-i)/m.width)):!u&&s<=t.left+m.width&&(h.x=g.Backward,x.x=n*Math.abs((t.left+m.width-s)/m.width)),{direction:h,speed:x}}(e,t,N,r,h);for(let e of["x","y"])x[e][n[e]]||(a[e]=0,n[e]=0);if(a.x>0||a.y>0){b(),C.current=e,y(S,i),v.current=a,j.current=n;return}}v.current={x:0,y:0},j.current={x:0,y:0},b()},[r,S,l,b,s,i,JSON.stringify(N),JSON.stringify(x),y,c,k,u,JSON.stringify(h)])}({...eI,delta:er,draggingRect:tu,pointerCoordinates:ts,scrollableAncestors:tn,scrollableAncestorRects:tl});let tj=(0,w.useMemo)(()=>({active:ei,activeNode:eL,activeNodeRect:e$,activatorEvent:ey,collisions:tg,containerNodeRect:eF,dragOverlay:e0,draggableNodes:ee,droppableContainers:el,droppableRects:eT,over:th,measureDroppableContainers:eM,scrollableAncestors:tn,scrollableAncestorRects:tl,measuringConfiguration:eO,measuringScheduled:eP,windowRect:tr}),[ei,eL,e$,ey,tg,eF,e0,ee,el,eT,th,eM,tn,tl,eO,eP,tr]),tw=(0,w.useMemo)(()=>({activatorEvent:ey,activators:tv,active:ei,activeNodeRect:e$,ariaDescribedById:{draggable:ek},dispatch:X,draggableNodes:ee,over:th,measureDroppableContainers:eM}),[ey,tv,ei,e$,X,ek,ee,th,eM]);return w.default.createElement(Q.Provider,{value:J},w.default.createElement(e4.Provider,{value:tw},w.default.createElement(e5.Provider,{value:tj},w.default.createElement(e8.Provider,{value:tm},T)),w.default.createElement(e7,{disabled:(null==D?void 0:D.restoreFocus)===!1})),w.default.createElement(et,{...D,hiddenTextDescribedById:ek}))}),tt=(0,w.createContext)(null),tr="button";function tn(){return(0,w.useContext)(e5)}let tl={timeout:25};function ta(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:l}=e,a=U("Droppable"),{active:s,dispatch:i,over:o,measureDroppableContainers:d}=(0,w.useContext)(e4),c=(0,w.useRef)({disabled:r}),g=(0,w.useRef)(!1),p=(0,w.useRef)(null),h=(0,w.useRef)(null),{disabled:x,updateMeasurementsFor:m,timeout:f}={...tl,...l},y=A(null!=m?m:n),b=eV({callback:(0,w.useCallback)(()=>{if(!g.current){g.current=!0;return}null!=h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(y.current)?y.current:[y.current]),h.current=null},f)},[f]),disabled:x||!s}),[v,j]=F((0,w.useCallback)((e,t)=>{b&&(t&&(b.unobserve(t),g.current=!1),e&&b.observe(e))},[b])),N=A(t);return(0,w.useEffect)(()=>{b&&v.current&&(b.disconnect(),g.current=!1,b.observe(v.current))},[v,b]),(0,w.useEffect)(()=>(i({type:u.RegisterDroppable,element:{id:n,key:a,disabled:r,node:v,rect:p,data:N}}),()=>i({type:u.UnregisterDroppable,key:a,id:n})),[n]),(0,w.useEffect)(()=>{r!==c.current.disabled&&(i({type:u.SetDroppableDisabled,id:n,key:a,disabled:r}),c.current.disabled=r)},[n,a,r,i]),{active:s,rect:p,isOver:(null==o?void 0:o.id)===n,node:v,over:o,setNodeRef:j}}function ts(e){let{animation:t,children:r}=e,[n,l]=(0,w.useState)(null),[a,s]=(0,w.useState)(null),i=B(r);return r||n||!i||l(i),R(()=>{if(!a)return;let e=null==n?void 0:n.key,r=null==n?void 0:n.props.id;null==e||null==r?l(null):Promise.resolve(t(r,a)).then(()=>{l(null)})},[t,n,a]),w.default.createElement(w.default.Fragment,null,r,n?(0,w.cloneElement)(n,{ref:s}):null)}let ti={x:0,y:0,scaleX:1,scaleY:1};function to(e){let{children:t}=e;return w.default.createElement(e4.Provider,{value:e2},w.default.createElement(e8.Provider,{value:ti},t))}let td={position:"fixed",touchAction:"none"},tc=e=>X(e)?"transform 250ms ease":void 0,tu=(0,w.forwardRef)((e,t)=>{let{as:r,activatorEvent:n,adjustScale:l,children:a,className:s,rect:i,style:o,transform:d,transition:c=tc}=e;if(!i)return null;let u=l?d:{...d,scaleX:1,scaleY:1},g={...td,width:i.width,height:i.height,top:i.top,left:i.left,transform:K.Transform.toString(u),transformOrigin:l&&n?function(e,t){let r=Y(e);if(!r)return"0 0";let n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}(n,i):void 0,transition:"function"==typeof c?c(n):c,...o};return w.default.createElement(r,{className:s,style:g,ref:t},a)}),tg={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:K.Transform.toString(t)},{transform:K.Transform.toString(r)}]},sideEffects:(t={styles:{active:{opacity:"0"}}},e=>{let{active:r,dragOverlay:n}=e,l={},{styles:a,className:s}=t;if(null!=a&&a.active)for(let[e,t]of Object.entries(a.active))void 0!==t&&(l[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=a&&a.dragOverlay)for(let[e,t]of Object.entries(a.dragOverlay))void 0!==t&&n.node.style.setProperty(e,t);return null!=s&&s.active&&r.node.classList.add(s.active),null!=s&&s.dragOverlay&&n.node.classList.add(s.dragOverlay),function(){for(let[e,t]of Object.entries(l))r.node.style.setProperty(e,t);null!=s&&s.active&&r.node.classList.remove(s.active)}})},tp=0,th=w.default.memo(e=>{var t;let{adjustScale:r=!1,children:n,dropAnimation:l,style:a,transition:s,modifiers:i,wrapperElement:o="div",className:d,zIndex:c=999}=e,{activatorEvent:u,active:g,activeNodeRect:p,containerNodeRect:h,draggableNodes:x,droppableContainers:m,dragOverlay:f,over:y,measuringConfiguration:b,scrollableAncestors:v,scrollableAncestorRects:j,windowRect:N}=tn(),C=(0,w.useContext)(e8),S=(t=null==g?void 0:g.id,(0,w.useMemo)(()=>{if(null!=t)return++tp},[t])),k=e9(i,{activatorEvent:u,active:g,activeNodeRect:p,containerNodeRect:h,draggingNodeRect:f.rect,over:y,overlayNodeRect:f.rect,scrollableAncestors:v,scrollableAncestorRects:j,transform:C,windowRect:N}),D=eW(p),E=function(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:l}=e;return I((e,a)=>{if(null===t)return;let s=r.get(e);if(!s)return;let i=s.node.current;if(!i)return;let o=e_(a);if(!o)return;let{transform:d}=O(a).getComputedStyle(a),c=eu(d);if(!c)return;let u="function"==typeof t?t:function(e){let{duration:t,easing:r,sideEffects:n,keyframes:l}={...tg,...e};return e=>{let{active:a,dragOverlay:s,transform:i,...o}=e;if(!t)return;let d={x:s.rect.left-a.rect.left,y:s.rect.top-a.rect.top},c={scaleX:1!==i.scaleX?a.rect.width*i.scaleX/s.rect.width:1,scaleY:1!==i.scaleY?a.rect.height*i.scaleY/s.rect.height:1},u={x:i.x-d.x,y:i.y-d.y,...c},g=l({...o,active:a,dragOverlay:s,transform:{initial:i,final:u}}),[p]=g,h=g[g.length-1];if(JSON.stringify(p)===JSON.stringify(h))return;let x=null==n?void 0:n({active:a,dragOverlay:s,...o}),m=s.node.animate(g,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{m.onfinish=()=>{null==x||x(),e()}})}}(t);return eS(i,l.draggable.measure),u({active:{id:e,data:s.data,node:i,rect:l.draggable.measure(i)},draggableNodes:r,dragOverlay:{node:a,rect:l.dragOverlay.measure(o)},droppableContainers:n,measuringConfiguration:l,transform:c})})}({config:l,draggableNodes:x,droppableContainers:m,measuringConfiguration:b}),T=D?f.setRef:void 0;return w.default.createElement(to,null,w.default.createElement(ts,{animation:E},g&&S?w.default.createElement(tu,{key:S,id:g.id,ref:T,as:o,activatorEvent:u,adjustScale:r,className:d,transition:s,rect:D,style:{zIndex:c,...a},transform:k},n):null))});function tx(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function tm(e){return null!==e&&e>=0}let tf=e=>{let{rects:t,activeIndex:r,overIndex:n,index:l}=e,a=tx(t,n,r),s=t[l],i=a[l];return i&&s?{x:i.left-s.left,y:i.top-s.top,scaleX:i.width/s.width,scaleY:i.height/s.height}:null},ty={scaleX:1,scaleY:1},tb=e=>{var t,r,n,l;let a,s,i,{activeIndex:o,activeNodeRect:d,index:c,rects:u,overIndex:g}=e,p=null!=(t=u[o])?t:d;if(!p)return null;if(c===o){let e=u[g];return e?{x:0,y:o<g?e.top+e.height-(p.top+p.height):e.top-p.top,...ty}:null}let h=(r=u,n=c,l=o,a=r[n],s=r[n-1],i=r[n+1],a?l<n?s?a.top-(s.top+s.height):i?i.top-(a.top+a.height):0:i?i.top-(a.top+a.height):s?a.top-(s.top+s.height):0:0);return c>o&&c<=g?{x:0,y:-p.height-h,...ty}:c<o&&c>=g?{x:0,y:p.height+h,...ty}:{x:0,y:0,...ty}},tv="Sortable",tj=w.default.createContext({activeIndex:-1,containerId:tv,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:tf,disabled:{draggable:!1,droppable:!1}});function tw(e){let{children:t,id:r,items:n,strategy:l=tf,disabled:a=!1}=e,{active:s,dragOverlay:i,droppableRects:o,over:d,measureDroppableContainers:c}=tn(),u=U(tv,r),g=null!==i.rect,p=(0,w.useMemo)(()=>n.map(e=>"object"==typeof e&&"id"in e?e.id:e),[n]),h=null!=s,x=s?p.indexOf(s.id):-1,m=d?p.indexOf(d.id):-1,f=(0,w.useRef)(p),y=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(p,f.current),b=-1!==m&&-1===x||y,v="boolean"==typeof a?{draggable:a,droppable:a}:a;R(()=>{y&&h&&c(p)},[y,p,h,c]),(0,w.useEffect)(()=>{f.current=p},[p]);let j=(0,w.useMemo)(()=>({activeIndex:x,containerId:u,disabled:v,disableTransforms:b,items:p,overIndex:m,useDragOverlay:g,sortedRects:p.reduce((e,t,r)=>{let n=o.get(t);return n&&(e[r]=n),e},Array(p.length)),strategy:l}),[x,u,v.draggable,v.droppable,b,p,m,o,g,l]);return w.default.createElement(tj.Provider,{value:j},t)}let tN=e=>{let{id:t,items:r,activeIndex:n,overIndex:l}=e;return tx(r,n,l).indexOf(t)},tC=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:l,items:a,newIndex:s,previousItems:i,previousContainerId:o,transition:d}=e;return!!d&&!!n&&(i===a||l!==s)&&(!!r||s!==l&&t===o)},tS={duration:200,easing:"ease"},tk="transform",tD=K.Transition.toString({property:tk,duration:0,easing:"linear"}),tE={roleDescription:"sortable"};function tO({opportunity:e,isDragging:t,onEdit:r,onDelete:n}){var l;let{attributes:a,listeners:s,setNodeRef:i,transform:o,transition:d,isDragging:c}=function(e){var t,r,n,l;let{animateLayoutChanges:a=tC,attributes:s,disabled:i,data:o,getNewIndex:d=tN,id:c,strategy:u,resizeObserverConfig:g,transition:p=tS}=e,{items:h,containerId:x,activeIndex:m,disabled:f,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:j,strategy:N}=(0,w.useContext)(tj),C=(t=i,r=f,"boolean"==typeof t?{draggable:t,droppable:!1}:{draggable:null!=(n=null==t?void 0:t.draggable)?n:r.draggable,droppable:null!=(l=null==t?void 0:t.droppable)?l:r.droppable}),S=h.indexOf(c),k=(0,w.useMemo)(()=>({sortable:{containerId:x,index:S,items:h},...o}),[x,o,S,h]),D=(0,w.useMemo)(()=>h.slice(h.indexOf(c)),[h,c]),{rect:E,node:O,isOver:T,setNodeRef:M}=ta({id:c,data:k,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:D,...g}}),{active:P,activatorEvent:L,activeNodeRect:I,attributes:$,setNodeRef:B,listeners:z,isDragging:W,over:V,setActivatorNodeRef:H,transform:Y}=function(e){let{id:t,data:r,disabled:n=!1,attributes:l}=e,a=U("Draggable"),{activators:s,activatorEvent:i,active:o,activeNodeRect:d,ariaDescribedById:c,draggableNodes:u,over:g}=(0,w.useContext)(e4),{role:p=tr,roleDescription:h="draggable",tabIndex:x=0}=null!=l?l:{},m=(null==o?void 0:o.id)===t,f=(0,w.useContext)(m?e8:tt),[y,b]=F(),[v,j]=F(),N=(0,w.useMemo)(()=>s.reduce((e,r)=>{let{eventName:n,handler:l}=r;return e[n]=e=>{l(e,t)},e},{}),[s,t]),C=A(r);return R(()=>(u.set(t,{id:t,key:a,node:y,activatorNode:v,data:C}),()=>{let e=u.get(t);e&&e.key===a&&u.delete(t)}),[u,t]),{active:o,activatorEvent:i,activeNodeRect:d,attributes:(0,w.useMemo)(()=>({role:p,tabIndex:x,"aria-disabled":n,"aria-pressed":!!m&&p===tr||void 0,"aria-roledescription":h,"aria-describedby":c.draggable}),[n,p,x,m,h,c.draggable]),isDragging:m,listeners:n?void 0:N,node:y,over:g,setNodeRef:b,setActivatorNodeRef:j,transform:f}}({id:c,data:k,attributes:{...tE,...s},disabled:C.draggable}),J=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,w.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(M,B),q=!!P,_=q&&!y&&tm(m)&&tm(v),G=!j&&W,Q=G&&_?Y:null,Z=_?null!=Q?Q:(null!=u?u:N)({rects:b,activeNodeRect:I,activeIndex:m,overIndex:v,index:S}):null,ee=tm(m)&&tm(v)?d({id:c,items:h,activeIndex:m,overIndex:v}):S,et=null==P?void 0:P.id,er=(0,w.useRef)({activeId:et,items:h,newIndex:ee,containerId:x}),en=h!==er.current.items,el=a({active:P,containerId:x,isDragging:W,isSorting:q,id:c,index:S,items:h,newIndex:er.current.newIndex,previousItems:er.current.items,previousContainerId:er.current.containerId,transition:p,wasDragging:null!=er.current.activeId}),ea=function(e){let{disabled:t,index:r,node:n,rect:l}=e,[a,s]=(0,w.useState)(null),i=(0,w.useRef)(r);return R(()=>{if(!t&&r!==i.current&&n.current){let e=l.current;if(e){let t=ep(n.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&s(r)}}r!==i.current&&(i.current=r)},[t,r,n,l]),(0,w.useEffect)(()=>{a&&s(null)},[a]),a}({disabled:!el,index:S,node:O,rect:E});return(0,w.useEffect)(()=>{q&&er.current.newIndex!==ee&&(er.current.newIndex=ee),x!==er.current.containerId&&(er.current.containerId=x),h!==er.current.items&&(er.current.items=h)},[q,ee,x,h]),(0,w.useEffect)(()=>{if(et===er.current.activeId)return;if(et&&!er.current.activeId){er.current.activeId=et;return}let e=setTimeout(()=>{er.current.activeId=et},50);return()=>clearTimeout(e)},[et]),{active:P,activeIndex:m,attributes:$,data:k,rect:E,index:S,newIndex:ee,items:h,isOver:T,isSorting:q,isDragging:W,listeners:z,node:O,overIndex:v,over:V,setNodeRef:J,setActivatorNodeRef:H,setDroppableNodeRef:M,setDraggableNodeRef:B,transform:null!=ea?ea:Z,transition:ea||en&&er.current.newIndex===S?tD:(!G||X(L))&&p&&(q||el)?K.Transition.toString({...p,property:tk}):void 0}}({id:e.id}),u={transform:K.Transform.toString(o),transition:d,opacity:c?.5:1},g={low:"bg-gray-100 text-gray-600",medium:"bg-blue-100 text-blue-600",high:"bg-orange-100 text-orange-600",urgent:"bg-red-100 text-red-600"};return(0,j.jsxs)("div",{ref:i,style:u,...a,...s,className:`
        bg-white rounded-lg shadow-sm border border-gray-200 p-3 mb-2
        cursor-grab active:cursor-grabbing
        hover:shadow-md transition-shadow
        ${t?"shadow-lg ring-2 ring-green-500 ring-opacity-50":""}
      `,children:[(0,j.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 flex-1 pr-2",children:[e.contact&&(0,j.jsx)("div",{className:"w-7 h-7 rounded-full bg-green-100 flex items-center justify-center text-xs font-semibold text-green-700",children:(l=e.contact)?`${l.firstName?.[0]||""}${l.lastName?.[0]||""}`.toUpperCase():"?"}),(0,j.jsx)("h4",{className:"font-medium text-gray-900 text-sm line-clamp-2",children:e.name})]}),(0,j.jsx)("span",{className:`text-xs px-2 py-0.5 rounded-full flex-shrink-0 ${g[e.priority]||g.medium}`,children:e.priority})]}),e.contact?.email&&(0,j.jsx)("div",{className:"text-xs text-gray-500 mb-2 truncate",children:e.contact.email}),(0,j.jsx)("div",{className:"text-lg font-bold text-green-600 mb-2",children:((e,t="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e))(e.value,e.currency)}),e.tags&&e.tags.length>0&&(0,j.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.tags.slice(0,2).map((e,t)=>(0,j.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:e},t)),e.tags.length>2&&(0,j.jsxs)("span",{className:"text-xs text-gray-400",children:["+",e.tags.length-2]})]}),(0,j.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-2 border-t border-gray-100",children:[(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("span",{children:"ðŸ“Š"}),(0,j.jsxs)("span",{children:[e.probability,"%"]})]}),e.expectedCloseDate&&(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("span",{children:"ðŸ“…"}),(0,j.jsx)("span",{children:new Date(e.expectedCloseDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]}),(r||n)&&!t&&(0,j.jsxs)("div",{className:"flex items-center justify-end gap-1 mt-2 pt-2 border-t border-gray-100 opacity-0 group-hover:opacity-100 transition-opacity",children:[r&&(0,j.jsx)("button",{onClick:t=>{t.stopPropagation(),r(e)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Edit opportunity",children:"âœï¸"}),n&&(0,j.jsx)("button",{onClick:t=>{t.stopPropagation(),n(e.id)},className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete opportunity",children:"ðŸ—‘ï¸"})]})]})}function tT({stage:e,onAddOpportunity:t,onEditOpportunity:r,onDeleteOpportunity:n,onEditStage:l,onDeleteStage:a}){let[s,i]=(0,w.useState)(!1),{setNodeRef:o,isOver:d}=ta({id:e.id}),c=e.deals.reduce((e,t)=>e+(t.value||0),0);return(0,j.jsxs)("div",{className:`
        w-72 flex-shrink-0 bg-gray-50 rounded-lg flex flex-col
        ${d?"ring-2 ring-green-500 ring-opacity-50 bg-green-50":""}
      `,children:[(0,j.jsxs)("div",{className:"p-3 border-b border-gray-200",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,j.jsxs)("h3",{className:"font-semibold text-gray-900",children:[e.name," ",{open:"",won:"ðŸŽ‰",lost:"âŒ"}[e.stageType]]})]}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("span",{className:"text-sm text-gray-500 bg-gray-200 px-2 py-0.5 rounded-full",children:e.deals.length}),(l||a)&&(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("button",{onClick:()=>i(!s),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded transition-colors",children:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),s&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),(0,j.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[l&&(0,j.jsxs)("button",{onClick:()=>{i(!1),l(e)},className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Stage"]}),a&&(0,j.jsxs)("button",{onClick:()=>{(i(!1),e.deals.length>0)?alert("Cannot delete stage with opportunities. Move or delete opportunities first."):confirm(`Are you sure you want to delete "${e.name}"?`)&&a(e.id)},className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Stage"]})]})]})]})]})]}),(0,j.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,j.jsx)("span",{className:"text-gray-500",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(c)}),(0,j.jsxs)("span",{className:"text-gray-400",children:[e.winProbability,"% prob."]})]})]}),(0,j.jsxs)("div",{ref:o,className:"flex-1 p-2 overflow-y-auto min-h-[200px]",children:[(0,j.jsx)(tw,{items:e.deals.map(e=>e.id),strategy:tb,children:e.deals.map(e=>(0,j.jsx)("div",{className:"group",children:(0,j.jsx)(tO,{opportunity:e,onEdit:r,onDelete:n})},e.id))}),0===e.deals.length&&(0,j.jsx)("div",{className:"text-center py-8 text-gray-400",children:(0,j.jsx)("p",{className:"text-sm",children:"No opportunities in this stage"})})]}),(0,j.jsx)("div",{className:"p-2 border-t border-gray-200",children:(0,j.jsxs)("button",{onClick:t,className:"w-full py-2 text-sm text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors flex items-center justify-center gap-1",children:[(0,j.jsx)("span",{children:"+"}),(0,j.jsx)("span",{children:"Add Opportunity"})]})})]})}function tM({isOpen:e,onClose:t,onSave:r,opportunity:n,pipeline:l,defaultStageId:a,subAccountId:s}){let[i,o]=(0,w.useState)({description:"",value:0,currency:"USD",stageId:"",priority:"medium",expectedCloseDate:"",source:"",tags:[],contactId:""}),[d,c]=(0,w.useState)(!1),[u,g]=(0,w.useState)(null),[p,h]=(0,w.useState)([]),[x,m]=(0,w.useState)(""),[f,y]=(0,w.useState)(!1),[b,v]=(0,w.useState)(null),[N,C]=(0,w.useState)(""),S=(0,w.useRef)(null),k=(0,w.useRef)(null);(0,w.useEffect)(()=>{n?(o({description:n.description||"",value:n.value||0,currency:n.currency||"USD",stageId:n.stageId||"",priority:n.priority||"medium",expectedCloseDate:n.expectedCloseDate?.split("T")[0]||"",source:n.source||"",tags:n.tags||[],contactId:n.contactId||n.contact?.id||""}),n.contact&&(v(n.contact),m(`${n.contact.firstName} ${n.contact.lastName}`))):(o({description:"",value:0,currency:"USD",stageId:a||l?.stages?.[0]?.id||"",priority:"medium",expectedCloseDate:"",source:"",tags:[],contactId:""}),v(null),m(""))},[n,a,l]),(0,w.useEffect)(()=>{e&&D()},[e]),(0,w.useEffect)(()=>{let e=e=>{k.current&&!k.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let D=async()=>{try{let e=await fetch(`/api/v1/contacts?subAccountId=${s}&limit=100`),t=await e.json();t.success&&t.data&&h(t.data.contacts||[])}catch(e){console.error("Failed to fetch contacts:",e),h([])}},E=p.filter(e=>`${e.firstName} ${e.lastName} ${e.email} ${e.company||""}`.toLowerCase().includes(x.toLowerCase())),O=async e=>{if(e.preventDefault(),g(null),!b)return void g("Please select a contact for this opportunity");if(!i.stageId)return void g("Please select a stage");try{c(!0);let e=`${b.firstName} ${b.lastName}`,t={...i,name:e,subAccountId:s,pipelineId:l?.id,contactId:b.id},a=n?`/api/v1/deals/${n.id}`:"/api/v1/deals",o=n?"PUT":"POST",d=await fetch(a,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),u=await d.json();if(!u.success)throw Error(u.error);r()}catch(e){g(e.message||"Failed to save opportunity")}finally{c(!1)}},T=()=>{N.trim()&&!i.tags.includes(N.trim())&&(o({...i,tags:[...i.tags,N.trim()]}),C(""))};return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,j.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,j.jsxs)("div",{className:"relative bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,j.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[(0,j.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:n?"Edit Opportunity":"Create New Opportunity"}),(0,j.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"âœ•"})]}),(0,j.jsxs)("form",{onSubmit:O,className:"p-6 space-y-6",children:[u&&(0,j.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),(0,j.jsxs)("div",{ref:k,className:"relative",children:[(0,j.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Contact ",(0,j.jsx)("span",{className:"text-red-500",children:"*"}),(0,j.jsx)("span",{className:"text-xs text-gray-500 font-normal ml-2",children:"(Contact name will be the Opportunity Title)"})]}),b?(0,j.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsxs)("div",{className:"w-10 h-10 rounded-full bg-green-600 text-white flex items-center justify-center font-semibold",children:[b.firstName[0],b.lastName[0]]}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{className:"font-medium text-gray-900",children:[b.firstName," ",b.lastName]}),(0,j.jsxs)("div",{className:"text-sm text-gray-500",children:[b.email,b.company&&` â€¢ ${b.company}`]})]})]}),(0,j.jsx)("button",{type:"button",onClick:()=>{v(null),o({...i,contactId:""}),m(""),S.current?.focus()},className:"text-gray-400 hover:text-gray-600 p-1",title:"Change contact",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,j.jsx)("input",{ref:S,type:"text",value:x,onChange:e=>{m(e.target.value),y(!0)},onFocus:()=>y(!0),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Search contacts by name, email, or company..."})]}),f&&(0,j.jsx)("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:0===E.length?(0,j.jsx)("div",{className:"px-4 py-3 text-gray-500 text-center",children:x?"No contacts found":"Start typing to search contacts"}):E.map(e=>(0,j.jsxs)("button",{type:"button",onClick:()=>{v(e),o({...i,contactId:e.id}),m(`${e.firstName} ${e.lastName}`),y(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3 border-b border-gray-100 last:border-0",children:[(0,j.jsxs)("div",{className:"w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center text-sm font-medium",children:[e.firstName[0],e.lastName[0]]}),(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsxs)("div",{className:"font-medium text-gray-900 truncate",children:[e.firstName," ",e.lastName]}),(0,j.jsxs)("div",{className:"text-sm text-gray-500 truncate",children:[e.email,e.company&&` â€¢ ${e.company}`]})]})]},e.id))})]}),(0,j.jsxs)("p",{className:"mt-2 text-xs text-gray-500",children:[(0,j.jsx)("svg",{className:"inline w-4 h-4 mr-1 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"The opportunity title stays synchronized with the contact's name. If you update the contact's name later, this opportunity title will also update."]})]}),(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opportunity Value"}),(0,j.jsxs)("div",{className:"flex",children:[(0,j.jsxs)("select",{value:i.currency,onChange:e=>o({...i,currency:e.target.value}),className:"px-3 py-2 border border-r-0 border-gray-200 rounded-l-lg bg-gray-50 text-gray-600",children:[(0,j.jsx)("option",{value:"USD",children:"$"}),(0,j.jsx)("option",{value:"EUR",children:"â‚¬"}),(0,j.jsx)("option",{value:"GBP",children:"Â£"}),(0,j.jsx)("option",{value:"CAD",children:"C$"})]}),(0,j.jsx)("input",{type:"number",value:i.value,onChange:e=>o({...i,value:parseFloat(e.target.value)||0}),className:"flex-1 px-4 py-2 border border-gray-200 rounded-r-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"0",step:"0.01"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Stage ",(0,j.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,j.jsxs)("select",{value:i.stageId,onChange:e=>o({...i,stageId:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[(0,j.jsx)("option",{value:"",children:"Select stage..."}),l?.stages.map(e=>(0,j.jsxs)("option",{value:e.id,children:[e.name," (",e.winProbability,"%)"]},e.id))]})]})]}),(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,j.jsxs)("select",{value:i.priority,onChange:e=>o({...i,priority:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,j.jsx)("option",{value:"low",children:"Low"}),(0,j.jsx)("option",{value:"medium",children:"Medium"}),(0,j.jsx)("option",{value:"high",children:"High"}),(0,j.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Close Date"}),(0,j.jsx)("input",{type:"date",value:i.expectedCloseDate,onChange:e=>o({...i,expectedCloseDate:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Source"}),(0,j.jsxs)("select",{value:i.source,onChange:e=>o({...i,source:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,j.jsx)("option",{value:"",children:"Select source..."}),(0,j.jsx)("option",{value:"website",children:"Website"}),(0,j.jsx)("option",{value:"referral",children:"Referral"}),(0,j.jsx)("option",{value:"cold_call",children:"Cold Call"}),(0,j.jsx)("option",{value:"advertisement",children:"Advertisement"}),(0,j.jsx)("option",{value:"social_media",children:"Social Media"}),(0,j.jsx)("option",{value:"email_campaign",children:"Email Campaign"}),(0,j.jsx)("option",{value:"trade_show",children:"Trade Show"}),(0,j.jsx)("option",{value:"other",children:"Other"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),(0,j.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:i.tags.map(e=>(0,j.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-sm",children:[e,(0,j.jsx)("button",{type:"button",onClick:()=>{o({...i,tags:i.tags.filter(t=>t!==e)})},className:"hover:text-green-900",children:"Ã—"})]},e))}),(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)("input",{type:"text",value:N,onChange:e=>C(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),T())},className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add a tag..."}),(0,j.jsx)("button",{type:"button",onClick:T,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Add"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,j.jsx)("textarea",{value:i.description,onChange:e=>o({...i,description:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add notes about this opportunity..."})]}),(0,j.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,j.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),(0,j.jsx)("button",{type:"submit",disabled:d||!b,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Saving...":n?"Update Opportunity":"Create Opportunity"})]})]})]})})]}):null}function tP({pipelines:e,selectedPipeline:t,onSelect:r,onCreatePipeline:n,subAccountId:l}){let[a,s]=(0,w.useState)(!1),[i,o]=(0,w.useState)(!1),[d,c]=(0,w.useState)(""),[u,g]=(0,w.useState)(!1),p=async()=>{if(d.trim())try{g(!0);let e=await fetch("/api/v1/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subAccountId:l,name:d.trim(),createDefaultStages:!0})}),t=await e.json();if(!t.success)throw Error(t.error);c(""),o(!1),s(!1),n()}catch(e){alert("Failed to create pipeline: "+e.message)}finally{g(!1)}};return(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsxs)("button",{onClick:()=>s(!a),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors min-w-[200px]",children:[t?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{children:t.icon}),(0,j.jsx)("span",{className:"font-medium text-gray-900",children:t.name})]}):(0,j.jsx)("span",{className:"text-gray-500",children:"Select Pipeline"}),(0,j.jsx)("span",{className:"ml-auto text-gray-400",children:"â–¼"})]}),a&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>{s(!1),o(!1)}}),(0,j.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[(0,j.jsxs)("div",{className:"max-h-60 overflow-y-auto",children:[e.map(e=>(0,j.jsxs)("button",{onClick:()=>{r(e),s(!1)},className:`
                    w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors
                    ${t?.id===e.id?"bg-green-50":""}
                  `,children:[(0,j.jsx)("span",{className:"text-xl",children:e.icon}),(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.isDefault&&(0,j.jsx)("p",{className:"text-xs text-gray-400",children:"Default"})]}),t?.id===e.id&&(0,j.jsx)("span",{className:"text-green-600",children:"âœ“"})]},e.id)),0===e.length&&!i&&(0,j.jsxs)("div",{className:"px-4 py-8 text-center text-gray-500",children:[(0,j.jsx)("p",{children:"No pipelines yet"}),(0,j.jsx)("p",{className:"text-sm",children:"Create your first pipeline below"})]})]}),(0,j.jsx)("div",{className:"border-t border-gray-200 p-3",children:i?(0,j.jsxs)("div",{className:"space-y-2",children:[(0,j.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),placeholder:"Pipeline name...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&p(),"Escape"===e.key&&(o(!1),c(""))}}),(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)("button",{onClick:p,disabled:u||!d.trim(),className:"flex-1 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:u?"Creating...":"Create"}),(0,j.jsx)("button",{onClick:()=>{o(!1),c("")},className:"px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm",children:"Cancel"})]})]}):(0,j.jsxs)("button",{onClick:()=>o(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors text-sm",children:[(0,j.jsx)("span",{children:"+"}),(0,j.jsx)("span",{children:"Create New Pipeline"})]})})]})]})]})}h.Down,h.Right,h.Up,h.Left;let tL=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#F97316","#6366F1","#14B8A6","#84CC16","#A855F7"];function tR({isOpen:e,onClose:t,onSave:r,stage:n,pipelineId:l,subAccountId:a,existingStagesCount:s}){let[i,o]=(0,w.useState)({name:"",color:tL[0],stageType:"open",winProbability:50,displayOrder:s}),[d,c]=(0,w.useState)(!1),[u,g]=(0,w.useState)(null);(0,w.useEffect)(()=>{n?o({name:n.name||"",color:n.color||tL[0],stageType:n.stageType||"open",winProbability:n.winProbability??50,displayOrder:n.displayOrder??s}):o({name:"",color:tL[s%tL.length],stageType:"open",winProbability:50,displayOrder:s})},[n,s]);let p=async e=>{if(e.preventDefault(),g(null),!i.name.trim())return void g("Stage name is required");try{c(!0);let e={...i,pipelineId:l,subAccountId:a},t=n?`/api/v1/pipelines/${l}/stages/${n.id}`:`/api/v1/pipelines/${l}/stages`,s=n?"PUT":"POST",o=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),d=await o.json();if(!d.success)throw Error(d.error);r()}catch(e){g(e.message||"Failed to save stage")}finally{c(!1)}};return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,j.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,j.jsxs)("div",{className:"relative bg-white rounded-xl shadow-xl max-w-lg w-full",children:[(0,j.jsxs)("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,j.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:n?"Edit Stage":"Add New Stage"}),(0,j.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,j.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsxs)("form",{onSubmit:p,className:"p-6 space-y-6",children:[u&&(0,j.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Stage Name ",(0,j.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,j.jsx)("input",{type:"text",value:i.name,onChange:e=>o({...i,name:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Qualified Lead, Proposal Sent",required:!0})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stage Type"}),(0,j.jsx)("div",{className:"grid grid-cols-3 gap-3",children:[{value:"open",label:"Open",icon:"ðŸ“‹",description:"In progress"},{value:"won",label:"Won",icon:"ðŸŽ‰",description:"Opportunity won"},{value:"lost",label:"Lost",icon:"âŒ",description:"Opportunity lost"}].map(e=>(0,j.jsxs)("button",{type:"button",onClick:()=>o({...i,stageType:e.value,winProbability:"won"===e.value?100:"lost"===e.value?0:i.winProbability}),className:`p-3 rounded-lg border-2 text-center transition-colors ${i.stageType===e.value?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,j.jsx)("div",{className:"text-2xl mb-1",children:e.icon}),(0,j.jsx)("div",{className:"font-medium text-gray-900",children:e.label}),(0,j.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]},e.value))})]}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Win Probability: ",i.winProbability,"%"]}),(0,j.jsx)("input",{type:"range",min:"0",max:"100",step:"5",value:i.winProbability,onChange:e=>o({...i,winProbability:parseInt(e.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-green-600",disabled:"won"===i.stageType||"lost"===i.stageType}),(0,j.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,j.jsx)("span",{children:"0%"}),(0,j.jsx)("span",{children:"50%"}),(0,j.jsx)("span",{children:"100%"})]}),("won"===i.stageType||"lost"===i.stageType)&&(0,j.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Probability is fixed at ","won"===i.stageType?"100%":"0%"," for ",i.stageType," stages"]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stage Color"}),(0,j.jsx)("div",{className:"flex flex-wrap gap-2",children:tL.map(e=>(0,j.jsx)("button",{type:"button",onClick:()=>o({...i,color:e}),className:`w-8 h-8 rounded-full transition-transform ${i.color===e?"ring-2 ring-offset-2 ring-gray-400 scale-110":""}`,style:{backgroundColor:e}},e))}),(0,j.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,j.jsx)("input",{type:"color",value:i.color,onChange:e=>o({...i,color:e.target.value}),className:"w-10 h-10 rounded cursor-pointer border border-gray-200"}),(0,j.jsx)("input",{type:"text",value:i.color,onChange:e=>o({...i,color:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm font-mono",placeholder:"#000000"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,j.jsx)("input",{type:"number",value:i.displayOrder,onChange:e=>o({...i,displayOrder:parseInt(e.target.value)||0}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"0"}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first (left to right)"})]}),(0,j.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,j.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),(0,j.jsx)("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Saving...":n?"Update Stage":"Create Stage"})]})]})]})})]}):null}var tI=e.i(95696);let tA=[{id:"pipeline",label:"Lead Engine",icon:"fa-rocket",href:"/sub-account/lead-engine"},{id:"manage",label:"Manage Engines",icon:"fa-cogs",href:"/sub-account/lead-engine?tab=manage"},{id:"bulk-actions",label:"Bulk Actions",icon:"fa-tasks",href:"/sub-account/lead-engine?tab=bulk-actions"}];function t$(){var e;let t=(0,C.useSearchParams)().get("tab")||"pipeline",[r,n]=(0,w.useState)([]),[l,a]=(0,w.useState)(null),[s,i]=(0,w.useState)(!0),[o,d]=(0,w.useState)(null),[c,u]=(0,w.useState)(!1),[g,p]=(0,w.useState)(null),[h,x]=(0,w.useState)(null),[m,f]=(0,w.useState)(!1),[y,b]=(0,w.useState)(null),[v,S]=(0,w.useState)(null),k="sub-001",D=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,w.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}((e={activationConstraint:{distance:8}},(0,w.useMemo)(()=>({sensor:eB,options:null!=e?e:{}}),[eB,e]))),E=async()=>{try{i(!0);let e=await fetch(`/api/v1/pipelines?subAccountId=${k}&includeStages=true&includeDeals=true`),t=await e.json();if(!t.success)throw Error(t.error);if(n(t.data),t.data.length>0){let e=t.data.find(e=>e.isDefault)||t.data[0];a(e)}}catch(e){d(e.message)}finally{i(!1)}};(0,w.useEffect)(()=>{E()},[]);let O=async e=>{let{active:t,over:r}=e;if(S(null),!r||!l)return;let n=t.id,s=r.id,i=T(n);if(!i||i.stageId===s)return;let o={...l};o.stages=o.stages.map(e=>e.id===i.stageId?{...e,opportunities:e.deals.filter(e=>e.id!==n)}:e.id===s?{...e,opportunities:[...e.deals,{...i,stageId:s}]}:e),a(o);try{let e=await fetch(`/api/v1/deals/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({stageId:s})}),t=await e.json();if(!t.success)throw Error(t.error);E()}catch(e){console.error("Failed to move opportunity:",e),E()}},T=e=>{if(l)for(let t of l.stages){let r=t.deals.find(t=>t.id===e);if(r)return r}},M=async e=>{if(confirm("Are you sure you want to delete this opportunity?"))try{let t=await fetch(`/api/v1/deals/${e}`,{method:"DELETE"}),r=await t.json();if(!r.success)throw Error(r.error);E()}catch(e){alert("Failed to delete deal: "+e.message)}},P=async e=>{if(l)try{let t=await fetch(`/api/v1/pipelines/${l.id}/stages/${e}`,{method:"DELETE"}),r=await t.json();if(!r.success)throw Error(r.error);E()}catch(e){alert("Failed to delete stage: "+e.message)}},L=(()=>{if(!l)return{totalOpportunities:0,totalValue:0,wonValue:0,openOpportunities:0};let e=0,t=0,r=0,n=0;return l.stages.forEach(l=>{l.deals.forEach(a=>{e++,t+=a.value||0,"won"===l.stageType&&(r+=a.value||0),"open"===l.stageType&&n++})}),{totalOpportunities:e,totalValue:t,wonValue:r,openOpportunities:n}})();return(0,j.jsxs)("div",{className:"space-y-6 -m-4 sm:-m-6 lg:-m-8",children:[(0,j.jsxs)("div",{className:"flex-none bg-white border-b border-gray-200 px-4 sm:px-6 lg:px-8 pt-4 sm:pt-6 lg:pt-8 pb-0",children:[(0,j.jsx)(tI.PageHeader,{title:"Lead Engine",description:"Manage sales pipelines, track opportunities, and drive revenue growth",icon:"fa-rocket"}),(0,j.jsx)("nav",{className:"-mb-px flex space-x-8","aria-label":"Lead Engine tabs",children:tA.map(e=>{let r=e.id===t;return(0,j.jsxs)(N.default,{href:e.href,className:`group inline-flex items-center border-b-2 py-4 px-1 text-sm font-medium transition-colors ${r?"border-[var(--theme-secondary)] text-[var(--theme-secondary)]":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:[(0,j.jsx)("i",{className:`fas ${e.icon} mr-2 text-base`,style:{color:r?"var(--theme-secondary)":void 0}}),e.label]},e.id)})})]}),(0,j.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 pb-4 sm:pb-6 lg:pb-8",children:["pipeline"===t&&(0,j.jsx)(tF,{pipelines:r,selectedPipeline:l,setSelectedPipeline:a,loading:s,error:o,stats:L,sensors:D,activeOpportunity:v,subAccountId:k,onDragStart:e=>{let{active:t}=e;T(t.id),S(opportunity||null)},onDragEnd:O,onCreateOpportunity:e=>{p(null),x(e||null),u(!0)},onEditOpportunity:e=>{p(e),x(null),u(!0)},onDeleteOpportunity:M,onCreateStage:()=>{b(null),f(!0)},onEditStage:e=>{b(e),f(!0)},onDeleteStage:P,fetchPipelines:E}),"manage"===t&&(0,j.jsx)(tB,{pipelines:r,loading:s,subAccountId:k,onPipelineUpdated:E}),"bulk-actions"===t&&(0,j.jsx)(tz,{pipelines:r,selectedPipeline:l,loading:s,onRefresh:E})]}),(0,j.jsx)(tM,{isOpen:c,onClose:()=>{u(!1),p(null),x(null)},onSave:()=>{u(!1),p(null),x(null),E()},deal:g,pipeline:l,defaultStageId:h,subAccountId:k}),l&&(0,j.jsx)(tR,{isOpen:m,onClose:()=>{f(!1),b(null)},onSave:()=>{f(!1),b(null),E()},stage:y,pipelineId:l.id,subAccountId:k,existingStagesCount:l.stages.length})]})}function tF({pipelines:e,selectedPipeline:t,setSelectedPipeline:r,loading:n,error:l,stats:a,sensors:s,activeOpportunity:i,subAccountId:o,onDragStart:d,onDragEnd:c,onCreateOpportunity:u,onEditOpportunity:g,onDeleteOpportunity:p,onCreateStage:h,onEditStage:x,onDeleteStage:m,fetchPipelines:f}){return n?(0,j.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):l?(0,j.jsxs)("div",{className:"rounded-lg p-6 text-center bg-red-50 border border-red-200",children:[(0,j.jsx)("p",{className:"text-red-600",children:l}),(0,j.jsx)("button",{onClick:f,className:"mt-4 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity bg-red-600",children:"Retry"})]}):(0,j.jsxs)("div",{className:"h-full flex flex-col",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ðŸŽ¯ Pipeline View"}),(0,j.jsx)("p",{className:"mt-1 text-gray-500",children:"Drag and drop opportunities between stages"})]}),(0,j.jsxs)("div",{className:"flex items-center gap-4",children:[(0,j.jsx)(tP,{pipelines:e,selectedPipeline:t,onSelect:e=>r(e),onCreatePipeline:f,subAccountId:o}),(0,j.jsxs)("button",{onClick:()=>u(),className:"flex items-center gap-2 px-4 py-2 rounded-lg hover:opacity-90 transition-opacity bg-green-600 text-white",children:[(0,j.jsx)("span",{className:"text-xl",children:"+"}),(0,j.jsx)("span",{children:"Add Opportunity"})]})]})]}),(0,j.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,j.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,j.jsx)("p",{className:"text-sm text-gray-500",children:"Total Opportunities"}),(0,j.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:a.totalOpportunities})]}),(0,j.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,j.jsx)("p",{className:"text-sm text-gray-500",children:"Open Opportunities"}),(0,j.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:a.openOpportunities})]}),(0,j.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,j.jsx)("p",{className:"text-sm text-gray-500",children:"Pipeline Value"}),(0,j.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",a.totalValue.toLocaleString()]})]}),(0,j.jsxs)("div",{className:"rounded-lg shadow-sm p-4 bg-white border border-gray-200",children:[(0,j.jsx)("p",{className:"text-sm text-gray-500",children:"Won Value"}),(0,j.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["$",a.wonValue.toLocaleString()]})]})]}),t?(0,j.jsxs)(te,{sensors:s,collisionDetection:ei,onDragStart:d,onDragEnd:c,children:[(0,j.jsx)("div",{className:"flex-1 overflow-x-auto",children:(0,j.jsxs)("div",{className:"flex gap-4 h-full min-w-max pb-4",children:[t.stages.sort((e,t)=>e.displayOrder-t.displayOrder).filter(e=>"lost"!==e.stageType).map(e=>(0,j.jsx)(tT,{stage:e,onAddOpportunity:()=>u(e.id),onEditOpportunity:g,onDeleteOpportunity:p,onEditStage:x,onDeleteStage:m},e.id)),(0,j.jsx)("div",{className:"w-72 flex-shrink-0",children:(0,j.jsxs)("button",{onClick:h,className:"w-full h-full min-h-[200px] border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center gap-2 text-gray-400 hover:text-gray-600 hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[(0,j.jsx)("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,j.jsx)("span",{className:"font-medium",children:"Add Stage"})]})}),t.stages.filter(e=>"lost"===e.stageType).map(e=>(0,j.jsxs)("div",{className:"w-16 flex-shrink-0 bg-gray-100 rounded-lg p-2 flex flex-col items-center cursor-pointer hover:bg-gray-200 transition-colors",onClick:()=>x(e),title:"Click to edit",children:[(0,j.jsx)("div",{className:"w-3 h-3 rounded-full mb-2",style:{backgroundColor:e.color}}),(0,j.jsxs)("span",{className:"text-xs text-gray-500 writing-mode-vertical transform rotate-180",style:{writingMode:"vertical-rl"},children:[e.name," (",e.deals.length,")"]})]},e.id))]})}),(0,j.jsx)(th,{children:i?(0,j.jsx)(tO,{opportunity:i,isDragging:!0}):null})]}):(0,j.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50 rounded-lg",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("p",{className:"text-gray-500 text-lg mb-4",children:"No pipeline selected"}),(0,j.jsx)("p",{className:"text-gray-400",children:"Create a pipeline to get started"})]})})]})}function tB({pipelines:e,loading:t,subAccountId:r,onPipelineUpdated:n}){let[l,a]=(0,w.useState)(!1),[s,i]=(0,w.useState)(null),[o,d]=(0,w.useState)({name:"",description:"",icon:"ðŸŽ¯",color:"#10B981",isDefault:!1}),c=()=>{i(null),d({name:"",description:"",icon:"ðŸŽ¯",color:"#10B981",isDefault:!1}),a(!0)},u=e=>{i(e),d({name:e.name,description:e.description||"",icon:e.icon||"ðŸŽ¯",color:e.color||"#10B981",isDefault:e.isDefault}),a(!0)},g=async()=>{if(o.name.trim())try{if(s){let e=await fetch(`/api/v1/pipelines/${s.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),t=await e.json();if(!t.success)throw Error(t.error)}else{let e=await fetch("/api/v1/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,subAccountId:r})}),t=await e.json();if(!t.success)throw Error(t.error)}a(!1),n()}catch(e){alert("Failed to save pipeline: "+e.message)}},p=async e=>{if(confirm("Are you sure you want to delete this pipeline? All opportunities will be moved to another pipeline or deleted."))try{let t=await fetch(`/api/v1/pipelines/${e}`,{method:"DELETE"}),r=await t.json();if(!r.success)throw Error(r.error);n()}catch(e){alert("Failed to delete pipeline: "+e.message)}},h=async e=>{try{let t=await fetch(`/api/v1/pipelines/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})}),r=await t.json();if(!r.success)throw Error(r.error);n()}catch(e){alert("Failed to set default: "+e.message)}},x=async e=>{try{let t=await fetch("/api/v1/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:`${e.name} (Copy)`,description:e.description,icon:e.icon,color:e.color,isDefault:!1,subAccountId:r,stages:e.stages.map(e=>({name:e.name,color:e.color,stageType:e.stageType,winProbability:e.winProbability,displayOrder:e.displayOrder}))})}),l=await t.json();if(!l.success)throw Error(l.error);n()}catch(e){alert("Failed to duplicate pipeline: "+e.message)}};return t?(0,j.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"âš™ï¸ Manage Engines"}),(0,j.jsx)("p",{className:"mt-1 text-gray-500",children:"Create and configure your sales pipelines"})]}),(0,j.jsxs)("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors",children:[(0,j.jsx)("i",{className:"fas fa-plus"}),(0,j.jsx)("span",{children:"Create Pipeline"})]})]}),0===e.length?(0,j.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[(0,j.jsx)("i",{className:"fas fa-rocket text-5xl text-gray-300 mb-4"}),(0,j.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No pipelines yet"}),(0,j.jsx)("p",{className:"text-gray-500 mb-4",children:"Create your first pipeline to start tracking opportunities"}),(0,j.jsx)("button",{onClick:c,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Create Pipeline"})]}):(0,j.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{let t,r,n,l,a=(t=0,r=0,n=0,l=0,e.stages.forEach(e=>{t+=e.deals.length,e.deals.forEach(t=>{r+=t.value||0,"open"===e.stageType&&n++,"won"===e.stageType&&l++})}),{totalOpportunities:t,totalValue:r,openOpportunities:n,wonOpportunities:l,stageCount:e.stages.length});return(0,j.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[(0,j.jsxs)("div",{className:"p-4 border-b border-gray-200",style:{backgroundColor:`${e.color}15`},children:[(0,j.jsxs)("div",{className:"flex items-start justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("span",{className:"text-3xl",children:e.icon||"ðŸŽ¯"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),e.isDefault&&(0,j.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full",children:"Default"})]})]}),(0,j.jsxs)("div",{className:"relative group",children:[(0,j.jsx)("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-white/50",children:(0,j.jsx)("i",{className:"fas fa-ellipsis-v"})}),(0,j.jsxs)("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10 hidden group-hover:block",children:[(0,j.jsxs)("button",{onClick:()=>u(e),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-edit w-4"}),"Edit Pipeline"]}),!e.isDefault&&(0,j.jsxs)("button",{onClick:()=>h(e.id),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-star w-4"}),"Set as Default"]}),(0,j.jsxs)("button",{onClick:()=>x(e),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-copy w-4"}),"Duplicate"]}),(0,j.jsx)("hr",{className:"my-1"}),(0,j.jsxs)("button",{onClick:()=>p(e.id),className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-trash w-4"}),"Delete"]})]})]})]}),e.description&&(0,j.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:e.description})]}),(0,j.jsxs)("div",{className:"p-4 space-y-3",children:[(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-xs text-gray-500",children:"Total Opportunities"}),(0,j.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:a.totalOpportunities})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-xs text-gray-500",children:"Pipeline Value"}),(0,j.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["$",a.totalValue.toLocaleString()]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-xs text-gray-500",children:"Open Opportunities"}),(0,j.jsx)("p",{className:"text-lg font-semibold text-blue-600",children:a.openOpportunities})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-xs text-gray-500",children:"Won Opportunities"}),(0,j.jsx)("p",{className:"text-lg font-semibold text-green-600",children:a.wonOpportunities})]})]}),(0,j.jsxs)("div",{className:"pt-3 border-t border-gray-200",children:[(0,j.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["Stages (",a.stageCount,")"]}),(0,j.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.stages.sort((e,t)=>e.displayOrder-t.displayOrder).slice(0,5).map(e=>(0,j.jsx)("span",{className:"text-xs px-2 py-1 rounded-full",style:{backgroundColor:`${e.color}20`,color:e.color},children:e.name},e.id)),e.stages.length>5&&(0,j.jsxs)("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-500 rounded-full",children:["+",e.stages.length-5," more"]})]})]})]}),(0,j.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex justify-between",children:[(0,j.jsxs)(N.default,{href:"/sub-account/lead-engine",className:"text-sm text-green-600 hover:text-green-700 flex items-center gap-1",children:[(0,j.jsx)("i",{className:"fas fa-eye"}),"View Pipeline"]}),(0,j.jsxs)("button",{onClick:()=>u(e),className:"text-sm text-gray-600 hover:text-gray-700 flex items-center gap-1",children:[(0,j.jsx)("i",{className:"fas fa-cog"}),"Configure"]})]})]},e.id)})}),l&&(0,j.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,j.jsx)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:(0,j.jsxs)("div",{className:"p-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,j.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:s?"Edit Pipeline":"Create Pipeline"}),(0,j.jsx)("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:(0,j.jsx)("i",{className:"fas fa-times text-xl"})})]}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pipeline Name *"}),(0,j.jsx)("input",{type:"text",value:o.name,onChange:e=>d(t=>({...t,name:e.target.value})),placeholder:"e.g., Sales Pipeline",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,j.jsx)("textarea",{value:o.description,onChange:e=>d(t=>({...t,description:e.target.value})),placeholder:"Brief description...",rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),(0,j.jsx)("div",{className:"flex flex-wrap gap-2",children:["ðŸŽ¯","ðŸ’°","ðŸš€","â­","ðŸ”¥","ðŸ’Ž","ðŸ†","ðŸ“ˆ","ðŸŽª","ðŸŽ¨","âš¡","ðŸŒŸ"].map(e=>(0,j.jsx)("button",{type:"button",onClick:()=>d(t=>({...t,icon:e})),className:`w-10 h-10 text-xl flex items-center justify-center rounded-lg border-2 transition-colors ${o.icon===e?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:e},e))})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),(0,j.jsx)("div",{className:"flex flex-wrap gap-2",children:["#10B981","#3B82F6","#8B5CF6","#F59E0B","#EF4444","#EC4899","#06B6D4","#84CC16"].map(e=>(0,j.jsx)("button",{type:"button",onClick:()=>d(t=>({...t,color:e})),className:`w-10 h-10 rounded-lg border-2 transition-all ${o.color===e?"border-gray-900 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:e}},e))})]}),(0,j.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Set as Default"}),(0,j.jsx)("p",{className:"text-sm text-gray-500",children:"This pipeline will be selected by default"})]}),(0,j.jsx)("button",{type:"button",onClick:()=>d(e=>({...e,isDefault:!e.isDefault})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${o.isDefault?"bg-green-600":"bg-gray-200"}`,children:(0,j.jsx)("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${o.isDefault?"translate-x-5":"translate-x-0"}`})})]})]}),(0,j.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,j.jsx)("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,j.jsx)("button",{onClick:g,disabled:!o.name.trim(),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Save Changes":"Create Pipeline"})]})]})})})]})}function tz({pipelines:e,selectedPipeline:t,loading:r,onRefresh:n}){let[l,a]=(0,w.useState)([]),[s,i]=(0,w.useState)(""),[o,d]=(0,w.useState)(""),[c,u]=(0,w.useState)(""),[g,p]=(0,w.useState)(!1),[h,x]=(0,w.useState)(""),[m,f]=(0,w.useState)(""),[y,b]=(0,w.useState)(!1),v=(0,w.useMemo)(()=>{let t=[];if((s?e.filter(e=>e.id===s):e).forEach(e=>{e.stages.forEach(r=>{o&&r.id!==o||r.deals.forEach(n=>{t.push({...n,pipelineName:e.name,stageName:r.name,stageColor:r.color})})})}),c){let e=c.toLowerCase();return t.filter(t=>t.name.toLowerCase().includes(e)||t.contact?.firstName?.toLowerCase().includes(e)||t.contact?.lastName?.toLowerCase().includes(e)||t.contact?.email?.toLowerCase().includes(e))}return t},[e,s,o,c]),N=(0,w.useMemo)(()=>{if(!s)return[];let t=e.find(e=>e.id===s);return t?.stages||[]},[s,e]),C=async()=>{if(0!==l.length&&h){b(!0);try{for(let e of l){let t={};switch(h){case"move-stage":t={stageId:m};break;case"update-status":t={status:m};break;case"update-priority":t={priority:m};break;case"delete":await fetch(`/api/v1/deals/${e}`,{method:"DELETE"});continue}Object.keys(t).length>0&&await fetch(`/api/v1/deals/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}p(!1),a([]),x(""),f(""),n(),alert(`Successfully processed ${l.length} deals`)}catch(e){alert("Error processing opportunities: "+e.message)}finally{b(!1)}}},S=e=>{x(e),f(""),p(!0)};return r?(0,j.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"ðŸ“¦ Bulk Actions"}),(0,j.jsx)("p",{className:"mt-1 text-gray-500",children:"Perform actions on multiple opportunities at once"})]}),l.length>0&&(0,j.jsx)("div",{className:"flex items-center gap-2",children:(0,j.jsxs)("span",{className:"text-sm text-gray-600",children:[l.length," deal",l.length>1?"s":""," selected"]})})]}),(0,j.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,j.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,j.jsxs)("button",{onClick:()=>S("move-stage"),disabled:0===l.length,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-arrows-alt"}),"Move to Stage"]}),(0,j.jsxs)("button",{onClick:()=>S("update-status"),disabled:0===l.length,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-flag"}),"Update Status"]}),(0,j.jsxs)("button",{onClick:()=>S("update-priority"),disabled:0===l.length,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-exclamation-circle"}),"Update Priority"]}),(0,j.jsxs)("button",{onClick:()=>S("delete"),disabled:0===l.length,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,j.jsx)("i",{className:"fas fa-trash"}),"Delete Selected"]})]})}),(0,j.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,j.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,j.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,j.jsx)("input",{type:"text",placeholder:"Search opportunities...",value:c,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),(0,j.jsxs)("select",{value:s,onChange:e=>{i(e.target.value),d("")},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,j.jsx)("option",{value:"",children:"All Pipelines"}),e.map(e=>(0,j.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))]}),(0,j.jsxs)("select",{value:o,onChange:e=>d(e.target.value),disabled:!s,className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:opacity-50",children:[(0,j.jsx)("option",{value:"",children:"All Stages"}),N.map(e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,j.jsx)("button",{onClick:n,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",title:"Refresh",children:(0,j.jsx)("i",{className:"fas fa-sync-alt"})})]})}),(0,j.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:0===v.length?(0,j.jsxs)("div",{className:"text-center py-12",children:[(0,j.jsx)("i",{className:"fas fa-inbox text-4xl text-gray-300 mb-4"}),(0,j.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No opportunities found"}),(0,j.jsx)("p",{className:"text-gray-500",children:"Try adjusting your filters"})]}):(0,j.jsx)("div",{className:"overflow-x-auto",children:(0,j.jsxs)("table",{className:"w-full",children:[(0,j.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{className:"px-4 py-3 text-left",children:(0,j.jsx)("input",{type:"checkbox",checked:l.length===v.length&&v.length>0,onChange:()=>{l.length===v.length?a([]):a(v.map(e=>e.id))},className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})}),(0,j.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deal"}),(0,j.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),(0,j.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pipeline / Stage"}),(0,j.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value"}),(0,j.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,j.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,j.jsx)("tbody",{className:"divide-y divide-gray-200",children:v.map(e=>(0,j.jsxs)("tr",{className:`hover:bg-gray-50 ${l.includes(e.id)?"bg-green-50":""}`,children:[(0,j.jsx)("td",{className:"px-4 py-3",children:(0,j.jsx)("input",{type:"checkbox",checked:l.includes(e.id),onChange:()=>{var t;return t=e.id,void(l.includes(t)?a(e=>e.filter(e=>e!==t)):a(e=>[...e,t]))},className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})}),(0,j.jsxs)("td",{className:"px-4 py-3",children:[(0,j.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),e.expectedCloseDate&&(0,j.jsxs)("div",{className:"text-xs text-gray-500",children:["Close: ",new Date(e.expectedCloseDate).toLocaleDateString()]})]}),(0,j.jsx)("td",{className:"px-4 py-3",children:e.contact?(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{className:"text-sm text-gray-900",children:[e.contact.firstName," ",e.contact.lastName]}),(0,j.jsx)("div",{className:"text-xs text-gray-500",children:e.contact.email})]}):(0,j.jsx)("span",{className:"text-gray-400",children:"No contact"})}),(0,j.jsxs)("td",{className:"px-4 py-3",children:[(0,j.jsx)("div",{className:"text-sm text-gray-900",children:e.pipelineName}),(0,j.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:`${e.stageColor}20`,color:e.stageColor},children:e.stageName})]}),(0,j.jsxs)("td",{className:"px-4 py-3",children:[(0,j.jsxs)("div",{className:"font-medium text-gray-900",children:["$",(e.value||0).toLocaleString()]}),(0,j.jsx)("div",{className:"text-xs text-gray-500",children:e.currency||"USD"})]}),(0,j.jsx)("td",{className:"px-4 py-3",children:(0,j.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:e.priority||"normal"})}),(0,j.jsx)("td",{className:"px-4 py-3",children:(0,j.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"active"===e.status?"bg-green-100 text-green-700":"won"===e.status?"bg-blue-100 text-blue-700":"lost"===e.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:e.status||"active"})})]},e.id))})]})})}),(0,j.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center justify-between text-sm",children:[(0,j.jsxs)("span",{className:"text-gray-600",children:["Showing ",v.length," deal",1!==v.length?"s":""]}),(0,j.jsxs)("span",{className:"text-gray-900 font-medium",children:["Total Value: $",v.reduce((e,t)=>e+(t.value||0),0).toLocaleString()]})]}),g&&(0,j.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,j.jsx)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:(0,j.jsxs)("div",{className:"p-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,j.jsxs)("h3",{className:"text-lg font-bold text-gray-900",children:["move-stage"===h&&"Move to Stage","update-status"===h&&"Update Status","update-priority"===h&&"Update Priority","delete"===h&&"Delete Opportunities"]}),(0,j.jsx)("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:(0,j.jsx)("i",{className:"fas fa-times"})})]}),(0,j.jsxs)("p",{className:"text-gray-600 mb-4",children:["This action will affect ",l.length," deal",l.length>1?"s":"","."]}),"move-stage"===h&&(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Target Stage"}),(0,j.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,j.jsx)("option",{value:"",children:"Select stage..."}),e.map(e=>(0,j.jsx)("optgroup",{label:`${e.icon} ${e.name}`,children:e.stages.map(e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id))},e.id))]})]}),"update-status"===h&&(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Status"}),(0,j.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,j.jsx)("option",{value:"",children:"Select status..."}),(0,j.jsx)("option",{value:"active",children:"Active"}),(0,j.jsx)("option",{value:"won",children:"Won"}),(0,j.jsx)("option",{value:"lost",children:"Lost"}),(0,j.jsx)("option",{value:"on-hold",children:"On Hold"})]})]}),"update-priority"===h&&(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Priority"}),(0,j.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,j.jsx)("option",{value:"",children:"Select priority..."}),(0,j.jsx)("option",{value:"high",children:"High"}),(0,j.jsx)("option",{value:"medium",children:"Medium"}),(0,j.jsx)("option",{value:"low",children:"Low"})]})]}),"delete"===h&&(0,j.jsxs)("div",{className:"p-4 bg-red-50 rounded-lg border border-red-200",children:[(0,j.jsx)("p",{className:"text-red-700 font-medium",children:"âš ï¸ Warning"}),(0,j.jsx)("p",{className:"text-red-600 text-sm mt-1",children:"This action cannot be undone. All selected opportunities will be permanently deleted."})]}),(0,j.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,j.jsx)("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,j.jsx)("button",{onClick:C,disabled:y||"delete"!==h&&!m,className:`flex-1 px-4 py-2 text-white rounded-lg disabled:opacity-50 ${"delete"===h?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:y?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Processing..."]}):"delete"===h?"Delete Opportunities":"Apply Changes"})]})]})})})]})}function tU(){return(0,j.jsx)(w.Suspense,{fallback:(0,j.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-[#0a0a0a] flex items-center justify-center",children:(0,j.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:(0,j.jsx)(t$,{})})}e.s(["default",()=>tU,"dynamic",0,"force-dynamic"],96294)}]);